<style>
	.add_button a {
		color: white;
	}
	.dropdown_opt {  width: 50%; position: absolute;  left: 20%; margin-top: -1px; z-index: 99;}
	.th_average {  width: 147px !important; max-width: 150px;}
	.avrege_print {  margin-right: 17px; float: right;}
	.back_up {color: #908d8d;
		margin-left: 3%;
		font-size: 15px; text-transform:capitalize;
		font-weight: 600;
		cursor:pointer;
		letter-spacing: 1px;}
	.listlist {white-space: nowrap;}
	.w_full .select2-container {min-width: 195px; }
	.listlist:hover > span.messgae {    display: block;}
	.messgae {  }
	span.messgae {display: none;background: #fff;padding: 5px;    top: 23px;    position: absolute;    left: 131px;    border: 1px solid #bbb;    width: 150px;    border-radius: 4px;
		color: #ff6600;   font-size: 20px}
	.listlist{position:relative;}
	.cross_limit{display:inline;margin-left:3px;border-radius:5px;line-height:100%;height:24px;padding:0 5px;text-align:center;position:relative}.span2.asste_css .badge{min-width:20px;padding:0;min-height:20px;line-height:20px;font-size:15px;border-radius:3px}.cross_limit:hover>.onbhh{display:block}.onbhh{position:absolute;background:linear-gradient(#fff ,#e5e5f0);white-space:nowrap;padding:7px 8px;border:1px solid #767676;z-index:9;border-radius:7px;font-weight:400;left:8px;top:22px;font-size:19px;display:none}.limt_assets.feee.jkii{position:absolute;top:2px;left:0;font-size:15px}.limt_assets.limt_assets22{position:absolute;bottom:11px;left:0;font-size:15px}.value123{display:inline;margin-left:3px;color:#3c8dbc;padding-left:6px}span.fffff.kkkkk span.badge.hththtth:before{content:"";position:absolute;height:23px;width:8px;background:#f1f1f1;left:-8px;top:-2px}span.fffff.kkkkk span.badge.hththtth{position:relative;top:-3px}span.fffff.kkkkk span.badge.hththtth:after{content:"";position:absolute;height:23px;width:8px;background:#f1f1f1;right:-8px;top:-2px}.end_contrat{color:#ccc}.wrpnew{float:left;width:100%;text-align:left}p.botm_style.botm_styleppp{float:left}.limt_assets.feee{float:left;margin-right:5px}.ticketactive{position:absolute;right:0;z-index:9;top:0}.imgmain{position:relative;display:block}.ticketcount{position:absolute;bottom:10px;right:0}.tickstats.ticketcount .count_values_close{height:auto;width:auto;padding:4px 11px;border-radius:3px;background:#3c8dbc;font-size:18px;line-height:100%;right:0}.hd1{display:none}.limt_assets22{display:inline-block}.input-style{width:69%;float:left;color:red;padding:5px;font-weight:700}.limit_icn{background:#21648c;padding:0;border-radius:3px;text-align:center;width:20px;float:left;margin-top:5px;color:#fff;padding:1px 0}.limit_wrap{display:none;position:absolute;background:#fff;padding:17px 25px 25px 25px;right:24px;min-width:355px;border:1px solid #b7b4b4;border-radius:5px;top:40px;z-index:9;padding-bottom:6px}span.limit{position:relative}.off_limiwrwp{position:absolute;right:0;top:0;background:#55aee1;color:#fff!important;padding:4px}.assetvalue a{white-space:nowrap}span.mobile_css{color:#c82222}.limit2 span.limit_icnf.limit23{margin-top:119px;margin-right:-25px}.cross_limit{color:red;font-weight:700}.stype1 span.label{color:#333!important;background:0 0!important;font-size:14px;font-weight:400!important}.active_css{padding:.2em .6em .3em;border-radius:2px;color:#3c8dbc;border:1px solid #3c8dbc;min-height:20.23px;float:left;padding-top:4px}.label_style{padding:0}.pull_out{background:0 0!important;padding:.2em .6em .3em;border-radius:2px;color:red!important;border:1px solid red}.On_Hold{color:#7f00ff!important;padding:.2em .6em .3em;border-radius:2px;background-color:#fff;border:1px solid #7f00ff}.pullouted{border-radius:2px;color:#ccc!important;font-size:13px;background:0 0!important;border:0!important;padding-left:0}.service123{background-color:transparent;padding:0}span.On_Hold_asset{color:#7f00ff!important;padding:.2em .6em .3em;border-radius:2px;background-color:#fff;border:1px solid}.In_Service_aasse{color:#3c8dbc;padding:.2em .6em .3em;border:1px solid #3c8dbc;background:0 0!important;border-radius:2px}.void_css{color:#ccc;font-size:13px;padding-left:0;background:0 0!important}.cno a{white-space:nowrap}span.limit_icnf{float:right;background:#2d5764;color:#fff;border-radius:3px;width:20px}.limitvv{float:right;clear:both;margin-top:4px;position:relative}.limit_wrapp{display:none;position:absolute;background:#fff;padding:17px 25px 25px 25px;right:31px;min-width:355px;border:1px solid #b7b4b4;border-radius:5px;top:0;z-index:9;padding-bottom:6px}.wrp1234{float:left;width:100%}.wrp1234 .asset_remaindays{width:auto;margin-right:7px}.wrp1234 .caseseriall{width:auto;float:left}.wrp1234 p.botm_style.srn1{float:left;width:auto;margin:1px 4px 0 2px}.btnwrps li{padding-top:3px;background:0 0}.fa{cursor:pointer}.fffff{cursor:pointer}.rmaining22{display:inline-block;background:red;color:#ff6;min-width:50px;text-align:center;border-radius:2px;margin-left:15px}p.new_usages{display:inline-block;margin-bottom:15px;width:100%}.asset_remaindays{float:left;width:auto;text-align:left;margin-right:7px;margin-top:6px;line-height:18px}.sku_css{color:#3c8dbc;cursor:pointer;float:left;margin-top:0;font-size:23px}
	span.contract_no_css{}.itm_wrap{box-shadow:0 1px 3px 1px #999;padding:0 0;margin:23px 0 0 0;padding-bottom:0;float:left;width:100%}.itm_wrap .heading2{font-weight:600;text-transform:uppercase;font-size:20px}.row4343 p{width:auto;display:inline-block}.labelee{background:#55aee1;text-transform:uppercase;min-height:20px;border:none;height:20px!important;display:inline-block;vertical-align:middle;line-height:15px}p span .btn-warning{float:right;margin-top:17px}p span .btn-danger{margin-top:15px;margin-left:176px}.row4343 img{width:20px;height:20px}.botm_style{margin:0}.head{color:#fff;float:left;width:100%;padding:0 15px}.head h3{margin:0;border:none;background:#55aee1;float:left;width:100%;padding:0}.head h3 span{background:#3c8dbc;padding:5px 15px;float:left;padding-left:7px}.maindtext{border:none}.itm_wrap2{float:left;width:100%;background:#f1f1f1;padding:0 0}.row4343 img{width:20px;height:20px}p.botm_style span{float:left;width:100%}p{margin:0 0 2px}.upcondep .textbox{width:50%;margin-bottom:5px}.updtcssrl .textbox{width:50%}.rremv{background:red;color:#fff;padding:1px 5px;cursor:pointer}table input[type=checkbox]{zoom:1.5;-moz-transform:scale(1.5)}.maindtext p{text-align:left}.itm_wrap p.heading2.caseseriall{FONT-SIZE:17PX}.img_wrap1 img{width:100%}p.botm_style.botm_styleppp span{}p.botm_style.botm_styleppp span.inser{float:right}p.botm_style.botm_styleppp span.inser .label.labelee{width:auto;background:0 0;color:#000;font-size:18px;text-transform:capitalize;font-weight:400}.tools1{float:right;padding:5px;padding-top:10px}.tools1 p.refresh1 img{width:100%;margin-bottom:6px}.tlft{width:90%;min-height:145px;float:left;padding-top:10px}.botm_style.botm_styleppp{font-size:18px}.hide123{display:none!important}.show12{display:block!important}.popstyle1 h3{font-size:15px;color:#0a0ac3;border-bottom:none;padding-left:0;border-bottom:none;margin:10px 0;min-width:293px}.popstyle1 .submitbutton{background:red;color:#fff;float:right;border:1px solid #ea0c0c;width:72px;height:25px}.popstyle1 .textbox{width:69%;height:25px}.clode112{position:absolute;top:0;right:0;background:#55aee1;color:#fff}.remaindays .span2{float:left}.technician_info{float:left;margin:0 5px;cursor:pointer;color:#333;text-transform:capitalize}.remaindays{text-align:left;float:left;width:auto;margin-bottom:10px;margin-right:8px;margin-top:0}.remaindays span.span2321{font-weight:600;color:#55aee1;margin-left:3px}.popstyle1{position:absolute;background:#fff;z-index:9;right:47px;top:11px;padding:16px 15px 21px 15px;border:1px solid #bbb;text-align:left}.select123{width:69%;height:25px}.head h3 span{text-transform:capitalize}.hideondstp1{display:none}.imgstyle{padding:12px}.imgstyle img{border:1px solid #55aee1;padding:10px;border-radius:6px;background:#fff;margin-bottom:2px;margin-bottom:7px}span.inser span{border-radius:5px;height:24px!important;display:inline}.notetext i{position:absolute;right:0;top:0;background:#55aee1;color:#fff!important;padding:2px}.popbox .note-toolbar.panel-heading{display:none}.note-editor.note-frame .note-editing-area .note-editable{text-align:left}.notewrap{position:relative;padding-left:0;padding-top:0;float:NONE;margin:0 7px;line-height:100%;DISPLAY:INLINE-BLOCK!important;MARGIN-TOP:0PX;VERTICAL-ALIGN:top}.asetnotewrap{display:none;position:absolute;background:#fff;padding:36px 20px 28px 20px;width:345px;right:46px;border:1px solid #bbb;top:12px;z-index:9}.asetnote i{font-size:22px;cursor:pointer}.asetnote{display:block;margin-top:6px;position:relative}.asetnotewrap i{float:right;position:absolute;right:0;top:0;color:#fff;background:#55aee1;padding:2px}.action_list button{border:none;font-weight:600;color:#fff;padding:2px 12px;border:none;border-radius:3px;margin:0 15px;margin-top:8px;text-transform:capitalize}.action_list{justify-content:space-around;width:100%}.asetnote i{font-size:12px;cursor:pointer;color:#fff}.kkkkk{background:#ccc;display:inline-block;min-width:37px;color:#000;text-align:center;border-radius:2px;font-size:13px;font-weight:600;padding:1px 0;height:20.23px;border:1px solid #ccc;float:left}.notetext textarea{width:100%;min-height:90px}.notetext{display:none;position:absolute;background:#fff;padding:25px;right:24px;min-width:355px;border:1px solid #b7b4b4;top:0;border-radius:5px;top:41px;z-index:9;padding-bottom:6px}.notetext input.submitbutton{padding-top:2px;padding-bottom:2px;float:right}.memo1{position:absolute;background:#fff;z-index:9;right:47px;top:11px;padding:28px 15px 21px 15px;border:1px solid #bbb;text-align:left;min-width:250px}.close_popup{position:absolute;top:0;right:0;background:#55aee1;color:#fff;padding:1px 5px}.memo1 textarea{width:100%;margin-top:10px;white-space:nowrap}.memo1 .submitbutton{background:red;color:#fff;border:1px solid red;float:right}span.memovalue1{position:relative}span.notewrap i{font-size:20px;color:#55aee1}.note123{display:none;position:absolute}.btnmb1{clear:both;display:block}.rrd123{background:#55aee1;padding:0;border-radius:3px;text-align:center;width:20px;float:left;height:20px;line-height:20px}span.notewrap span.rrd123{padding:2px 3px;text-align:center;vertical-align:middle;padding-bottom:0;margin-top:6px;line-height:18px;font-size:13px;display:inline-block}span.notewrap i.icn123{font-size:13px;color:#fff;line-height:18px}.count_values{cursor:pointer;background:red;border-radius:3px;text-align:center;cursor:pointer;line-height:29px;display:inline-block;color:#fff;font-weight:600;font-size:18px;padding:3px 14px}.count_values_close{height:30px;background:#d3cbcb;border-radius:28px;width:30px;text-align:center;cursor:pointer;line-height:30px;display:inline-block;color:#fff;font-weight:600}.actual_pages1{border-radius:2px;min-width:39px;padding-left:6px;padding-right:6px}.display_front{float:left;margin-right:2px;font-size:14px;cursor:pointer;margin-top:0}.newicn{float:left;padding-top:3px;margin-right:5px}.popupst2{position:absolute;background:#fff;z-index:9;top:66px;padding:29px 10px 28px 10px;border:1px solid #bbb;text-align:left;left:13px;width:313px}.popupst2 .rremv{position:absolute;right:0;top:0;background:#55aee1}.popupst2 input.submitbutton{background:red;color:#fff;border:none;float:right;height:28px}.popupst2 input.textbox{width:77%;padding:2px 5px;text-transform:uppercase;height:28px;float:left}.heading223{float:left}.page_limit{cursor:pointer}.actual_pages{cursor:pointer}.valuewrap select{width:77%;padding:2px 5px;text-transform:uppercase;height:28px;float:left}.valuewrap input.submitbutton{background:red;color:#fff;border:none;float:right;height:28px}
	.listlist{min-width:115px}
	.listmemo{position:absolute;background:#fff;padding:25px;right:24px;min-width:432px;border:1px solid #b7b4b4;border-radius:5px;top:-1px;padding-bottom:5px;z-index:9}.popbox.limitbox{border:none;padding:0}.title_css{float:left;margin-bottom:10px;color:#3c8dbc;font-size:14px}.mamo_list{position:relative}.upmemo{background:#3c8dbc;color:#fff;padding:2px 5px 2px 5px;border-radius:1px}.closepopup{position:absolute;right:0;top:0;background:#55aee1;color:#fff!important;padding:5px}.listmemo .submitbutton22{color:#fff;float:right;font-size:13px;width:72px;height:25px;line-height:100%}.listmemo form{width:30%;float:right}.noteupdate form{float:right;width:100%}.noteupdate{float:left;width:100%;padding-top:10px}.noteupdate span{margin-bottom:5px;display:inline-block}.popbox{float:left;width:100%;border:1px solid #bdbcbc;margin-bottom:18px;padding:15px;border-radius:5px}.popbox .select2{width:69%!important;height:25px;float:left}.popbox input.submitbutton{background:#3c8dbc;color:#fff;float:right;border:1px solid #3c8dbc;width:68px;height:25px;text-align:center;margin-left:15px;font-weight:600}.popbox span.select2-selection__arrow{height:20px!important}.popbox .select2-selection{height:25px;padding:0 11px;text-align:left}.row.maindtext{position:relative}.dipar{background:#fff;padding:20px;width:300px;border:1px solid #b7b4b4;top:23px;border-radius:5px;z-index:9;float:left;position:absolute;margin-left:15px;margin-top:15px;padding-top:25px}.dipar .submitbutton{color:#fff;float:right;width:72px;height:26px;line-height:100%;background:#ea0a0a;border-color:#ea0a0a}.dipar input[type=text]{height:26px;width:67%;background:#fff;border:1px solid #ccc}span.inser.hhhh span.label.labelee{background:#3c8dbc}.rrdvd:before{color:#fff}.head h3 .rrdvd{color:transparent;padding-right:0!important;padding-left:0!important;width:25px;overflow:hidden;height:31px}.closediper{position:absolute;right:0;top:0;background:#55aee1;color:#fff!important;padding:3px 4px}.bg_blue{background:#3c8dbc}
	small.error_msg { font-size: 26px;  margin-left: 276px;  position: fixed;   top: 57px;  background: #f33112f0; color: #fff; padding: 32px 50px; z-index: 99; border-radius: 3px; box-shadow: -1px 5px 2px 3px #e6e4e4;}
	@media only screen and (max-width:767px){
	.mrgndgh {
		
		margin-top: 4px !important;
	}
	.mrgndgh span.fulwdth {
		float: left !important;
		width: 92px !important;
	}
	.t-label {
		min-width: 62px !important;
		font-size: 10px !important;
		float: unset !important;
	}
	.t-number {
		padding-left: 2px !important;
		font-size: 10px !important;
	}
	.t-label2 {
		min-width: 62px !important;
		font-size: 10px !important;
	}
	.t-label2 {
		min-width: 62px !important;
		font-size: 10px !important;
	}
	.nav-tabs-custom>.nav-tabs {
		margin-top: 20px;
	}
	.rrdefv2{width:50px;height:45px;line-height:45px}.rrdefv{width:100%}.tools1 .btnmb1{width:50px;position:relative;display:inline-block;clear:none;height:50px}.tools1 .limitvv{text-align:center}span.rrdefv2.limit_icnf{float:none;display:inline-block;width:50px}.tools1{position:absolute;right:14px;max-width:123px;width:100px}.tools1{display:block;width:100%}.{display:block;padding-left:0}.tlft{width:100%;padding-left:5px}.popstyle1{max-width:260px;padding:16px 8px 8px 8px;right:44px}.limit_wrapp{padding:15px 10px 6px 10px;right:23px;min-width:280px}span.tickstats.ticketcount{bottom:0;top:auto}.imgmain{height:159px;width:159px;margin-bottom:14px}.btnmb1.sentto{position:relative;top:-2px}.count_values{line-height:24px;font-size:16px;padding:3px 11px}.rrdefv2 i{font-size:25px!important}.popbox input.submitbutton{width:60px;margin-left:8px}.limit_wrap{padding:10px 10px 6px 10px;right:24px;min-width:280px}.limitbox .input-style{height:25px;border:1px solid #bbb}.tickstats{top:0}.popstyle1 h3{width:100%;float:left;font-size:12px}.popstyle1 .submitbutton{width:64px;font-size:12px}.head h3{font-size:22px;text-align:center}.head h3 span{float:none;display:inline-block}.itm_wrap .heading2{font-size:14px}.mrgndgh{margin-left:0!important}.asset_remaindays{margin:0;margin-left:0;margin-right:5px;margin-top:0}.asset_remaindays .badge{border-radius:4px;color:#fff;font-size:13px;padding:4px 7px 4px 7px;position:relative}.notetext{padding:10px;min-width:280px;padding-top:31px}.popbox input.submitbutton{width:64px;height:25px;margin-left:5px}.display_front{margin-right:3px}span.tickstats{float:left}.remaindays{margin-bottom:0;margin-right:4px}.botm_style.botm_styleppp{font-size:14px;margin-bottom:5px}.limt_assets.feee{margin-bottom:5px;font-size:14px}.nav-tabs-custom>.tab-content{padding:10px 0}.fulwdth{width:100%;float:left}.display_front{margin-right:2px}.t-label2{padding-left:0}.t-label{padding-left:0}.fll{float:left;margin-top:6px}.t-label{min-width:124px;display:inline-block}.t-label2{min-width:124px;display:inline-block}span.btnmb1.notewrap span.rrd123.rrdefv2{padding:4px;width:auto;height:auto;margin-top:0;line-height:13px}span.btnmb1.notewrap span.rrd123.rrdefv2 i{font-size:13px!important;line-height:10px}.sku_css{font-size:16px}.head h3 span{vertical-align:top}.head h3{font-size:22px;text-align:center;padding:10px 0}
	}
	.mrgndgh {
		margin-left: 20%;
		position: fixed;
		margin-top: -24px;
	}
	.inner-col-up .col-lg-6
	{
	padding:0px; margin:0px;}
	.inner-col-up p
	{
		font-size: 21px;
		text-transform:capitalize;
	}
	.inner-col-up p.reduce-fonts
	{
		font-size: 17px;
		margin-top: 3px;
	}
	.department-sec-new p
	{
		width: 100%;
	}
	.half-color
	{
		background: #3c8dbc;
		padding: 3px 10px !important;
	}
	.half-color
	{
	position:relative;
	}
	.department-sec-new
	{
	padding: 3px 10px !important;
	}
	.department-sec-new p
	{
	color:#f0ff10;
	}
	.comment-to
	{
	cursor:pointer;
	}
	.hover-comments
	{
		display: none;
		position: absolute;
		z-index: 999999999;
	   width: 170px;
		left: 0px;
			background: #fff !important;
		border: 1px solid #a7a5a5;
		font-size: 14px;
		border-radius: 4px;
		text-align: center;
		padding: 4px 2px;
		top: 22px;
		color: #6f6f6f;
	}
	.comment-to:hover .hover-comments 
	{
	display:block;
	}
	span.fffff.kkkkk span.badge.hththtth {
		top: -1px;
	}
	.badge {
		font-size: 11px;
		padding: 3px 7px 3px 7px;
	}
	.kkkkk {
		 background: none !important; 
	 border: none !important;
		}
		.span2.asste_css .badge {
		padding: 0px 4px;
	}
	.nav-tabs-custom .nav.nav-tabs li.active a
	{
	color:red;
	}
	span.circle-1 {
		margin-left: 8px;
	}

.onhoverfile:hover > .hovertextfile {
    display: block;
    position: absolute;
    background: #000;
    color: #fff;
    padding: 7px;
    border-radius: 4px;
    /* top: 0; */
    /* left: 62%; */
    z-index: 10;
    min-width: 329px;
    text-align: left;
}
.hovertextfile {
    display: none;
}

.onhoverfile:hover > .hoverfile {
    display: block;
    font-size: 15px;
    text-align: center;
    position: absolute;
    background: #000;
    color: #fff;
    padding: 10px;
    border-radius: 4px;
    z-index: 10;
    min-width: 140px;
}
.hoverfile {
    display: none;
}


td.onhoverfile {  
  position: relative;
  }
	</style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	
	
	<aside class="right-side">
		<!-- Content Header (Page header) -->
		<!-- <section class="content-header" style="display: flex; justify-content: center; align-items: center;"> -->
		<section class="content-header" style="display: flex; align-items: center; justify-content: space-between;">
			
			<span style="font-size: 15px; width: max-content;" class="one">
				<span style="color: red;"><?php echo $client['name']; ?></span>
				<br>
				<span class="viewAllInvoiceButtonsm">Total Invoice:
					 <span style="color: blue; font-size: 15px;" class="t-number autoNumeric animated-number">
						<?php echo countTableFiltered("invoice","clintid",$_GET['id']); ?>
					</span> 
				</span>
				<span style="padding-left: 15px !important;">
					Total Paid:
					<span style="color: blue; font-size: 15px;" class="t-number autoNumeric animated-number">
						<?php echo number_format(getTotalAmount('invoice','paid','clintid',$_GET['id']));?>
					</span>
				</span>
			</span>

			<span style="font-size: 15px; width: max-content;" class="two">
				<span>
					Contract Amount:
					<span class="t-number autoNumeric animated-number" style="font-size: 15px;">
						<?php 
							$value = getTotalAmount('contract','contract_amount','clientid',$client['id'],'is_end',0);
							echo number_format($value) . ' (<span title="Contract Qty">'. countTableFiltered('contract','clientid',$client['id'],'is_end',0).'</span>) ';
						?>
					</span>
				</span>
				<br>
				<span>
					Deposit Amount:
					<span class="t-number autoNumeric animated-number" style="font-size: 15px;">
						<?php echo number_format(getTotalAmount('contract','deposit','clientid',$client['id'])) ;?>
					</span>
				</span>
			</span>

			<span style="font-size: 15px; width: max-content;" class="three">

				<span>
					Invoice to pay :
					<span style="color: red;font-size: 15px;" class="t-number autoNumeric animated-number">
						<?php echo countwithcondition('invoice','balance','>','0','clintid','=',$_GET['id']); ?>
					</span>
				</span>
				<br>
				<span>
					Receivable:
					<span class="t-number autoNumeric animated-number" style="color: red;font-size: 15px;">
						<?php echo number_format(getTotalAmount('invoice','balance','clintid',$_GET['id']));?>
					</span>
				</span>

			</span>

			<span style="font-size: 15px; width: max-content;" class="four">
				<span>
					Tax File to Follow : 
					<span style="color: red;font-size: 15px;" class="t-number autoNumeric animated-number">
						<?php echo countwithconditiontextfile('invoice','clintid','=',$_GET['id']); ?>
					</span>
				</span>
				<br>
				<span>
					Follow Up:
					<span style="color: red;font-size: 15px;" class="t-number autoNumeric animated-number">
						<?php echo counttofollow('invoice','clintid','=',$_GET['id']); ?>
					</span>
				</span>
			</span>

			<!-- <span style="font-size: 15px; width: max-content; display: flex; justify-content: center; align-items: center; gap: 5%;" class="five">

				<span>
					<?php
					$m = $client['for_the_month'] == 0 ? '1' : $client['for_the_month'];
						echo "<a class='btn btn-success btn-sm' target='_blank' href='?route=pdf/issue_invoice&clientid=".$client['id']."&month=".$m."'>Print Invoice</a>";
					?>	
				</span>

			</span> -->

			<span style="font-size: 15px; width: 44%; display: flex; justify-content: end;" class="six">
	
					<a data-toggle='tooltip' title='New Contract' class="btn btn-primary btn-sm" href="?route=contract/create&clientid=<?php echo $client['id']?>&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&section=contract" >
						New Contract
					</a>

					<a data-toggle='tooltip' title='New License' class="btn btn-default btn-sm" href="?route=licenses/create&clientid=<?php echo $client['id']; ?>">
						New License
					</a>
					
					<a data-toggle='tooltip' title='New Issue' class="btn btn-default btn-sm" href="#" onClick='showM("ajax.php?modal=issueAdd&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&clientid=<?php echo $client['id']; ?>&section=issues");return false'>
						<i class="fa fa-tasks"></i>
					</a>

					<a data-toggle='tooltip' title='New Asset' class="btn btn-default btn-sm" href="?route=assets/create">
						<i class="fa fa-barcode"></i>
					</a>
					
					<a data-toggle='tooltip' title='New Project' class="btn btn-default btn-sm" href="#" onClick='showM("ajax.php?modal=projectAdd&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&clientid=<?php echo $client['id']; ?>&section=projects");return false'>
						<i class="fa fa-lightbulb-o"></i>
					</a>

					<a data-toggle='tooltip' title='New Ticket' class="btn btn-default btn-sm" href="#" onClick='showM("ajax.php?modal=contractTicketAdd&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&clientid=<?php echo $client['id']; ?>&contractid=&section=tickets");return false'>
						<i class="fa fa-tag"></i>
					</a>

					<a data-toggle='tooltip' title='New Credential' class="btn btn-default btn-sm" onClick='showM("ajax.php?modal=credentialAdd&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&clientid=<?php echo $client['id']; ?>&section=credentials");return false'>
						<i class="fa fa-asterisk"></i>
					</a>

					<a data-toggle='tooltip' title='New User' class="btn btn-default btn-sm" onClick='showM("ajax.php?modal=userAdd&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&clientid=<?php echo $client['id']; ?>&section=users");return false'>
						<i class="fa fa-user"></i>
					</a>

					<a data-toggle='tooltip' title='Upload File' class="btn btn-default btn-sm " href="#" onClick='showM("ajax.php?modal=uploadFile&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&clientid=<?php echo $client['id']; ?>&section=files");return false'><i class="fa fa-upload"></i></a>
					<a data-toggle='tooltip' title='Assign Admin' class="btn btn-default btn-sm" href="#" onClick='showM("ajax.php?modal=clientAssignAdmin&reroute=clients/manage&routeid=<?php echo $client['id']; ?>");return false'><i class="fa fa-thumb-tack"></i> </a>

					<?php
					$m = $client['for_the_month'] == 0 ? '1' : $client['for_the_month'];
						echo "<a class='btn btn-default btn-sm' target='_blank' href='?route=pdf/issue_invoice&clientid=".$client['id']."&month=".$m."' title='Print Asset Q.R code'><i class='fa fa-qrcode' aria-hidden='true'></i></a>";
					?>	
					<a class="btn btn-success btn-sm" href="?route=clients/invoice&id=<?php echo $client['id']; ?>" " style='margin-left: 3px;'>Create Invoice</a>
					<button style='margin-left: 3px;' class="btn btn-danger btn-sm" id="process_payment_btn" data-clientid="<?php echo $client['id']; ?>">
						Receive Payment
					</button>
			</span>

				<!-- <span class="badge" style="background: #238C00;border-radius: 20%; font-size: 15px;padding: 6px 9px;">
					<?php echo countTableFiltered("invoice","clintid",$_GET['id']); ?>
				</span>
				<span style="color:#238C00; cursor: pointer;"> View All Invoice</span> -->
			
				<!-- <span class="fulwdth">
					<span class="t-label">Contract Qty:</span>
					<span class="t-number"><?php echo countTableFiltered('contract','clientid',$client['id'],'is_end',0);?></span>
				</span> -->
					
				<?php if($lia['role'] != 'technician'){ ?>
					<!-- <span class="fulwdth">
						<span class="t-label2">Total Deposit:</span>
						<span class="t-number autoNumeric animated-number"><?php echo number_format(getTotalAmount('contract','deposit','clientid',$client['id']));?></span>
					</span>
					<span class="fulwdth">
						<span class="t-label2">Total Contract Amount:</span>
						<span class="t-number autoNumeric animated-number"><?php 
						$value = getTotalAmount('contract','contract_amount','clientid',$client['id'],'is_end',0);
							echo number_format($value);
							?></span>
					</span> -->
				<?php } ?>
		</section>
	
		<!-- Main content -->
		
		<div id="page-loader">
		<div class="page-loader-inner">
			<div class="loader-logo">
			<?php if($_GET['status'] == "88") echo "<small class='error_msg'>Select contract first to print label</small>";?>
			
			</div>
			
		</div>
	</div>
	
	<script>
	jQuery(function () {	jQuery("#page-loader .error_msg").delay(10000).fadeOut(10000, function(){
			jQuery("#page-loader").fadeOut(10000);
			document.cookie = "var1=1";
			});
	}); 
	  </script>
    	
		<section class="content" style="border-top-color: red; border-width: 2px;">
			
		<?php if($_GET['status'] == "445") echo "<small class='badge bg-green'>Cutt Off can not be less Then start Data</small>"; 
		
		?>
			<?php if(!empty($statusmessage)): ?>
			<div class="row"><div class='col-md-12'><div class="alert alert-<?php print $statusmessage["type"]; ?> alert-auto" role="alert"><?php print $statusmessage["message"]; ?></div></div></div>
			<?php endif; ?>
			<div class="row">

				<div class="col-md-12 ">
					<div class="nav-tabs-custom">
					<!-- <div class="nav-tabs-custom" style="border-top: 3px solid #3c8dbc;"> -->
						<ul class="nav nav-tabs">
							<li <?php if ($section == "summary") echo 'class="active" '; ?> ><a href="#tab-summary" data-toggle="tab">Summary</a></li>
							<li <?php if ($section == "assets") echo 'class="active"'; ?> ><a href="#tab-assets" id="go-assets" data-toggle="tab">Assets</a></li>
							
							<li <?php if ($section == "licenses" || $_GET['tab'] == "license") echo 'class="active"'; ?> ><a href="#tab-licenses" id="go-licenses" data-toggle="tab">Licenses</a></li>
							<li <?php if ($section == "projects") echo 'class="active"'; ?> ><a href="#tab-projects" id="go-projects" data-toggle="tab">Projects</a></li>
							<li <?php if ($section == "issues") echo 'class="active"'; ?> ><a href="#tab-issues" id="go-issues" data-toggle="tab">Issues</a></li>
							
							<li <?php if ($section == "credentials") echo 'class="active"'; ?> ><a href="#tab-credentials" id="go-credentials" data-toggle="tab">Credentials</a></li>
							<li <?php if ($section == "users" || $_GET['tab'] == "users") echo 'class="active"'; ?>><a href="#tab-users" id="go-users" data-toggle="tab">Users</a></li>
							<li <?php if ($section == "files") echo 'class="active"'; ?> ><a href="#tab-files" data-toggle="tab">Files</a></li>
							<li class="contratc_active" <?php if ($section == "" && $_GET['tab'] != "license"&& $_GET['tab'] != "department" ) echo 'class="active"'; ?> ><a href="#tab-contract" data-toggle="tab">Contract</a></li>
							<li class="create_tic <?php if ($_GET['tab'] == "department") echo 'active'; ?>" ><a href="#tab-department" data-toggle="tab">Create Tickets</a></li>
							<li <?php if ($section == "tickets") echo 'class="active"'; ?> ><a href="#tab-tickets" id="go-tasks" data-toggle="tab">Ticket List</a></li>
							<li <?php if ($section == "invoice" || isset($_GET['tab']) && $_GET['tab'] == "invoice") echo 'class="active"'; ?> ><a href="#tab-invoice" data-toggle="tab">Invoice</a></li>
							
							<li <?php if ($section == "adepartment"|| $_GET['tab'] == "adepartment") echo 'class="active"'; ?>><a href="#tab-adepartment" id="go-adepartment" data-toggle="tab">Department list</a></li>
							<li <?php if ($section == "emailnew" || $_GET['tab'] == "emailnew") echo 'class="active"'; ?> ><a href="#tab-email" data-toggle="tab">Email </a></li>
							<li <?php if ($section == "usagereport" || $_GET['tab'] == "usagereport") echo 'class="active"'; ?> ><a href="#tab-usagereport" data-toggle="tab">Usage Report</a></li>
							<li <?php if ($section == "actuallstatus" || $_GET['tab'] == "actuallstatus") echo 'class="active"'; ?> ><a href="#tab-actuallstatus" data-toggle="tab">Page Report</a></li>
							<li <?php if ($section == "reportnew" || $_GET['tab'] == "reportnew") echo 'class="active"'; ?> ><a href="#tab-report" data-toggle="tab">Report</a></li>
							<li <?php if ($section == "invoice1" || $_GET['tab'] == "invoice1") echo 'class="active"'; ?> ><a href="#tab-invoice1" data-toggle="tab">Invoice 1</a></li>
							
	

	
						</ul>
						<div class="tab-content">
							<div class="tab-pane <?php if ($section == "summary") echo 'active'; ?>" id="tab-summary">
								 <!-- Small boxes (Stat box) -->
								 <p> <span style="color: red; font-weight: bold; font-size: 16px;">Tax Identification Number :</span> <?php echo $client['tax_identification_number']; ?></p>
								 <div class="row">
									<div class="col-lg-3 col-xs-6">
										<!-- small box -->
										<div class="small-box bg-yellow">
											<div class="inner">
												<h3><?php echo $sumContract; ?></h3>
												<p>Contract</p>
											</div>
											<div class="icon">
												<i class="fa fa-book"></i>
											</div>
										</div>
									</div>
									<!-- ./col -->
									<div class="col-lg-3 col-xs-6">
										<!-- small box -->
										<div class="small-box bg-aqua">
											<div class="inner">
												<h3><?php echo $sumAssets; ?></h3>
												<p>Assets</p>
											</div>
											<div class="icon">
												<i class="fa fa-barcode"></i>
											</div>
										</div>
									</div>
									<!-- ./col -->
									<div class="col-lg-2 col-xs-6">
										<!-- small box -->
										<div class="small-box bg-green">
											<div class="inner">
												<h3><?php echo $sumLicenses; ?></h3>
												<p>Licenses</p>
											</div>
											<div class="icon">
												<i class="fa fa-certificate"></i>
											</div>
										</div>
									</div>
									<!-- ./col -->
									<div class="col-lg-2 col-xs-6">
										<!-- small box -->
										<div class="small-box bg-navy">
											<div class="inner">
												<h3><?php echo $sumCredentials; ?></h3>
												<p>Credentials</p>
											</div>
											<div class="icon">
												<i class="fa fa-lightbulb-o"></i>
											</div>
										</div>
									</div>
									<!-- ./col -->
									<div class="col-lg-2 col-xs-6">
										<!-- small box -->
										<div class="small-box bg-red">
											<div class="inner">
												<h3><?php echo $sumUsers; ?></h3>
												<p>Users</p>
											</div>
											<div class="icon">
												<i class="fa fa-briefcase"></i>
											</div>
										</div>
									</div>
									<!-- ./col -->
	
								</div>
								<!-- /.row -->
	
	
								<div class="row">
									<div class="col-md-8">
										<!-- TO DO List -->
										<div class="box box-primary">
											<div class="box-header">
												<i class="fa fa-tag"></i>
												<h3 class="box-title">Opened Tickets</h3>
											</div>
											<!-- /.box-header -->
											<div class="box-body">
												<ul class="todo-list">
													<?php if(empty($openTickets)) echo "There are no opened tickets."; ?>
													<?php foreach ($openTickets as $ticket) { ?>
													<li>
														<span class="text"><a href='?route=tickets/manage&id=<?php echo $ticket['id']; ?>'>#<?php echo $ticket['ticket']; ?> <?php echo $ticket['subject']; ?></a></span>
														<!-- Emphasis label -->
														
														<?php if($ticket['status'] == "Open") echo "<small class='badge bg-green'>Open</small>"; ?>
														<?php if($ticket['status'] == "In Progress") echo "<small class='badge bg-navy'>In Progress</small>"; ?>
														<?php if($ticket['status'] == "Followed Up") echo "<small class='badge bg-teal'>Followed Up</small>"; ?>
														<?php if($ticket['status'] == "Reopened") echo "<small class='badge bg-orange'>Reopened</small>"; ?>
														<?php if($ticket['status'] == "Closed") echo "<small class='badge bg-gray'>Closed</small>"; ?>
														<!-- General tools such as edit or delete-->
														<div class="tools">
															<a href='?route=tickets/manage&id=<?php echo $ticket['id']; ?>' class='btn-right text-dark'><i class='fa fa-eye'></i></a>&nbsp;
															<a href='#' onClick='showM("ajax.php?modal=contractTicketEdit&reroute=dashboard&routeid=&id=<?php echo $ticket['id']; ?>&section=");return false' class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
															<a href='#' onClick='showM("ajax.php?modal=contractTicketDelete&reroute=dashboard&routeid=&id=<?php echo $ticket['id']; ?>&section=");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
														</div>
													</li>
													<?php } ?>
												</ul>
											</div>
											<!-- /.box-body -->
											<div class="box-footer clearfix no-border">
												<a onClick='showM("ajax.php?modal=contractTicketAdd&reroute=dashboard&routeid=&section=&clientid=<?php echo $client['id']?>");return false' data-toggle="modal" class="btn btn-primary btn-sm pull-right">NEW TICKET</a>
											</div>
										</div>
										<!-- /.box -->
										<div class="box box-primary">
											<div class="box-header">
												<i class="fa fa-book"></i>
												<h3 class="box-title">Recent Contract</h3>
											</div>
											<!-- /.box-header -->
											<div class="box-body">
												<div class="table-responsive">
									<table id="" class="table table-striped table-hover">
										<thead>
											<tr>
												<th>Contract No.</th>
												<th>Service Type</th>
												<!--<th>Client</th>-->
												<th>Asset</th>
												<!--<th>Model</th>
												<th>Serial No.</th>-->
											   <?php if($lia['role'] != 'technician'){ ?> <th>Amount</th> <?php } ?>
												<th>Contract End<span title="Contract End Date		
	Contract Date + 1 Year" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span></th>
												<th>D-Day<span title="Today - Contract End Date" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span>	
	</th>
												<th>Total Milage</th>
												<!--<th>Status</th>-->
												<th class="text-right"></th>
											  
											</tr>
										</thead>
										<tbody>
											<?php
											foreach ($recentcontracts as $contract) {
											
										
											//$manufacturerid = getSingleValue("models","manufacturerid",$contract['modelid']);
											echo "<tr>";
											echo "<td><a href='?route=contract/manage&id=".$contract['id']."&reroute=clients/manage&routeid=".$client['id']."&contractid=".$contract['id']."&section=contract'>".$contract['contractno']."</a></td>";
											echo "<td><span class='label' style='background-color:#FFF;color:".getSingleValue("assetcategories","color",$contract['categoryid']).";border:1px solid ".getSingleValue("assetcategories","color",$contract['categoryid'])."'>".getSingleValue("assetcategories","name",$contract['categoryid'])."</span></td>";
											//echo "<td><a href='?route=clients/manage&id=".$contract['clientid']."'>".getSingleValue("clients","name",$contract['clientid'])."</a></td>";
											$modelid = getSingleValue("assets","modelid",$contract['assetid']);
											$modelname = getSingleValue("models","name",$modelid);
											$asset_serial = getSingleValue("assets","serial",$contract['assetid']);
											echo "<td><a href='?route=assets/manage&id=".$contract['assetid']."'>".getSingleValue("assets","tag",$contract['assetid']). " : " . $modelname . " : " . $asset_serial ."</a></td>";
											if($lia['role'] != 'technician'){
											echo "<td class='text-right'><span class='autoNumeric'>".$contract['contract_amount']."</span></td>";
											}
											$expiry = ($contract['contract_expiry'] == '0000-00-00' || $contract['contract_expiry'] == null) ? '' : $contract['contract_expiry'];
											echo "<td>".$expiry."</td>";
											//Calculate the remaining days
											$str = (strtotime($contract['contract_expiry']) > strtotime(date("Y-m-d"))) ? floor((strtotime($contract['contract_expiry']) - strtotime(date("Y-m-d")))/3600/24) : '<span class="badge" style="background-color:#ff0000">Expired</span>';
											echo "<td>".$str."</td>";
											echo "<td class='text-right'><span class='autoNumeric'>".getTotalAmount('contract_usages','month_mileage','contractid',$contract['id'])."</span></td>";    
											//echo "<td>".getSingleValue("manufacturers","name",$manufacturerid)."</td>";
											//echo "<td>".getSingleValue("manufacturers","name",$manufacturerid)." ".getSingleValue("models","name",$contract['modelid'])."</td>";
											//echo "<td>".$contract['serial']."</td>";
											//echo "<td>".getSingleValue("suppliers","name",$contract['supplierid'])."</td>";
											//Calculate the remaining days
											//    $str = (strtotime($contract['warranty_expiry']) > strtotime(date("Y-m-d"))) ? floor((strtotime($contract['warranty_expiry']) - strtotime(date("Y-m-d")))/3600/24) : '<span class="badge" style="background-color:#ff0000">X</span>';
											//echo "<td>".$str."</td>";                                    
											//echo "<td><span class='badge' style='background-color:".getSingleValue("labels","color",$contract['statusid'])."'>".getSingleValue("labels","name",$contract['statusid'])."</span></td>";
	
											echo "<td>
											<div class='pull-right'>
											<a href='#' onClick='showM(\"ajax.php?modal=contractUsageAdd&reroute=clients/manage&routeid=".$client['id']."&clientid=".$client['id']."&contractid=".$contract['id']."&section=contract\");return false' class='btn-right text-red'><img src='template/assets/dist/img/counter-reset.png' /></a>
											<a href='?route=contract/manage&id=".$contract['id']."&reroute=clients/manage&routeid=".$client['id']."&contractid=".$contract['id']."&section=contract' class='btn-right text-dark'><i class='fa fa-eye'></i></a>&nbsp;
											<a href='#' onClick='showM(\"ajax.php?modal=contractDelete&reroute=clients/manage&routeid=".$client['id']."&clientid=".$client['id']."&contractid=".$contract['id']."&section=contract\");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
											</div>
											</td>";
											echo "</tr>";
											}
											?>
										</tbody>
									</table>
								</div>
											</div>
											<!-- /.box-body -->
											<div class="box-footer clearfix no-border">
												<a href="?route=contract/create&clientid=<?php echo $client['id']?>&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&section=contract" class="btn btn-primary btn-sm pull-right">NEW CONTRACT</a>
											</div>
										</div>
										<!-- /.box -->
	
									</div>
	
									<div class="col-md-4">
										<!-- ASSIGNED ADMINS -->
										<div class="box box-primary">
											<div class="box-header with-border">
												<h3 class="box-title">Assigned Admins</h3>
												<div class="box-tools pull-right">
													<button type="button" class="btn btn-default btn-sm" data-widget="collapse"><i class="fa fa-minus"></i></button>
												</div>
											</div>
											<!-- /.box-header -->
											<div class="box-body ">
												<ul class="users-list clearfix">
													<?php
													foreach ($assignedadmins as $aasign) { ?>
													<li>
														<img src="<?php echo getGravatar(getSingleValue("people","email",$aasign['adminid']),"128"); ?>" alt="User Image">
															 <a class="users-list-name" href="#"><?php echo getSingleValue("people","name",$aasign['adminid']); ?></a>
														<span class="users-list-date"><?php echo getSingleValue("people","title",$aasign['adminid']); ?></span>
														<span class="users-list-date"><a onClick='showM("ajax.php?modal=clientUnassignAdmin&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $aasign['id']; ?>");return false' data-toggle="modal">Unassign</a></span>
													</li>
													<?php } ?>
	
												</ul>
												<!-- /.users-list -->
												<?php if(empty($assignedadmins)) echo "There are no assigned admins to display."; ?>
											</div>
											<!-- /.box-body -->
										</div>
										<!--/.box -->
	
										<!-- DONUT CHART -->
										<div class="box box-primary">
											<div class="box-header with-border">
												<h3 class="box-title">Assets by Category</h3>
												<div class="box-tools pull-right">
													<button type="button" class="btn btn-default btn-sm" data-widget="collapse"><i class="fa fa-minus"></i></button>
												</div>
											</div>
											<div class="box-body">
												<canvas id="pieChart" style="height:250px"></canvas>
											</div>
											<!-- /.box-body -->
										</div>
										<!-- /.box -->
	
									</div>
									<!-- /.col -->
								</div>
								<!-- /.row -->
							</div>
	
							<div class="tab-pane <?php if ($section == "assets") echo 'active'; ?>" id="tab-assets">
								 <div>
									<span class="t-label">Asset Qty:</span>
									<span class="t-number"><?php echo countTableFiltered('assets','clientid',$client['id']);?></span>
									<?php if($lia['role'] != 'technician'){ ?>
									<span class="t-label2">Total Amount:</span>
									<span class="t-number autoNumeric animated-number"><?php echo getTotalAmount('assets','contract_amount','clientid',$client['id']);?></span>
									<?php } ?>
								</div>
								<div class="table-responsive">
									<table id="dataTablesFullu" class="table table-striped table-hover">
										<thead>
											<tr>
												<th>Tag</th>
												<th>Asset Type</th>
												<th>M/C Type</th>
												<th>Model</th>
											 <th>Serial No.</th>
								  
												<th>Contract End<span title="Contract End Date		
	Contract Date + 1 Year" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span></th>
												<th>D-Day<span title="Today - Contract End Date" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span>	
	</th>
												<th>Total Mileage</th>
												<th>Asset Memo</th>
												<th class="text-right">Action</th>
												
										</thead>
										<tbody>
											<?php
											foreach ($assets as $asset) {
											echo "<tr>";
											echo "<td><a href='?route=assets/manage&id=".$asset['id']."'>".$asset['tag']."</a></td>";
											echo "<td><span class='label' style='background-color:#FFF;color:".getSingleValue("assetcategories","color",$asset['categoryid']).";border:1px solid ".getSingleValue("assetcategories","color",$asset['categoryid'])."'>".getSingleValue("assetcategories","name",$asset['categoryid'])."</span></td>";
											echo "<td>".$asset['mc_type']."</td>";
											echo "<td>".getSingleValue("models","name",$asset['modelid'])."</td>";
											echo "<td>".$asset['serial']."</td>";
											$expiry = ($asset['contract_expiry'] == '0000-00-00' || $asset['contract_expiry'] == null) ? '' : $asset['contract_expiry'];
							
						
											echo "<td>".$expiry."</td>";
											//Calculate the remaining days
											$str = (strtotime($asset['contract_expiry']) > strtotime(date("Y-m-d"))) ? floor((strtotime($asset['contract_expiry']) - strtotime(date("Y-m-d")))/3600/24) : '<span class="badge" style="background-color:#ff0000">Expired</span>';
											echo "<td>".$str."</td>";
											echo "<td><span class='autoNumeric'>".getTotalAmount('asset_usages','month_mileage','assetid',$asset['id'])."</span></td>";
											echo "<td><span class='badge' style='background-color:".getSingleValue("labels","color",$asset['statusid'])."'>".getSingleValue("labels","name",$asset['statusid'])."</span></td>";
											echo "<td>
											<div class='pull-right'>
											<a href='#' onClick='showM(\"ajax.php?modal=usageAdd&reroute=clients/manage&routeid=".$client['id']."&clientid=".$client['id']."&assetid=".$asset['id']."&section=assets\");return false' class='btn-right text-red'><img src='template/assets/dist/img/counter-reset.png' /></a>
											<a href='?route=assets/manage&id=".$asset['id']."' class='btn-right text-dark'><i class='fa fa-eye'></i></a>&nbsp;
											<a href='#' onClick='showM(\"ajax.php?modal=assetDelete&reroute=clients/manage&routeid=".$client['id']."&id=".$asset['id']."&section=assets\");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
											</div>
											</td>";
											echo "</tr>";
											}
											?>
										</tbody>
									</table>
								</div>
							</div>
	
							<div class="tab-pane <?php if ($section == "licenses" || $_GET['tab'] == "license") echo 'active'; ?>" id="tab-licenses">
								 <div class="table-responsive">
									<table id="dataTablesFull2" class="table table-striped table-hover">
										<thead>
											<tr>
												<th>Tag</th>
												<th>License Contract no</th>
												<th>Category</th>
												<th>Name</th>
												<th>Amount</th>
										  
												<th class="text-right"></th>
											</tr>
										</thead>
										<tbody>
											<?php
											foreach ($licenses as $license) {
											echo "<tr>";
											echo "<td><a href='?route=licenses/manage&id=".$license['id']."'>".$license['tag']."</a></td>";
											 echo "<td>".$license['licno']."</td>";
											echo "<td><span class='label' style='background-color:#FFF;color:".getSingleValue("licensecategories","color",$license['categoryid']).";border:1px solid ".getSingleValue("licensecategories","color",$license['categoryid'])."'>".getSingleValue("licensecategories","name",$license['categoryid'])."</span></td>";
											echo "<td>".$license['name']."</td>";
											 echo "<td>".$license['amount']."</td>";
										 
											echo "<td>
											<div class='pull-right'>
											<a href='?route=licenses/manage&id=".$license['id']."' class='btn-right text-dark'><i class='fa fa-eye'></i></a>&nbsp;
											<a href='#' onClick='showM(\"ajax.php?modal=licenseDelete&reroute=clients/manage&routeid=".$client['id']."&id=".$license['id']."&section=licenses\");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
											</div>
											</td>";
											echo "</tr>";
											}
											?>
										</tbody>
									</table>
								</div>
							</div>
	
							<div class="tab-pane <?php if ($section == "projects") echo 'active'; ?>" id="tab-projects">
								 <div class="table-responsive">
									<table id="dataTablesFullDesc" class="table table-striped table-hover">
										<thead>
											<tr>
												<th style="max-width:30px;" class="no-sort"></th>
												<th style="width:100px;">Tag</th>
												<th>Name</th>
												<th class="text-right"></th>
											</tr>
										</thead>
										<tbody>
											<?php foreach ($projects as $project) { ?>
											<tr>
												<td><input type="text" class="knob" value="<?php echo projectProgress($project['id']); ?>" data-thickness="0.2" data-width="40" data-height="40" data-fgColor="#00a65a" data-readonly="true"></td>
												<td><a href='?route=projects/manage&id=<?php echo $project['id']; ?>'><?php echo $project['tag']; ?></a></td>
												<td><a href='?route=projects/manage&id=<?php echo $project['id']; ?>'><?php echo $project['name']; ?></a></td>
												<td>
													<div class='pull-right'>
														<a href='?route=projects/manage&id=<?php echo $project['id']; ?>' class='btn-right text-dark'><i class='fa fa-eye'></i></a>&nbsp;
														<a href='#' onClick='showM("ajax.php?modal=projectEdit&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $project['id']; ?>&section=projects");return false' class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
														<a href='#' onClick='showM("ajax.php?modal=projectDelete&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $project['id']; ?>&section=projects");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
													</div>
												</td>
											</tr>
											<?php } ?>
										</tbody>
									</table>
								</div>
							</div>
							<!-- /.tab-pane -->
	
							<div class="tab-pane <?php if ($section == "issues") echo 'active'; ?>" id="tab-issues">
								 <div class="table-responsive">
									<table id="dataTablesFullDesc" class="table table-striped table-hover">
										<thead>
											<tr>
												<th>ID</th>
												<th style="min-width:40%;">Name</th>
												<th>Assigned To</th>
												<th>Related Entities</th>
												<th>Status</th>
												<th class="text-right"></th>
											</tr>
										</thead>
										<tbody>
											<?php foreach ($issues as $issue) { ?>
											<tr>
												<td><?php echo $issue['id']; ?></td>
												<td>
													<?php if($issue['issuetype'] == "Task") echo "<i class='fa fa-check-square text-blue' data-toggle='tooltip' title='Task'></i> "; ?>
													<?php if($issue['issuetype'] == "Maintenance") echo "<i class='fa fa-minus-square text-yellow' data-toggle='tooltip' title='Maintenance'></i> "; ?>
													<?php if($issue['issuetype'] == "Bug") echo "<i class='fa fa-bug text-red' data-toggle='tooltip' title='Bug'></i> "; ?>
													<?php if($issue['issuetype'] == "Improvement") echo "<i class='fa fa-external-link text-teal' data-toggle='tooltip' title='Improvement'></i> "; ?>
													<?php if($issue['issuetype'] == "New Feature") echo "<i class='fa fa-plus-square text-green' data-toggle='tooltip' title='New Feature'></i> "; ?>
													<?php echo $issue['name']; ?>
												</td>
												<td><?php if($issue['adminid'] != 0) echo getSingleValue("people","name",$issue['adminid']); else echo "<span class='text-muted'>Nobody</span>"; ?></td>
												<td><?php
													if($issue['assetid'] != 0) echo "<a href='?route=assets/manage&id=".$issue['assetid']."'><span class='label' style=\"background-color:#FFF;color:#001F3F;border:1px solid #001F3F;\"><i class='fa fa-barcode'></i> " . getSingleValue("assets","tag",$issue['assetid']) . "</span></a> ";
													if($issue['projectid'] != 0) echo "<a href='?route=projects/manage&id=".$issue['projectid']."'><span class='label' style=\"background-color:#FFF;color:#ff851b;border:1px solid #ff851b;\"><i class='fa fa-lightbulb-o'></i> " . getSingleValue("projects","tag",$issue['projectid']) . "</span></a> ";
													?></td>
												<td>
													<?php if($issue['status'] == "To Do") echo "<span class='badge bg-green'>To Do</span>"; ?>
													<?php if($issue['status'] == "In Progress") echo "<span class='badge bg-blue'>In Progress</span>"; ?>
													<?php if($issue['status'] == "Done") echo "<span class='badge bg-gray'>Done</span>"; ?>
	
	
													<?php if($issue['status'] != "Done" && $issue['duedate'] < date('Y-m-d') && $issue['duedate'] != "") echo "<span class='badge bg-red'>Overdue</span>"; ?>
												</td>
												<td>
													<div class='pull-right'>
														<a href="#" onClick='showM("ajax.php?modal=issueEdit&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $issue['id']; ?>&section=issues");return false' class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
														<a href="#" onClick='showM("ajax.php?modal=issueDelete&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $issue['id']; ?>&section=issues");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
													</div>
												</td>
											</tr>
											<?php } ?>
										</tbody>
									</table>
								</div>
							</div>
	
							<div class="tab-pane <?php if ($section == "tickets") echo 'active'; ?>" id="tab-tickets">
								 <div class="table-responsive">
									<table id="dataTablesFullDesc2" class="table table-striped table-hover">
										<thead>
											<tr>
												<th>ID</th>
												<th style="width: 5%; !important">Ticket #</th>
												<th>Date</th>
												<th>Subject</th>
												<th>Assigned To</th>
												<th>Related Entities</th>
												<th>Department</th>
												<th>Cost &nbsp;<span style='color:red;'>&#8369;</span></th>
												<th title="Client Handle Mistake">CHM</th>
												<th>Status</th>
												<th class="text-right">Action</th>
											</tr>
										</thead>
										<tbody>
											<?php foreach ($tickets as $ticket) { ?>
											<tr>
												<td><a href='?route=tickets/manage&id=<?php echo $ticket['id']; ?>'><?php echo $ticket['id']; ?></a></td>
												<td><a href='?route=tickets/manage&id=<?php echo $ticket['id']; ?>'><?php echo $ticket['ticket']; ?></a></td>
												<td style="text-wrap: nowrap;"><?php echo $ticket['timestamp']?></td>
												<td style="text-wrap: nowrap;"><a href='?route=tickets/manage&id=<?php echo $ticket['id']; ?>'><?php echo getSingleValue("ticketsubject","subject",$ticket['subject']); ?></a></td>

												<td><?php if($ticket['adminid'] != 0) echo getSingleValue("people","name",$ticket['adminid']); else echo "<span class='text-muted'>Nobody</span>"; ?></td>

												<td style="text-wrap: nowrap;">
													<?php
													//  if($ticket['clientid'] != 0) echo "<a href='?route=clients/manage&id=".$ticket['clientid']."'><span class='label' style=\"background-color:#FFF;color:#0073b7;border:1px solid #0073b7;\">" . getSingleValue("clients","name",$ticket['clientid']) . "</span></a> ";
													$assetid = getSingleValue("contract","assetid",$ticket['contractid']);
													$assettag = getSingleValue("assets","tag",$assetid);
													$modelid = getSingleValue("assets","modelid",$assetid);
													$assetmodel = getSingleValue("models","name",$modelid);
													if($ticket['contractid'] != 0) echo "<a href='?route=contract/manage&id=".$ticket['contractid']."'><span class='label' style=\"background-color:#FFF;color:#001F3F;border:1px solid #001F3F;\"> " . getSingleValue("contract","contractno",$ticket['contractid']) . " | " .$assettag .":" . $assetmodel . "</span></a> ";
													?>
												</td>
													
	
													<td>
														<?php 
			  												$dipartment_id = getSingleValue('contract', 'department', $ticket['contractid']);  
			  												$dipartment_name = getSingleValue('department', 'name', $dipartment_id); 
						 									if($ticket['clientid'] == 0) echo "<span class='text-muted'>None</span>"; else 
														   	echo $dipartment_name; ?>
													</td>
													<td><?php echo $ticket['consumable_cost'];?></td>
													<td class="chm">
														<?php if($ticket['client_handle_mistake']==1){echo "o"; };?>
													</td>	
												<td>
													<?php if($ticket['status'] == "Open") echo "<span class='badge bg-green'>Open</span>"; ?>
													<?php if($ticket['status'] == "In Progress") echo "<span class='badge bg-navy'>In Progress</span>"; ?>
													<?php if($ticket['status'] == "Answered") echo "<span class='badge bg-teal'>Answered</span>"; ?>
													<?php if($ticket['status'] == "Reopened") echo "<span class='badge bg-orange'>Reopened</span>"; ?>
													<?php if($ticket['status'] == "Closed") echo "<span class='badge bg-gray'>Closed</span>"; ?>
													<?php if($ticket['status'] == "Followed Up") echo "<span class='badge bg-teal'>Followed Up</span>"; ?>
												</td>
												<td>
													<div class='pull-right'>
									 <a href='?route=tickets/manage&id=<?php echo $ticket['id']; ?>' class='btn-right text-dark'><i class='fa fa-eye'></i></a>&nbsp;
														<a href='#' onClick='showM("ajax.php?modal=contractTicketEdit&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $ticket['id']; ?>&section=tickets");return false' class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
														<a href='#' onClick='showM("ajax.php?modal=contractTicketDelete&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $ticket['id']; ?>&section=tickets");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
													</div>
												</td>
											</tr>
											<?php } ?>
										</tbody>
									</table>
								</div>
							</div>
							<!-- /.tab-pane -->
	
							<div class="tab-pane <?php if ($section == "credentials") echo 'active'; ?>" id="tab-credentials">
								 <div class="table-responsive">
									<table id="dataTablesFull3" class="table table-striped table-hover">
										<thead>
											<tr>
												<th>Asset</th>
												<th>Type</th>
												<th>Username</th>
												<th>Password</th>
												<th class="text-right"></th>
											</tr>
										</thead>
										<tbody>
											<?php
											foreach ($credentials as $credential) {
											echo "<tr>";
									 echo "<td><a href='?route=assets/manage&id=".$credential['assetid']."'>".getSingleValue("assets","tag",$credential['assetid'])."</a></td>";
											echo "<td>".$credential['type']."</td>";
											echo "<td>".$credential['username']."</td>";
											echo "<td>".$credential['password']."</td>";
											$json = json_encode($credential);
											echo "<td>
											<div class='pull-right'>
											<a href='#' onClick='showM(\"ajax.php?modal=credentialEdit&reroute=clients/manage&routeid=".$client['id']."&id=".$credential['id']."&section=credentials\");return false' class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
											<a href='#' onClick='showM(\"ajax.php?modal=credentialDelete&reroute=clients/manage&routeid=".$client['id']."&id=".$credential['id']."&section=credentials\");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
											</div>
											</td>";
											echo "</tr>";
											}
											?>
										</tbody>
									</table>
								</div>
							</div>
	
							<div class="tab-pane<?php if ($section == 'users' || $_GET['tab'] == 'users') echo 'active';?> " id="tab-users">
								 <div class="table-responsive">
									 
									<table id="dataTablesFull4" class="table table-striped table-hover">
										<thead>
											<tr>
												<th>ID</th>
												<th>Name</th>
												<th>Mobile Number</th>
												<th>Email</th>
												<th>Department / Role</th>
												<th>Invoice</th>
												<th>Collection</th>
												<th>Page Count</th>
												
												<th class="text-right"></th>
											</tr>
										</thead>
										<tbody>
											<?php
											//echo "<pre>"; 
										//print_r($users);
											foreach ($users as $user) {
											echo "<tr>";
											echo "<td>".$user['id']."</td>";
											echo "<td>".$user['name']."</td>";
											echo "<td>".$user['mobile']."</td>";
											echo "<td>".$user['email']."</td>";
											echo "<td>".$user['title']."</td>";
											if(isset($user['invoice'])){
												if($user['invoice'] == 1){
												echo '<td> <input type="checkbox" checked disabled></td>';
												} else{ 
												echo '<td></td>';
												 } 
											}else{ 
												echo '<td></td>';
											}
											if($user['collection_change']=='1')
											{
											//echo "<td><p style ='background: red;border: 1px solid red;padding: 10px;width: 20px;'></p></td>";
											echo "<td><input type='checkbox' checked disabled></td>";
											}
											else
											{
											echo "<td></td>";
											}
											
											if(isset($user['user_page_count_check'])){
												if($user['user_page_count_check'] == 1){
												echo '<td> <input type="checkbox" checked disabled></td>';
												} else{ 
												echo '<td></td>';
												 } 
											}else{ 
												echo '<td></td>';
											}
											
											echo "<td>
											<div class='pull-right'>
											<a href='?route=people/users/profile&id=".$user['id']."' class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
											<a href='#' onClick='showM(\"ajax.php?modal=userDelete&section=users&reroute=clients/manage&routeid=".$client['id']."&id=".$user['id']."\");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
											</div>
											</td>";
											echo "</tr>";
											}
											?>
										</tbody>
									</table>
								</div>
							</div>
	
							<div class="tab-pane <?php if ($section == 'files') echo 'active'; ?>"  id="tab-files"><?php if(empty($files)) { ?>
				<div class="alert alert-info">  <i class="icon fa fa-info"></i> No files have been uploaded yet!  </div><?php } ?>
	
							<!--ul class="todo-list list-inline" id="fileslist">
									<?php foreach($files as $file) { ?>
									<li id="" style="width:28%;margin:10px;padding:12px;">
										<div class="row">
											<div class="col-xs-1" style="vertical-align:middle"><i class="fa fa-<?php echo fileIcon($file['file']); ?>"></i></div>
											<div class="col-xs-10">
												<?php echo $file['name'] . "<br><small>" . $file['file'] . "</small>"; ?>
											</div>
										</div>
										<div class="pull-right">
											<a href="<?php echo "ajax.php?download=" . $file['id']; ?>" class='btn-right text-dark'><i class='fa fa-download'></i></a>&nbsp;
											<a href="#" onClick='showM("ajax.php?modal=deleteFile&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $file['id']; ?>&section=files");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
										</div>
									</li>
									<?php } ?>
								</ul-->
	
	
								   <div class="" style="width: 30%; margin-bottom: 15px;">      
									<?php $document_ty = getTable("document_type"); ?>
									<label for="name">Document Type </label>        
									<select class="form-control select2 select2-hidden-accessible" id="document_type" name="document_type" style="width: 46%;" tabindex="-1" aria-hidden="true">
									<option value="0">Select Document Type</option>
									<?php foreach ($document_ty as $document_t) { echo "<option value='".$document_t['document_name']."'"; echo ">".$document_t['document_name']."</option>"; } ?>
									</select>
	   
									   </div>
	
							 <table id="dataTablefulldes1" class="table table-striped table-hover">
										<thead>
											<tr>
												<th>ID</th>
												<th >Name</th>
												<th>Document Type</th>
												<th>File</th>
												<th>Document Memo</th>
											   <th class="text-right"></th>
											</tr>
										</thead>
										<tbody>
										
							   
								<?php   foreach($files as $file) {    ?>
									   
											<tr>
						<td><?php echo $file['id']; ?></td>
						<td><?php echo $file['name']; ?></td>
						<?php $document_ty = getSingleValue("document_type","document_name",$file['document_type']);?>
						<td><?php echo $document_ty; ?></td>
						<td><a href="<?php echo "ajax.php?download=" . $file['id']; ?>" ><i title="<?php  echo $file['file'];?>" style='color:#3c8dbc;cursor: pointer;' 
								class="fa fa-file"aria-hidden="true"> </i></a>&nbsp;&nbsp; </td>
						<td><?php echo $file['document_memo'];?></td>
					   
						<td>
					 <div class="pull-right">
											<a href="<?php echo "ajax.php?download=" . $file['id']; ?>" class='btn-right text-dark'><i class='fa fa-download'></i></a>&nbsp;
											<a href='#' onClick='showM("ajax.php?modal=fileedit&reroute=clients/manage&routeid=<?php echo $client['id'];?>&id=<?php echo $file['id']; ?>&section=files");return false' class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
											<a href="#" onClick='showM("ajax.php?modal=deleteFile&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $file['id']; ?>&section=files");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
										</div>
												</td>
											</tr>
											<?php } ?>
										</tbody>
									</table>

							</div>
						  <?php
						    $i=0;
						    $ar=array();
						    $str='';
							foreach($contracts as $donrn){
								$ar[$i] =$donrn['contractno'];
								$str=$str.$donrn['contractno'].",";
								$i++;
							}
						
						  //print_r($ar);
						 // echo "<br/>";
						// $vals = array_count_values($ar);
						 // echo 'No. of NON Duplicate Items: '.count($vals).'<br><br>';
						// print_r($vals);
						   ?>
						 <div id="sami123"><?php  //echo $str;   ?></div>
						  
						<?php // die();  ?>
							<div class="tab-pane <?php if ($section == "" && $_GET['tab'] != "license"&& $_GET['tab'] != "department" && $_GET['tab'] != "invoice" && $_GET['tab'] != "users") echo 'active'; ?>" id="tab-contract">
								 <div class="row" style="margin-bottom: 15px;">
								  <!-- <div class="col-md-2 "> -->
									  <!-- <select name="mySelector21" class="mySelector21" style="height: 35px;width: 95%;">
									<option value="all">SELECT CONTRACT</option>
									  <?php 
							  // $i=0;
								// $ar=array();
							// foreach($contracts as $donrn){
	
							  // $ar[$i] =$donrn['contractno'];
							//	$i++;
							  // }
							  // $vals = array_count_values($ar);
							  
							 //  $as=array_unique($ar);
							  // $i=0;
							  // foreach($as as $newar){   ?>
									
			  <option  value="<?= $newar; ?>"><?= $newar; ?>(<?php // echo $vals[$newar] ; ?>)</option>
						<?php // $i++;}  ?>
						</select> -->
									 <!-- </div> -->
									 <div class="col-md-9 w_full">
										 <!-- <strong>View</strong> -->
										  <?php
										  $defult_status = '';
										  if(!isset($_GET['status'])){
											$defult_status = 'selected';
										  }else if($_GET['status'] == 0){
											$defult_status = 'selected';
										  }
										  ?>
										 <select id="view-options" class="form-control select2" style="width:auto;display:inline;">
											<option value="" disabled>--Contract Status--</option>
											<option value="active" <?php echo isset($_GET['status']) && $_GET['status'] == 0 ? 'selected' : ''; ?>  <?php echo $defult_status; ?>>Active Contract</option>
											<option value="inactive" <?php echo isset($_GET['status']) && $_GET['status'] == 1 ? 'selected' : ''; ?>>Ended Contract</option>
											<option value="all" <?php echo isset($_GET['status']) && $_GET['status'] == 3 ? 'selected' : ''; ?>>All Contract</option>
											<option value="status_expiered" <?php echo isset($_GET['status_expiered']) && $_GET['status_expiered'] == 1 ? 'selected' : ''; ?>>Active & Expired</option>
										</select>
										
									 </div>
									 <!-- <div class="col-md-5"> -->
										 <!-- <strong>Asset Status</strong> -->
										 <!-- <select id="mySelector" class="form-control select2" style="min-width:105px; width:105px; display:inline;">
											 <option value="all">All</option>
											 <option value="Available">Available</option>
											 <option value="In Service">In Service</option>
											 <option value="Under Repair">Under Repair</option>
											 <option value="For Disposal">For Disposal</option>
											 <option value="For Pullout">For Pullout</option>
										 </select> -->
									 <!-- </div> -->
								   <div class="col-lg-2 fll" style="float:right;">
										<a class="btn btn-success btn-sm" id="print" style="width:49%">Print Lable</a>
										<a style="width:49%;" class="btn btn-success btn-sm" href="#" onClick='showM("ajax.php?modal=issueInvoice&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&clientid=<?php echo $client['id']; ?>&section=contract");return false'>Issue Invoice</a>
									</div>
									
								</div>
								<form method="post" action="?route=printlable&id=<?php echo $client['id']; ?>">
								<div id="all-contracts" class="table-responsive" style="display: none;">
							
									<table id="dataTablesFullDesc6" class="table table-striped table-hover dataTablesFullDesc6all">
										<thead>
											<tr>
												<th><input type="checkbox" id="chkall"></th>
												<th>Contract No.</th>
												<th>Department</th>
												<th title="Total Mileage Usage">Usage</th>
												<th>Contract Type</th>
									 			<th title=" Service Item">Contract Categories</th>
												<th title="Contract- Service Status">Contract </th>
												<th title="Contract Service Status & Asset's Crurrent Status Related To Contract">Asset Status</th>
												<th title="">Contract Type</th>
												<th>Asset Memo</th>
												<th>Client(Location)</th>
												<th >SKU<span title="Unique Asset SKU System Auto Generated" class="circle-1">
													<i  class="fa fa-info-circle" aria-hidden="true"></i></span>
												</th>
												<th>Asset<span title="Deploye Asset Format Asset ID+Model+Serial No" class="circle-1">
													<i  class="fa fa-info-circle" aria-hidden="true"></i></span>
												</th>
											 	<th>Case Serial<span title="If asset core serial and Case serial is different This is used to trace warranty unit only" class="circle-1">
													<i class="fa fa-info-circle" aria-hidden="true"></i></span>	
												</th>
											 	<?php if($lia['role'] = 'admin'){ ?>  <th>Deposit</th> <?php }else{?>
											  	<th>Deposit<span title="Security Deposit Amount 		
													If it is applicable to this contract" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span>
												</th>
											 <?php  } ?>
											   
											   <th title="Contract pages per month / Red color means that customer print more than contracted page limit"> Limit <i class="fa fa-tachometer"style="color;red; aria-hidden="true"></i></th>
											   <th title="Actaull Pages Per Month"> Actuall <i class="fa fa-tachometer" style="color;red;" aria-hidden="true"></i></th>
											   <?php if($lia['role'] = 'admin'){ ?>
											   <th>AMT</th> <?php } ?>
											   <th>Contract End<span title="Contract End Date		
													Contract Date + 1 Year" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span>
												</th>
												<th title="Remaining Days from Contract Expiration">D-Day<span title="Today - Contract End Date" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span>	
												</th>
											   
											   
												<!--<th>Status</th>-->
											   
											</tr>
											
										</thead>
										<tbody>
										
											<?php
										   foreach ($contracts as $contract) {
											//$manufacturerid = getSingleValue("models","manufacturerid",$contract['modelid']);
											echo "<tr>";
											echo "<td><input type='checkbox' name='check[]' value='".$contract['id']."'></td>";
											echo "<td><input value='" . $contract['id'] . "'>xxxxx</td>";
											if($contract['is_endservice']=="1"){
											echo "<td class='cno end_contrat'><a  class='end_contrat' href='?route=contract/manage&id=".$contract['id']."&reroute=clients/manage&routeid=".$client['id']."&contractid=".$contract['id']."&section=contract'>".$contract['contractno']."</a></td>";
											}else{
											
											echo "<td class='cno active_service'><a href='?route=contract/manage&id=".$contract['id']."&reroute=clients/manage&routeid=".$client['id']."&contractid=".$contract['id']."&section=contract'>".$contract['contractno']."</a></td>";
											
											}
											if($contract['department']==''){
											echo "<td> Not Assigned </td>";
											}else{
							  echo "<td>".getSingleValue("department","name",$contract['department'])."</td>";
							  }
							   echo "<td>".getSingleValue("contracttype","name",$contract['contracttype'])."</td>";
						 echo "<td class='text-right'><span class='autoNumeric'>".number_format(getTotalAmountofcontract('contract_usages','month_mileage','contractid',$contract['id']))."</span></td>"; 
											
											   echo "<td></td>";
											echo "<td class='stype1'
											><span class='label' style='background-color:#FFF;color:".getSingleValue("assetcategories","color",$contract['categoryid']).";border:0px".getSingleValue("assetcategories","color",$contract['categoryid'])."'>".getSingleValue("assetcategories","name",$contract['categoryid'])."</span></td>";
											
											
											
						
					if($contract['is_endservice']!= '1'){
											
											
									$status=getSingleValue("assets","status",$contract['assetid']);
										if($status=='In Service'){
										   $status= '<span class="active_css">Active</span>';
										}else if($status=='For Pullout'){
										$status= '<span class="pull_out">For Pullout</span>';
										}else if($status=='On Hold'){
										$status= '<span class="On_Hold">On Hold</span>';
										
										}else{
										$status= '<span class="void">'.$status.'</span>';
										
										}
										
									echo "<td><span class='label label_style' style='border:1px solid;color ".getSingleValue("assetcategories","color",$contract['categoryid'])."'>".$status."</span></td>";
											} else if($contract['is_endservice']='1'){
											
											echo "<td><span class='label void_css' style='background-color:#FFF;".getSingleValue("assetcategories","color",$contract['categoryid'])."'>Void</span></td>";
											}else if($contract['endservice_status']=="Inactive"){
											echo "<td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$contract['assetid']."&coid=".$contract['id']."\");return false'><span class='label void_css' style='background-color:#FFF; cursor:pointer'>Void </span></a></td>";
											}else{
											   if($contract['endservice']=="Replace"){
												
												echo "<td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$contract['assetid']."&coid=".$contract['id']."\");return false'><span class='label' style='background-color:#FFF;color:#000;border:1px solid; cursor:pointer'>For Pullout</span></a></td>";
												
												
												}
												else if($contract['endservice']=="End"){
									   echo"<td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$contract['assetid']."&coid=".$contract['id']."\");return false'><span class='label' style='background-color:#FFF;color:#000;border:1px solid; cursor:pointer'>For Pullout</span></a></td>";
											}else {									
											
													echo "<td><span class='label' style='background-color:green;color:#fff;border:1px solid;".getSingleValue("assetcategories","color",$contract['categoryid'])."'>  Void </span></td>";	
															 
															 }
											}
											
											
											if($contract['is_end']!= '1'){
		$status11=getSingleValue("assets","status",$contract['assetid']);
								
				   if($status11=='On Hold'){
							 
							 $status11='<span class="On_Hold_asset">On Hold</span>';
							 }else if($status11=='In Service'){
							  $status11='<span class="In_Service_aasse">In Service</span>';
							 }else if($status11=='for pullout'){
							 
							  $status11='<span 
							  class="for _pullout_asstes">In Service</span>';
							 
							 }else{
							 $status11;
							 
							 }
	
	echo "<td><span class='label service123' style='".getSingleValue("assetcategories","color",$contract['categoryid'])."'>".$status11."</span></td>";
												
													}else{
												if($contract['endasset']=="Replace"){
													echo "<td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$contract['assetid']."&coid=".$contract['id']."\");return false'><span class='label pull_out pullou1' style='background-color:#ff0000;color:#fff;border:1px solid #ff0000; cursor:pointer'>For Pullout</span></a></td>";
													
												}elseif($contract['endasset']=="End"){
													echo "<td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$contract['assetid']."&coid=".$contract['id']."\");return false'><span class='label pull_out pullou1' style='background-color:#ff0000;color:#000;border:1px solid #ff6600;color:#fff; cursor:pointer'>For Pullout</span></a></td>";
												}else{
													echo "<td><span class='label pullouted' style='background-color:#fff;color:#000;border:1px solid;".getSingleValue("assetcategories","color",$contract['categoryid'])."'>Pulled Out</span></td>";	
												}
											}
											if($contract['is_end'] = '1'){
											$labeldata = getTableFiltered("assets", "id",$contract['assetid']); 
												foreach($labeldata as $label){
												$lableid = $label['statusid'];
												
		echo "<td>".getSingleValue("contracttype","name",$contract['contracttype'])."</td>";										
			?>	
	<td class='listlist'><span class='badge ' style='background-color:<?php echo getSingleValue("labels","color",$lableid);?>'><?php echo getSingleValue("labels","name",$lableid);?></span>
	
	<span class="memovalue1">
	<span class="memovalueinner" id="<?php echo $contract['id'];?>"  
	onclick="assts_memo1(this.id)" title="" style="cursor: pointer;color: #d11d7f;">
	
	<img src="uploads/slide/icon_edit.png" style="width:20px;height:20px;">
	
	</span>	
	<div class="memo1" id="memo1<?php echo  $contract['id'];?>" style="display:none;">	
	<span class="close_popup" ><i class="fa fa-times" aria-hidden="true" ></i></span>
	
	<?php 
	$assteval=getTableFiltered("assets","id",$contract['assetid']);
	
	foreach($assteval as $asste){
	
		  $asset_note = $asste['notes'];
			$asst_status_id = $asste['statusid'];
	
	}
	
	
	 ?>
	<form method='POST'>
	
	 <select class="form-control select2 select2-hidden-accessible" id="statusid" name="statusid" style="width: 100%;" tabindex="-1" aria-hidden="true">
		  <?php foreach ($labels as $label) { echo "<option value='".$label['id']."'"; if($asst_status_id==$label['id']) echo " selected"; echo ">".$label['name']."</option>"; } ?>  </select>
		<span class="text_value">										
	<textarea name="text_area" id="text_area"
	style='height:100px;'><?php echo strip_tags($asset_note); ?></textarea>
	
	<input type='hidden' name='contractid' value='<?php echo $contract['id'];?>'>
	<input type='hidden' name='routeid' value='<?php echo $client['id']; ?>'>
	</span>
	<input type="submit" name="update_memo_status" class="submitbuttone btn btn-success" value="Update">
	</form>
	</div>
	</span>		
	<span class="messgae">
	<?php 
	$asste=getTableFiltered("assets","id",$contract['assetid']);
	
	foreach($asste as $ass){
	$ast = $ass['notes'];
	}
	if(!empty($ast)){
	echo $ast;
	}
	?>
	</span>
	
												</td>
											<?php 	}
											}	
											else{
												if($contract['endasset']=="Replace"){
													echo "<td><span class='badge' style='background-color:yellow'>Wait Forpullout</span></td>";
												}elseif($contract['endasset']=="End"){
													echo "<td><span class='badge' style='background-color:yellow'>Wait Forpullout</span></td>";
												}else{
													echo "<td><span class='badge' style='background-color:red'>End Of Contract</span></td>";
												}
											}
										  echo "<td><a href='?route=clients/manage&id=".$contract['clientid']."'>".getSingleValue("clients","name",$contract['clientid'])."</a></td>";
											$modelid = getSingleValue("assets","modelid",$contract['assetid']);
											$modelname = getSingleValue("models","name",$modelid);
											$asset_serial = getSingleValue("assets","serial",$contract['assetid']);
											$asset_sku = getSingleValue("assets","sku",$contract['assetid']);
											echo "<td class='text-center'><span class=''>".$asset_sku."</span></td>";
											echo "<td class='assetvalue'><a href='?route=assets/manage&id=".$contract['assetid']."'>".getSingleValue("assets","tag",$contract['assetid']). " : " . $modelname . " : " . $asset_serial ."</a></td>";
											echo "<td>".getSingleValue("assets","caseserial",$contract['assetid'])."</td>";
											if($lia['role'] != 'technician'){
											echo "<td class='text-right'><span class='autoNumeric'>".$contract['deposit']."</span></td>";
											}
											
											
											
			if($contract['page_limit_per_month'] >= $contract['actual_pages_per_month']){
			$val=$contract['page_limit_per_month'];
			
					echo "<td style='text-align:right;'>".number_format($val)."</td>";
					}else{
					$val=$contract['page_limit_per_month'];
					echo "<td style='color:red;font-weight:bold;text-align:right;'>".number_format($val)."</td>";
					}
					$value1=$contract['actual_pages_per_month'];
				echo "<td style='text-align:right;'>".number_format($value1)."</td>";
				
									if($lia['role'] != 'technician'){
											echo "<td class='text-right'><span class='autoNumeric'>".number_format($contract['contract_amount'])."</span></td>";
											} else{
											
											"<td></td>";
											
											}
											
											
											
											
											$expiry = ($contract['contract_expiry'] == '0000-00-00' || $contract['contract_expiry'] == null) ? '' : $contract['contract_expiry'];
											echo "<td>".$expiry."</td>";
											//Calculate the remaining days
	
											
											$date1 = $contract['contract_expiry'];
											$date2 = date('Y-m-d');
	
											$diff = abs(strtotime($date2) - strtotime($date1));
	
											$years = floor($diff / (365*60*60*24));
											$months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
											$days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));
											
											$day="";
											 $x=strtotime($date1) - strtotime($date2);
											 if($x<0)
											 {
									$day="<span class='badge' style='background-color:#ff0000'>Expired</span>";
											  }
											  else{
											  $day=$months*30+$days;
											  }
											 echo "<td class='dgdg'>".$day."</td>";
														
										  // echo $day;
											$strrr =$day;
										   
										   
										  
										
											
											
											echo "</tr>";
											
											
											
											}
											
											?>
											
										</tbody>
									</table>
									
								</div>
								
								<div id="ended-contracts" class="table-responsive" style="display: none;">
									<table id="dataTablesFullDesc6end" class="table table-striped table-hover dataTablesFullDesc6end">
										<thead>
											<tr>
												<th><input type="checkbox" id="chkall"></th>
												<th>Contract No. ccc</th>
												 <th>Department</th>
												<th>Contract Type</th>
												<th>Service Type</th>
												 <th>Asset Status</th>
												<th>Contract Status</th>
												<th>SKU<span title="Unique Asset SKU		
	System Auto Generated" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span></th></th>
												<th>Asset<span title="Deploye Asset Format			
	Asset ID+Model+Serial No" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span></th>
												<th>Case Serial<span title="If asset core serial and Case serial is different 				
	This is used to trace warranty unit only" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span></th>
											   <?php if($lia['role'] != 'technician'){ ?>  <th>Deposit<span title="Security Deposit Amount 		
	If it is applicable to this contract" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span></th> <?php } ?>
											   <?php if($lia['role'] != 'technician'){ ?> <th>Amount</th> <?php } ?>
												<th>Contract End<span title="Contract End Date		
	Contract Date + 1 Year" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span></th>
												<th>D-Day<span title="Today - Contract End Date" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span>	
	</th>
												<th>Total Milage</th>
												<!--<th>Status</th>-->
											   
											</tr>
										</thead>
										<tbody>
											<?php
											foreach ($end_contracts as $contract) {
											//$manufacturerid = getSingleValue("models","manufacturerid",$contract['modelid']);
											echo "<tr>";
											echo "<td><input type='checkbox' name='check[]' value='".$contract['id']."'></td>";
											echo "<td><a href='?route=contract/manage&id=".$contract['id']."&reroute=clients/manage&routeid=".$client['id']."&contractid=".$contract['id']."&section=contract'>".$contract['contractno']."</a></td>";
											 echo "<td>".getSingleValue("department","name",$contract['department'])."</td>";
											 echo '<td><a data-contract-id="' . $contract['contractno'] . '" class="qr-modal" style="cursor: pointer;">QR</a></td>';
											  echo "<td>".getSingleValue("contracttype","name",$contract['contracttype'])."</td>";
											
		
											echo "<td><span class='label' style='background-color:#FFF;color:".getSingleValue("assetcategories","color",$contract['categoryid']).";border:1px solid ".getSingleValue("assetcategories","color",$contract['categoryid'])."'>".getSingleValue("assetcategories","name",$contract['categoryid'])."</span></td>";

											$lastcontract = getlastdata('contract_usages', '*', array("contractid" => $contract['id']));

											if($lastcontract[0]['statusid'] == "Contract End") {
												echo "<td><span class='badge btn btn-warning' >End Contract</span></td>";
											} else {
												echo "<td></td>";
											}

											//echo "<td><a href='?route=clients/manage&id=".$contract['clientid']."'>".getSingleValue("clients","name",$contract['clientid'])."</a></td>";
											$modelid = getSingleValue("assets","modelid",$contract['assetid']);
											$modelname = getSingleValue("models","name",$modelid);
											$asset_serial = getSingleValue("assets","serial",$contract['assetid']);
											$asset_sku = getSingleValue("assets","sku",$contract['assetid']);
											echo "<td class='text-right'><span class=''>".$asset_sku."</span></td>";
											echo "<td><a href='?route=assets/manage&id=".$contract['assetid']."'>".getSingleValue("assets","tag",$contract['assetid']). " : " . $modelname . " : " . $asset_serial ."</a></td>";
											echo "<td>".getSingleValue("assets","caseserial",$contract['assetid'])."</td>";
											if($lia['role'] != 'technician'){
											echo "<td class='text-right'><span class='autoNumeric'>".$contract['deposit']."</span></td>";
											}
										   
											if($lia['role'] != 'technician'){
											echo "<td class='text-right'><span class='autoNumeric'>".$contract['contract_amount']."</span></td>";
											}
											$expiry = ($contract['contract_expiry'] == '0000-00-00' || $contract['contract_expiry'] == null) ? '' : $contract['contract_expiry'];
											echo "<td>".$expiry."</td>";
											//Calculate the remaining days
											$str = (strtotime($contract['contract_expiry']) > strtotime(date("Y-m-d"))) ? floor((strtotime($contract['contract_expiry']) - strtotime(date("Y-m-d")))/3600/24) : '<span class="badge" style="background-color:#ff0000">Expired</span>';
											echo "<td>".$str."</td>";
											echo "<td class='text-right'><span class='autoNumeric'>".getTotalAmountofcontract('contract_usages','month_mileage','contractid',$contract['id'])."</span></td>";    
											echo "</tr>";
											}
											?>
										</tbody>
									</table>
								</div>
								
										<div id="active-contracts" class="table-responsive">
										<table id="dataTablesFullDesc6active" class="table table-striped table-hover dataTablesFullDesc6active">
										<thead>
										<tr>
										<th><input type="checkbox" id="chkall"></th>
										<th>CN</th>
										<th>Contract No.</th>
										<th>Condition</th>
										<th>P|A
											<i class="fa fa-info-circle" aria-hidden="true" title="Monthly usage fees are to be paid in advance"></i>
										</th>
										<th>QR</th>
										<th>Department</th>
										<th>Contract Type</th>
										<th>Service Type</th>
										<th>Asset Status</th>
										<th>Contract Status</th>
										<th>SKU<span title="Unique Asset SKU		
	System Auto Generated" class="circle-1"><i class="fa fa-info-circle" aria-hidden="true"></i></span></th>
										<th>Asset<span title="Deploye Asset Format			
	Asset ID+Model+Serial No" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span></th>
										<!-- <th>Case Serial<span title="If asset core serial and Case serial is different 				
		This is used to trace warranty unit only" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span></th> -->
										<?php if($lia['role'] != 'technician'){ ?>  <th>Deposit<span title="Security Deposit Amount 		
	If it is applicable to this contract" class="circle-1"><i  class="fa fa-info-circle" aria-hidden="true"></i></span></th> <?php } ?>
										
										<?php if($lia['role'] != 'technician'){ ?> <th>Amount</th> <?php } ?>
										<th>Contract End
											<span title="Contract End Date		
												Contract Date + 1 Year" class="circle-1">
												<i class="fa fa-info-circle" aria-hidden="true"></i>
											</span>
										</th>
										<th>D-Day
											<span title="Today - Contract End Date" class="circle-1">
												<i class="fa fa-info-circle" aria-hidden="true"></i>
											</span>
										</th>
										<th>Total Milage</th>
										<!--<th>Status</th>-->
	
										</tr>
										</thead>
										<tbody>
											<?php
											//active_contracts
											foreach ($contracts as $contract) {
											//$manufacturerid = getSingleValue("models","manufacturerid",$contract['modelid']);
											echo "<tr>";
											echo "<td><input type='checkbox' name='check[]' value='".$contract['id']."'></td>";
											echo "<td>".$contract['id']."</td>";
											echo "<td><a href='?route=contract/manage&id=".$contract['id']."&reroute=clients/manage&routeid=".$client['id']."&contractid=".$contract['id']."&section=contract'>".$contract['contractno']."</a></td>";
											echo '<td>'.str_replace("_", " ", $contract["contract_condition"]) .'</td>';
											if(isset($contract['monthly_usage_fees_advance']) && $contract['monthly_usage_fees_advance'] == 1){
												echo '<td>Yes</td>';
											} else {
												echo '<td>No</td>';
											}
											echo '<td><a data-contract-id="' . $contract['contractno'] . '" class="qr-modal" style="cursor: pointer;">QR</a></td>';

											
											 echo "<td>".getSingleValue("department","name",$contract['department'])."</td>";
											 echo "<td>".getSingleValue("contracttype","name",$contract['contracttype'])."</td>";
											
		
											echo "<td><span class='label' style='background-color:#FFF;color:".getSingleValue("assetcategories","color",$contract['categoryid']).";border:1px solid ".getSingleValue("assetcategories","color",$contract['categoryid'])."'>".getSingleValue("assetcategories","name",$contract['categoryid'])."</span></td>";
											
											if($contract['is_end']!= '1'){
												
													echo "<td><span class='label' style='background-color:#FFF;color:#000;border:1px solid ".getSingleValue("assetcategories","color",$contract['categoryid'])."'>".getSingleValue("assets","status",$contract['assetid'])."</span></td>";
												
											}else{
												if($contract['endasset']=="Replace"){
													echo "<td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$contract['assetid']."&coid=".$contract['id']."\");return false'><span class='label' style='background-color:#FFF;color:#000;border:1px solid; cursor:pointer'>For Pullout</span></a></td>";
												}elseif($contract['endasset']=="End"){
													echo "<td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$contract['assetid']."&coid=".$contract['id']."\");return false'><span class='label' style='background-color:#FFF;color:#000;border:1px solid; cursor:pointer'>For Pullout</span></a></td>";
												}else{
													echo "<td><span class='label' style='background-color:green;color:#fff;border:1px solid;".getSingleValue("assetcategories","color",$contract['categoryid'])."'>Pulled Out</span></td>";	
												}
											}
											$lastcontract = getlastdata('contract_usages', '*', array("contractid" => $contract['id']));

											if($lastcontract[0]['statusid'] == "On Service"){
												echo "<td><span class='badge btn btn-success' >On Service</span></td>";
											} elseif($lastcontract[0]['statusid'] == "On Hold"){
												echo "<td><span class='badge btn btn-warning' >On Hold</span></td>";
											} else{
												echo "<td></td>";
											}


											//echo "<td><a href='?route=clients/manage&id=".$contract['clientid']."'>".getSingleValue("clients","name",$contract['clientid'])."</a></td>";
											$modelid = getSingleValue("assets","modelid",$contract['assetid']);
											$modelname = getSingleValue("models","name",$modelid);
											$asset_serial = getSingleValue("assets","serial",$contract['assetid']);
											$asset_sku = getSingleValue("assets","sku",$contract['assetid']);
											echo "<td class='text-right'><span class=''>".$asset_sku."</span></td>";
											echo "<td style='text-wrap: nowrap;'><a href='?route=assets/manage&id=".$contract['assetid']."'>".getSingleValue("assets","tag",$contract['assetid']). " : " . $modelname . " : " . $asset_serial ."</a></td>";
											//echo "<td>".getSingleValue("assets","caseserial",$contract['assetid'])."</td>";
											if($lia['role'] != 'technician'){
											echo "<td class='text-right'><span class='autoNumeric'>".$contract['deposit']."</span></td>";
											}
										  
											if($lia['role'] != 'technician'){
											echo "<td class='text-right'><span class='autoNumeric'>".$contract['contract_amount']."</span></td>";
											}
											$expiry = ($contract['contract_expiry'] == '0000-00-00' || $contract['contract_expiry'] == null) ? '' : $contract['contract_expiry'];
											echo "<td>".$expiry."</td>";
											//Calculate the remaining days
											$str = (strtotime($contract['contract_expiry']) > strtotime(date("Y-m-d"))) ? floor((strtotime($contract['contract_expiry']) - strtotime(date("Y-m-d")))/3600/24) : '<span class="badge" style="background-color:#ff0000">Expired</span>';
											echo "<td>".$str."</td>";
											echo "<td class='text-right'><span class='autoNumeric'>".getTotalAmountofcontract('contract_usages','month_mileage','contractid',$contract['id'])."</span></td>";    
											echo "</tr>";
											}
											?>
										</tbody>
										</table>
										</div>
									<input type="submit" name="print" id="submittt" style='display:none'>
									</form>
									
									
									</div>
	
	
									<div class="tab-pane <?php if ($section == "tab-department" || $_GET['tab'] == "department") echo 'active'; ?>" id="tab-department">
	
								<?php 
								$depart = array_unique($contractsdepart);
	
	
	
										
				$con_dep = getTableFiltered2("contract", ["clientid" => $_GET['id']]);	
										
										//print_r($con_dep);
					foreach($depart as $depa){
								
									if($depa != ""){		?>
									<div class="row maindtext">
			<div class="head"><h3 style="background-color: #D0D0D7;">
				<div class="col-lg-12 col-md-12 col-sm-12 inner-col-up" >
			<?php //$depar = getSingleValue("department","name",$depa);
	
	
						   $depar = getTableFiltered("department", "id",$depa);
			
			foreach($depar as $departmet){?>
			<div class="row">
			<div class="col-lg-4 col-md-4 col-sm-4 half-color" style="background-color: #9494A3;">
			<div class="col-md-5 col-sm-5 col-lg-5">
			<p><?php echo $departmet['name']; ?></p>
			</div>
			<div class="col-md-5 col-sm-5 col-lg-5">
			<p class="comment-to reduce-fonts"><?php echo $departmet['person_In_charge']; ?>
			<span class="hover-comments hidden-xs">Person in charge</span>
			
			</p>
			</div>
			<div class="col-md-2 col-sm-2 col-lg-2">
			<p class="comment-to reduce-fonts"><?php echo $departmet['average_printing']; ?>
			<span class="hover-comments hidden-xs">Estimated printing pages per month</span>
			
			</p>
			</div>
			
			
			</div>
			<div class="col-lg-8 col-md-8 col-sm-8 department-sec-new">
			<p class="reduce-fonts" style="background:none;"><?php echo $departmet['department_memo']; ?></p>
			</div>
			
			</div>
			<?php } ?>
			</div>
			</h3>
			
			</div>
			
	<div class="dipar" id="dipar<?php echo $depar;?>" style="display:none;">
	<i class="closediper fa fa-times" aria-hidden="true"></i>
	<form method='POST'>
	<input type='hidden' name='delete_department'>
	<input type='hidden' name='contractid' value='<?php echo $contract['id'];?>'>
	<input type='hidden' name='routeid' value='<?php echo $client['id']; ?>'>
	<input type="text" name='dipartment_anem' value='<?php echo $depar;?>' readonly>
	<input type="submit" class="submitbutton btn btn-danger" value="Delete">
	</form>
						
			</div>	
		
			<?php   $allin = getTableFiltered("contract", "clientid", $_GET['id'],'department',$depa); 
						
										foreach($allin as $single){ 
										
									   if($single['ast_sts']!=''){
										
											$modelid = getSingleValue("assets","modelid",$single['assetid']);
											$modelname = getSingleValue("models","name",$modelid);
											$sku = getSingleValue("assets","sku",$single['assetid']);
											$modelimage = getSingleValue("models","image",$modelid);
									 
											$labeldata = getTableFiltered("assets", "id",$single['assetid']);
											foreach($labeldata as $label){
									
											$lableid = $label['statusid'];
											
											$status = "<td><span class='badge' style='background-color:".getSingleValue("labels","color",$lableid)."'>".getSingleValue("labels","name",$lableid)."</span></td>";	
	
											} 
											?>

											<?php if($departmet['name'] != '') { ?>
	
											<div class="col-md-6 itms22 hyh jklk" style="text-align: center;">
											<div class="itm_wrap" >
											<div class="itm_wrap2" >
											 <div class="row">
											<div class="col-md-3 col-xs-7">
											<div class="img_wrap1 imgstyle">
											
											<?php if($modelimage ==""){
												?>
												<span class="imgmain">
												<img src="https://www.panasonic-electric-works.com/static/img/partners/no_image.png" alt="No Image">
												</span>
												<?php
												}else{
												?>
												<span class="imgmain">
												<img src="uploads/<?php echo $modelimage; ?>" alt="No Image">
												
													<span class="tickstats ticketactive">
	<?php 
	$count=0;
	foreach($openTicketsall as $tickete){
	
	
	if($single['id']==$tickete['contractid']){
	
	$count++;
	
	}
	
	
	}
	if($count){
	echo "<span class='count_values' title='Pending Tickets'>".$count."</span>";
	
	}
	?>
	
	</span>
	<span class="tickstats ticketcount">
	<?php 
	$count=0;
	foreach($closeTicketsall as $tickete){
	
	
	if($single['id']==$tickete['contractid']){
	
	$count++;
	
	}
	
	
	}

	if($count){
	echo "<span class='count_values_close' title='Closed Tickets'>".$count."</span>";
	}
	?>
	
	</span>	

	<div class="limt_assets feee jkii jjjjwer"><span class="page_limit" title="Contract Pages / Month">
					 <?php 
					$page_limit= $single['page_limit_per_month'];
					 $accutll_limit  = $single['actual_pages_per_month'];
					if($accutll_limit >= $page_limit){?>
					
					
					<i class="fa fa-tachometer hd1" style="color:red;" aria-hidden="true"></i>
					 <?php 
					echo "<span class='cross_limit hd1'>". number_format($single['page_limit_per_month'])."</span>";
					}else{?>
		<i class="fa fa-tachometer hd1"  aria-hidden="true"></i>
		<span class="hd1">
					<?php $number1 = $single['page_limit_per_month'];
					 $values1 = number_format($number1);
					 echo $values1;}?>
					 </span>
					 
					 <?php if($single['actual_pages_per_month']){ ?>
			   
					<span  class="actual_pages actual_pages1 value123" title="Actaull Pages Per Month">
				<?php $number = $single['actual_pages_per_month'];
	$values = number_format($number);
	echo $values;} ?></span></div>	
	
	
	
											
		<div class="limt_assets limt_assets22 ">
		<span class="page_limit">	
				
				
					 <?php 
					$page_limit= $single['page_limit_per_month'];
					 $accutll_limit  = $single['actual_pages_per_month'];
					if($accutll_limit >= $page_limit){?>
					
					 <?php 
					echo "<span title='Contract Pages / Month --> Font color get red if actual page is bigger than contract page' class='cross_limit'>". number_format($single['page_limit_per_month'])."</span>";
					}else{?>
	<span class="value123" title="Contract Pages / Month --> Font color get red if actual page is bigger than contract page">
					<?php $number1 = $single['page_limit_per_month'];
					 $values1 = number_format($number1);
					 echo $values1;}?>
					 </span>
					
	</div>
	
	
	
	
	
	
	
	
											
												</span>
												<?php
												}
												?>
												
	
												<span class="inser hidden-xs">
												<?php
												if($single['assetid'] == ''){
													echo "<br><td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$single['assetid']."&coid=".$single['id']."\");return false'><span class='label pull_out pullou1' style='background-color:#ff0000;color:#000;border:1px solid #ff6600;color:#fff; cursor:pointer'>For Pullout</span></a></td>";	
												}

												if($single['is_end']!= '1'){
												echo "<span class='label labelee' style=' ".getSingleValue("assetcategories","color",$single['categoryid'])."'>".getSingleValue("assets","status",$single['assetid'])."</span>";
												}else{
											if($single['endasset']=="Replace"){
													echo "<td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$single['assetid']."&coid=".$single['id']."\");return false'><span class='label pull_out pullou1' style='background-color:#ff0000;color:#fff;border:1px solid #ff0000; cursor:pointer'>For Pullout</span></a></td>";
												}elseif($single['endasset']=="End"){
													echo "<td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$single['assetid']."&coid=".$single['id']."\");return false'><span class='label pull_out pullou1' style='background-color:#ff0000;color:#000;border:1px solid #ff6600;color:#fff; cursor:pointer'>For Pullout</span></a></td>";
												}else{
													echo "<td><span class='label pullouted' style='background-color:#fff;color:#000;border:1px solid;".getSingleValue("assetcategories","color",$single['categoryid'])."'>Pulled Out</span></td>";	
												}
												}
												?>
	
												</span>
												
												
	
												</div>
	
	
												</div>
			<div class="col-xs-5 hideondstp1">
							
			
			</div>
												
							
										 
										<div class="col-md-9">
											
										<div class="tlft hidden-xs">
											<div class="wrpnew">
	
									<p class="heading2 heading223" style="display: flex; gap: 5px;"><?php echo $modelname." " ?>
										<span class="display_front" title="Contract Status" style="margin-top: 4px;">
											<?php 	if($single['is_endservice']!= '1'){
			
			
											$status=getSingleValue("assets","status",$single['assetid']);
											
											if($status=='In Service'){
											$status= '<span class="active_css">Active</span>';
											}else if($status=='For Pullout'){
											$status= '<span class="pull_out">For Pullout</span>';
											}else if($status=='On Hold'){
											$status= '<span class="On_Hold">On Hold</span>';
			
											}else{
											$status= '<span class="void">'.$status.'</span>';
			
											}
		
			
											echo "<span class='label label_style' style='border:1px solid;color ".getSingleValue("assetcategories","color",$single['categoryid'])."'>".$status."</span></td>";	
			
											} ?>
			
			
												</span>
												<a style="cursor: pointer; margin-top: 2px;" href="?route=contract/manage&id=<?php echo $single['id']; ?>&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&contractid=<?php echo $single['id']; ?>&section=contract" class="botm_style botm_styleppp"><span title="Contract No." class="contraddd"><?php echo $single['contractno']; ?></span></a>

												<div class="remaindays" style="margin-right: 0px; margin-top: 4px; margin-bottom: 0px;">
	
													<span class="span2">
				
				
														
														 <?php 
												$day_date = $single['contract_expiry'];
														 
														 $date2 = date('Y-m-d');
				
														$diff = abs(strtotime($date2) - strtotime($day_date));
				
														$years = floor($diff / (365*60*60*24));
														$months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
														$days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));
														
														$day="";
														 $x=strtotime($day_date) - strtotime($date2);
														 if($x<0)
														 {
												$day="<span class='badge hththtth' style='background-color:#ff0000'>X</span>";
														  }
														  else{
														  $day=$months*30+$days;
														  $defult_days = get_add_notice_expiration_before_days();
															$span_css = '';
															if($defult_days != ''){
																$day = (int)$day;
																if($day < $defult_days){
																	$span_css = 'style="background-color: #0000FF !important; color: white; margin: 0px 10px;"';
																}
															}
														  }
														 echo "<td class='dgdg jjjjjj'><span title='Days Remaining Until Contract Expiration' class='fffff kkkkk' ". $span_css .">".$day."</span></td>";
																	
													  // echo $day;
														$strrr =$day;
														  ?>
				
														 </span>
														</div>
														<p title="Contract Type" class="back_up" style="margin-left: 0px;margin-top: 4px;"><?php echo getSingleValue("contracttype","name",$single['contracttype']);?></span>
												<!-- add -->
									
											</p>
											<span class="btnmb1 notewrap" style="width: 100%; padding-top: 5px;">
												<span class="rrd123 rrdefv2" style="margin-top: 0px;">
													<i title="you can change asset note form here" class="icn123 fa fa-pencil-square-o" id="<?php echo $single['id'];?>" aria-hidden="true" onclick="get(this.id)";></i>
												</span>
												<div class="notetext" id="ss<?php echo $single['id'];?>" style="display:none;">
												<i class="close12345 fa fa-times" aria-hidden="true"></i>
												
												<h4>Update asset status with memo</h4>
												<div class="popbox">
												<form method='POST'>
												
												
																		<select class="form-control select2 select2-hidden-accessible" id="statusid" name="statusid" style="width: 100%;" tabindex="-1" aria-hidden="true">
																		<?php foreach ($labels as $label) { echo "<option value='".$label['id']."'"; if($asst_status_idw ==$label['id']) echo " selected"; echo ">".$label['name']."</option>"; } ?>
																		</select>
																		<input type='hidden' name='update_memo_status2'>
																		<input type='hidden' name='contractid' value='<?php echo $contract['id'];?>'>
																		<input type='hidden' name='routeid' value='<?php echo $client['id']; ?>'>
																		<input type="submit" class="submitbutton" value="Update">
																		</form>
												
												</div>
												
												<div class="popbox">
												
												<?php 
												
												$labeldata = getTableFiltered("assets", "id",$single['assetid']);
												foreach($labeldata as $labeld){
												
												
												
												if($labeld['sku'] == $sku){
												
														   $notes=$labeld['notes'];
												
												}
												}
												?>
												
												<form method="POST">
												<input type="hidden" name="updatenotes">
												<input type="hidden" name="contractid" value="<?php echo $single['assetid']; ?>">
												<input type="hidden" name="reffer" value="<?php echo $_GET['id'];?>">
												<input type="hidden" name="sku" value="<?php echo $sku;?>">
												<textarea class="summernote" name="notes" id="notes"><?php echo $notes ;?></textarea>
												<input type="submit" class="submitbutton btn btn-success" value="Update">
												</form>
												
												</div>
												</div>

											<?php 
											$serial_no = getSingleValue("assets","serial",$single['assetid']);
											if($serial_no !=''){
											?>
											<span style="font-size: 23px; margin-left: 10px; margin-top: 5px;" title="Serial No."> / <?php echo $serial_no; ?> </span>
											<?php } ?>
												<!--label>Asset Remaining days : </label-->
												<span class="span2 asste_css" style="margin: 0px 5px;">
												<?php 
												$ss = getTableFiltered("assets", "sku",$sku);
		
												foreach($ss as $s){
												if($s['sku']==$sku){
												$day_date = $s['warranty_expiry'];
		
												$date2 = date('Y-m-d');
		
												$diff = abs(strtotime($date2) - strtotime($day_date));
		
												$years = floor($diff / (365*60*60*24));
												$months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
												$days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));
		
												$day="";
												$x=strtotime($day_date) - strtotime($date2);
												if($x<0)
												{
												$day="<span title='Asset warranty is expired' class='badge new_one' style='background-color:#ff0000'>X</span>";
												}
												else{
		
												$day=$months*30+$days;
												}
												if($day>0){
												echo  	$day="<span class='badge' title='Asset Warranty Remaining Days' style='background-color:#ff0000; cursor: pointer;'>".$day."</span>";	  
		
												}else{
												echo 	$day="<span title='Asset warranty is expired' class='badge ' style='background-color:#ccc'>X</span>";
		
												}   
												// echo $day;
												$strrr =$day;
												}
		
												}
												?></span>
												<span title='Asset SKU' class='sku_css' style="float: none; margin-top: 5px;"><?php 
													echo $sku ?></span>

												<p style="font-size: 16px; margin-top: 10px;" class="hidden-xs">
													<span>
													<?php 
														$service_unit_name = get_current_service_unit_modal_name($single['current_service_asset']);
														if($service_unit_name != ''){
															echo  'Current Service Unit : ' . $service_unit_name;
														}
														
													?>
													</span>
												</p>
												<!-- add -->
											

											</span>

											<p class="heading2 caseseriall" title="Case Serial No#"style="cursor:pointer;" id="<?php echo $single['id']; ?>"><?php echo getSingleValue("assets","caseserial",$single['assetid']); ?>
											
												<div class="popupst2 updtcssrl <?php echo $single['id']; ?>" style="display:none;">
												<form method="POST">
													<input type="hidden" name="updateonlycasesrl">
													<input type="hidden" name="assetid" value="<?php echo $single['assetid']; ?>">
													<input type="hidden" name="reffer" value="<?php echo $_GET['id'];?>">
													<input type="text" class="textbox" name="caseserial" value="<?php echo getSingleValue("assets","caseserial",$single['assetid']); ?>">
													<input type="submit" class="submitbutton" value="Update">
													<span class="rremv caseseriall" id="<?php echo $single['id']; ?>"><i class="fa fa-times" aria-hidden="true"></i></span>
		
												</form>
												</div>	
												
												
										</p>
										<p class="botm_style srn1">
										<?php 
										
										//$serial_no = getSingleValue("assets","serial",$single['assetid']);
										// if($serial_no !=''){
										?>
										
										<!-- <p style="font-size: 23px;" title="Serial No."> / <?php // echo $serial_no; ?> </p><?php // } ?></p>	 -->
											
										</div>
					
	
	<?php $asstevalw=getTableFiltered("assets","id",$contract['assetid']);
	
									foreach($asstevalw as $asstew){
										   $asst_status_idw = $asstew['statusid'];}?>		
	
								<span class="memovalue">
								
								<div class=" valuewrap" id="memo<?php echo $single['id'] ;?>" style="display:none;">	
								<span class="closepopup" ><i class="fa fa-times" aria-hidden="true" ></i></span>
	
	
							<form method='POST'>
	
	
							<select class="form-control select2 select2-hidden-accessible" id="statusid" name="statusid" style="width: 100%;" tabindex="-1" aria-hidden="true">
							<?php foreach ($labels as $label) { echo "<option value='".$label['id']."'"; if($asst_status_idw ==$label['id']) echo " selected"; echo ">".$label['name']."</option>"; } ?>
							</select>
							<input type='hidden' name='update_memo_status2'>
							<input type='hidden' name='contractid' value='<?php echo $contract['id'];?>'>
							<input type='hidden' name='routeid' value='<?php echo $client['id']; ?>'>
							<input type="submit" class="submitbutton" value="Update">
							</form>
							</div>
							</span>		
											<div class="wrp1234">
											
											

									
	
	
								
								<!-- <span title='Asset SKU' class='sku_css '><?php 
								echo $sku ?></span> -->
									<?php 
	
									$labeldata = getTableFiltered("assets", "id",$single['assetid']);
									foreach($labeldata as $labeld){
									if($labeld['sku'] == $sku){
	
									$notes=$labeld['notes'];
	
									}
									}
									?>
	
	
									<div class="btnwrps" style="float: left;" >
									<ul class="list-inline" id="<?php echo $single['assetid'];?>" style="height: fit-content;">
									<?php 
	
									foreach($files as $file) { 
									if($file['assetid']==$single['assetid']){
	
									?>
									<li id="">
									<i class="fa fa-<?php echo fileIcon($file['file']); ?>"></i>
									</li>
									<li>
									<a class='preview ' href="<?php echo "ajax.php?download=" . $file['id']; ?>" class='btn-right text-dark'><i class='fa fa-download'></i></a>
									</li>
	
	
									<?php }
									}
									?>
									</ul>	
									</div>									
	
											</div>	
	<div class="wrpnew">								
									
									
										
										
										
										
										
			
											<!-- <a style="cursor: pointer;" href="?route=contract/manage&id=<?php echo $single['id']; ?>&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&contractid=<?php echo $single['id']; ?>&section=contract" class="botm_style botm_styleppp"><span title="Contract No." class="contraddd"><?php echo $single['contractno']; ?></span></a> -->
	
				
	<?php 
	 $tech_mailid = $single['technician_mail_id'];
	 
	  $tech_mobile = $single['technician_mobile_no'];
	  $technician_name = $single['technician_name'];
	  
			  $techi_name=getSingleValue("people","name",$technician_name);
	  
	?>
	
	<?php if(!empty($tech_mailid)){?>
	<span class="technician_info" title="<?php echo $tech_mailid . $tech_mobile;?>">( <?php echo $techi_name;?> )</span><?php } ?>
	
						
			
	
	
	</div>
	<?php 
		$contractno = $single['contractno'];
		$page_plan_html = '';
		if($contractno != ''){
			$contract_data = get_contract_detail_by_contract_no($contractno);
			$contract_condition_name = isset($contract_data[0]['contract_condition']) ? $contract_data[0]['contract_condition'] : ''; 
			if($contract_condition_name == 'page_plan'){
				$contract_condition_name = 'Page Plan';
			}
			if($contract_condition_name != ''){ 
				echo '<p>Plan : <span style="color: #3c8dbc;">'.$contract_condition_name .'</span></p>';
			}
	 }
	?>
	<div style="display: flex; width: 100%; gap: 10px;">
		<?php 

		$contractno = $single['contractno'];
		$page_plan_html = '';
		if($contractno != ''){
			$contract_data = get_contract_detail_by_contract_no($contractno);
			if(isset($contract_data[0]['contract_condition']) && $contract_data[0]['contract_condition'] == 'page_plan'){
				//echo "<pre>";
				//print_r($contract_data[0]);
				//die;
				$page_plan_html .= '
				<table style="width: 49%; border: 2px solid black;">
					<tbody>
						<tr style="border: 2px solid black;">
							<th colspan="5" style="background: #E2E2E2; font-size: 13px; text-align: center;">BASIC CHARGES ( FREE PRINT PAGES )</th>
						</tr>
						<tr style="border: 2px solid black;">
							<td colspan="2"  style="border: 2px solid black;">Black</td>
							<td colspan="2">Color</td>
							<td rowspan="2" style="border: 2px solid black;">Basic Charge</td>
						</tr>
						<tr style="border: 2px solid black;">
							<td style="border: 2px solid black;">A4</td>
							<td style="border: 2px solid black;">A3</td>
							<td style="border: 2px solid black;">A4</td>
							<td style="border: 2px solid black;">A3</td>
						</tr>
						<tr style="border: 2px solid black;">
							<td style="border: 2px solid black;">
								'.getSingleBasicformValue('print_chargies','basic_black_a4', $contract_data[0]['id']) .'
							</td>
		
							<td style="border: 2px solid black;">
								'.getSingleBasicformValue('print_chargies','basic_black_a3', $contract_data[0]['id']) .'
							</td>
		
							<td style="border: 2px solid black;">
								'.getSingleBasicformValue('print_chargies','basic_color_print_a4', $contract_data[0]['id']) .'
							</td>
							<td style="border: 2px solid black;">
								'.getSingleBasicformValue('print_chargies','basic_color_print_a3', $contract_data[0]['id']) .'
							</td>
							<td style="border: 2px solid black;">
								'.getSingleBasicformValue('print_chargies','basic_charges', $contract_data[0]['id']) .'
							</td>
							
						</tr>
					</tbody>
				</table>

				<table style="width: 49%; border: 2px solid black;">
					<tbody>
						<tr style="border: 2px solid black;background: #E2E2E2;">
						<th colspan="5" style=" color: blue;text-align: center;">RATE PER ADDITIONAL PAGES</th>
					</tr>
					<tr  style="border: 2px solid black;">
						<td rowspan="3" style=" border: 2px solid black; padding-left: 5px;"><p>Charge / Page</p></td>
						<td colspan="2" style="border: 2px solid black;">Black</td>
						<td colspan="2" style="border: 2px solid black;">Color</td>
					</tr>
					<tr>
						<td style="border: 2px solid black;">A4</td>
						<td style="border: 2px solid black;">A3</td>
						<td style="border: 2px solid black;">A4</td>
						<td style="border: 2px solid black;">A3</td>
					</tr>
					<tr style="border: 2px solid black;">
						<td style="border: 2px solid black;">
							'.getSingleBasicformValue('print_chargies','extra_black_a4', $contract['id']).'
						</td>
						<td style="border: 2px solid black;">
							'.getSingleBasicformValue('print_chargies','extra_black_a3', $contract['id']).'
						</td>
						<td style="border: 2px solid black;">
							'.getSingleBasicformValue('print_chargies','extra_color_print_a4', $contract['id']).'
						</td>
						<td style="border: 2px solid black;">
							'.getSingleBasicformValue('print_chargies','extra_color_print_a3', $contract['id']).'
						</td>
					</tr>
				</tbody>
				</table>
				';
			}
		}
		echo $page_plan_html;
		?>
	</div>
	<div class="wrpnew">
		<?php
		
		$contractno = str_replace(' ', '', $single['contractno']);
	

		$dipartment_name_a = getSingleValue('department', 'name', $single['department']); // Correct the variable declaration with semicolon

		//echo '<button class="btn btn-primary rrdefv updatedepart" style="height: 40px;width: 99%;text-align: center;margin: 0; padding: 0;font-size: 17px; margin-top: 7px; border: 1px solid #A7A798; color: #A7A798; background-color: #F9F9F9;" id="' . $single['id'] . '">Re Locate Printer' .
			'<span style="font-size: 14px;">(' . strtoupper($dipartment_name_a) . ')</span>
		</button><br>';

		echo '<a class="btn btn-danger" style="margin: 3px 0px 8px; width: 49%;" onClick="showM(\'ajax.php?modal=modelUsageEdit&amp;reroute=system/models&amp;id=' . $single['assetid'] . '&amp;department=' . urlencode($departmet['name']) . '&amp;contractno=' . $contractno.'&amp;contract_id='.$single['id'].'\');return false;" class="btn btn-xs text-dark">Report Usage</a>&nbsp;&nbsp;';

		echo '<a class="btn btn-primary" style="margin: 3px 0px 8px; width: 49%;" onClick="showM(\'ajax.php?modal=modelUsageEditactualstatus&amp;reroute=system/models&amp;id=' . $single['assetid'] . '&amp;department=' . urlencode($departmet['name']) . '&amp;contractno=' . $contractno . '\');return false;" class="btn btn-xs text-dark">Site Report</a>';
		?>

	</div>


	                                    </div>

                                        <div style="float: left;width: 100%;display: inline-block;" class="hidden-lg">
                                            <p class="inser hidden-lg" style="float: left !important; margin: 0px 10px 4px; display: inline-block;">
                                                <?php
                                                if($single['is_end'] != '1') {
                                                    echo "<span class='label labelee' style='" . getSingleValue("assetcategories", "color", $single['categoryid']) . "'>" . getSingleValue("assets", "status", $single['assetid']) . "</span>";
                                                } else {
                                                    if($single['endasset'] == "Replace") {
                                                        echo "<td><span class='label pull_out pullou1' style='background-color:#ff0000;color:#fff;border:1px solid #ff0000; cursor:pointer'>For Pullout</span></td>";
                                                    } elseif($single['endasset'] == "End") {
                                                        echo "<td><span class='label pull_out pullou1' style='background-color:#ff0000;color:#000;border:1px solid #ff6600;color:#fff; cursor:pointer'>For Pullout</span></td>";
                                                    } else {
                                                        echo "<td><span class='label pullouted' style='background-color:#fff;color:#000;border:1px solid;" . getSingleValue("assetcategories", "color", $single['categoryid']) . "'>Pulled Out</span></td>";	
                                                    }
                                                }
                                                ?>
                                            </p>
                                            <p class="display_front hidden-lg" title="Contract Status" style="display: inline-block;">
                                                <?php
                                                if($single['is_endservice'] != '1') {
                                                    $status = getSingleValue("assets", "status", $single['assetid']);
                                                    if($status == 'In Service') {
                                                        $status = '<span class="active_css">Active</span>';
                                                    } elseif($status == 'For Pullout') {
                                                        $status = '<span class="pull_out">For Pullout</span>';
                                                    } elseif($status == 'On Hold') {
                                                        $status = '<span class="On_Hold">On Hold</span>';
                                                    } else {
                                                        $status = '<span class="void">' . $status . '</span>';
                                                    }
                                                    echo "<span class='label label_style' style='border:1px solid;color " . getSingleValue("assetcategories", "color", $single['categoryid']) . "'>" . $status . "</span></td>";	
                                                }
                                                ?>
                                            </p>
                                            <div class="asset_remaindays hidden-lg">
                                                <span class="hidden-lg">
                                                    <?php 
                                                    $ss = getTableFiltered("assets", "sku", $sku);
                                                    foreach($ss as $s) {
                                                        if($s['sku'] == $sku) {
                                                            $day_date = $s['warranty_expiry'];
                                                            $date2 = date('Y-m-d');
                                                            $diff = abs(strtotime($date2) - strtotime($day_date));
                                                            $years = floor($diff / (365*60*60*24));
                                                            $months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
                                                            $days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24) / (60*60*24));
                                                            $day = "";
                                                            $x = strtotime($day_date) - strtotime($date2);
                                                            if($x < 0) {
                                                                $day = "<span title='Asset warranty is expired' class='badge new_one' style='background-color:#ff0000'>X</span>";
                                                            } else {
                                                                $day = $months * 30 + $days;
                                                            }
                                                            if($day > 0) {
                                                                echo  	$day = "<span class='badge' title='Asset Warranty Remaining Days' style='background-color:#ff0000; cursor: pointer;'>" . $day . "</span>";	  
                                                            } else {
                                                                echo 	$day = "<span title='Asset warranty is expired' class='badge' style='background-color:#ccc'>X</span>";
                                                            }   
                                                            $strrr = $day;
                                                        }
                                                    }
                                                    ?>
                                                </span>
                                            </div>	
                                            <span title='Asset SKU' class='sku_css hidden-lg' style="display: inline-block;">
                                                <?php echo $sku . ' Tag :' . $s['tag'];?>
                                            </span>
                                        </div>

                                        <div style="margin: 0px 16px;" class="hidden-lg">
                                            <p class="heading2 heading223 " style="display: inline;float: left;font-size: 21px;"><?php echo $modelname . "-" ?></p>
                                            <p class="botm_style srn1" style="display: inline; float: left;font-size: 21px;">
                                                <?php
                                            
                                                $serial_no = getSingleValue("assets", "serial", $single['assetid']);
                                                if ($serial_no != '') {
                                                ?>
                                            
                                                    <span title="Serial No."> / <?php echo $serial_no; ?> </span><?php } ?>
                                            </p>
                                        </div><br>

                                        <div class="wrpnew hidden-lg">
                                            <p class="botm_style botm_styleppp" style="font-size: 21px; margin: 0px 16px; color: #f60; cursor: pointer;"><span title="Contract No." class="contract_no_css contraddd" ><a style="cursor: pointer;" href="?route=contract/manage&id=<?php echo $single['id']; ?>&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&contractid=<?php echo $single['id']; ?>&section=contract" class="botm_style botm_styleppp"><span title="Contract No." class="contraddd"><?php echo $single['contractno']; ?></span></a></p>

                                            

                                            <?php 
                                    $tech_mailid = $single['technician_mail_id'];
                                    
                                    $tech_mobile = $single['technician_mobile_no'];
                                    $technician_name = $single['technician_name'];
                                    
                                            $techi_name=getSingleValue("people","name",$technician_name);
                                    
                                    ?>
                                    <?php if(!empty($tech_mailid)){?>
                                    <span class="technician_info" title="<?php echo $tech_mailid . $tech_mobile;?>">( <?php echo $techi_name;?> )</span><?php } ?>
                                        </div>

                                        <div class="wrpnew hidden-lg">
                                            <?php
                                            
                                            $contractno = str_replace(' ', '', $single['contractno']);
                                            echo '<a class="btn btn-danger" style="margin: 6px 13px 8px;" onClick="showM(\'ajax.php?modal=modelUsageEdit&amp;reroute=system/models&amp;id=' . $single['assetid'] . '&amp;department=' . urlencode($departmet['name']) . '&amp;contractno=' . $contractno . '\');return false;" class="btn btn-xs text-dark">Report Usage</a>';

                                            echo '<a class="btn btn-primary" style="margin: 3px 0px 8px;" onClick="showM(\'ajax.php?modal=modelUsageEditactualstatus&amp;reroute=system/models&amp;id=' . $single['assetid'] . '&amp;department=' . urlencode($departmet['name']) . '&amp;contractno=' . $contractno . '\');return false;" class="btn btn-xs text-dark">Site Report</a>';
                                    
                                            ?>
                                    
                                        </div>
	
	
								<div class="tools1">
									<div class="popstyle1 upcondep <?php echo $single['id']; ?>" style="display:none;">
											<h3>Update Location from list</h3>
											<form method="POST">
												<input type="hidden" name="updateonlydepart">
												<input type="hidden" name="contractid" value="<?php echo $single['id']; ?>">
												<input type="hidden" name="reffer" value="<?php echo $_GET['id'];?>">
												
												<input type="hidden" class="textbox" name="conntde" value="<?php echo $depar; ?>">
	
	
												<?php  
											  $depart = array_unique($contractsdepart_n);
												
												$dipartmetn= $single['department'];
												?>
												
												<select class="select123" name="conntde">
											<?php
									  foreach($depart as $dipar){
	
	
						$dipart= getSingleValue("department","name",$dipar);
						 if($dipart !=""){ ?>
						<option <?php echo ($dipar == $dipartmetn) ? 'selected' : '' ?> value="<?=$dipar; ?>"><?= $dipart; ?></option> <?php 
										 } } ?>	  </select>
		<input type="submit" class="submitbutton" value="Update">
	<span style="" class="clode112 rremv updatedepart" id="<?php echo $single['id']; ?>"><i class="fa fa-times" aria-hidden="true"></i></span></form>
	
	
		<!--form method="POST">
												<input type="hidden" name="updateonlydepart">
												<input type="hidden" name="contractid" value="<//?php echo $single['id']; ?>">
												<input type="hidden" name="reffer" value="<//?php echo $_GET['id'];?>">
												<input type="text" class="textbox" name="conntde" value="">
												<input type="submit" class="submitbutton" value="Add">
												<span style="display:none;" class="rremv updatedepart" id="</?php echo $single['id']; ?>"><i class="fa fa-times" aria-hidden="true"></i></span>
											</form-->
											</div>
	<p class="btnmb1 refresh1"><img title="Change Asset Location ( Department )" class="rrdefv updatedepart" id="<?php echo $single['id']; ?>" width="18px" src="uploads/changing.png" alt="No Image"></p>
											<a title="Create Ticket for this asset"class="btnmb1 sentto" href="#" onClick='showM("ajax.php?modal=ticketAdd&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&contractid=<?php echo $single['id'] ;?>&section=tab-department");return false' data-toggle="modal"><img class="rrdefv"width="20px" style="" src="uploads/add_ticket.png" alt="No Image"></a>	
	
	
	<span class="btnmb1 limit">
	<span title="Input estimate average usage 			
	Monthy print out pages - esitmate only"class="limit_icn rrdefv2" onClick="limit(<?php echo $single['id'];?>);" id="<?php echo $single['id'];?>"><i class="fa fa-tachometer" aria-hidden="true"></i></span>	
	<div  class="limit_wrap  limit_wrapp2" id="limit<?php echo $single['id'];?>">
	<i class="off_limiwrwp fa fa-times" aria-hidden="true"></i>
	
	<div class="popbox limitbox">
	
	
	<label class="title_css">Everage print out pages per month</label>
	<form method='POST'>
	<input class="input-style" 
	name="actual_pages_per_month" type="text" 
	value="<?php 
	$number = $single['actual_pages_per_month'];
	$values = number_format($number);
	echo $values;
	?>">
							<input type='hidden' name='update_limit_cycle'>
							<input type='hidden' name='contractid' value='<?php echo $single['id'];?>'>
							<input type='hidden' name='routeid' value='<?php echo $client['id']; ?>'>
							<input type="submit" class="submitbutton" value="Update">
							</form>
	
	</div>
	
	</div>
	</span>	
		<span title="Change Technician in charge of this Asset ( Printer )
	" class="btnmb1 limitvv">
	<span class="limit_icnf rrdefv2" onClick="technician(<?php echo $single['id'];?>);"><i class="fa fa-wrench" aria-hidden="true"></i></span>	
	<div class="limit_wrapp  limit_wrapp2" id="te<?php echo $single['id'];?>">
	<i class="off_limiwrwp fa fa-times" aria-hidden="true"></i>
	
	<div class="popbox limitbox">
	
	
	<label class="title_css">Update Technician</label>
	<form method='POST' id="f<?php echo $single['id'];?>">
	<?php 
	
	 $technician_name = $single['technician_name'];
	  
	$technician_data = getTable("people");
	
	?>
	<input type='hidden' name='update_technician_details'>
	<select class="form-control select2 select2-hidden-accessible technician_value" onchange="techni(<?php echo $single['id'];?>,this.value)"id="technician_value" name="technician_value" style="width: 100%;" tabindex="-1" aria-hidden="true">
							<option value=''>Select Technician</option>
							<?php foreach ($technician_data as $technician) {
							 
							 if($technician['role'] == 'technician'){
						   
							echo "<option value='".$technician['id']."'"; if($technician_name ==$technician['id']) echo " selected"; echo ">".$technician['name']."</option>";  } }
							?>
							</select>
							
							<?php 
							
							$emailval=$technician['email'];
							$mobile =$technician['mobile'];
	
							?>
							
		<input type='hidden' name='tech_mobile_data' id='tech_mobile_data' value="<?php echo $mobile; ?>">
		<input type='hidden' name='tech_mailid_data'  id='tech_mailid_data'value="<?php echo $emailval ;?>">
							<input type='hidden' name='contractid'  value='<?php echo $single['id'];?>'>
							<input type='hidden' name='routeid'  value='<?php echo $client['id']; ?>'>
							<input type="submit" class="submitbutton" value="Update">
							
							</form>
	
	</div> </div></span> <span title="Qrcode " class="btnmb1 limitvv qr-modal-ticket"
	data-contract-id="<?php echo $single['contractno']; ?>">
	<span class="limit_icnf rrdefv2 " class="qr-modal-ticket"><i
			class="fa fa-qrcode" aria-hidden="true"></i></span>
	</span>	

	<?php 
	$contractno = str_replace(' ', '', $single['contractno']);
	$name = urlencode($departmet['name'])
	?>
	<span title="" class="btnmb1 limitvv qr-modal-ticket_second"
	data-contract-id="<?php echo $single['contractno']; ?>" data-client-id="<?php echo $_GET['id']; ?>" data-assetid="<?php echo $single['assetid']; ?>" data-contractno="<?php echo $contractno; ?>" data-department_name="<?php echo $name; ?>">
	<span class="limit_icnf rrdefv2 " class="qr-modal-ticket_second"><i
			class="fa fa-qrcode" aria-hidden="true"></i></span>
	</span>
</div></div></div>
					</div>
				</div></div>
				<?php } ?>
								<?php
								
								}
								}  ?>
							
									</div>
							<?php	
							}
							
								}
							
								?>
							
								<div class="row maindtext">
								 <?php  $deparrr =' ';?>
									<div class="head"><h3 style="background-color: #D0D0D7;">
									<div class="col-lg-4 col-md-4 col-sm-4" style="background-color: #9494A3;">
							
									<span style=" padding-left:0px; padding: 0px; background-color: #9494A3;"><label>Department is not assigned</label></span></div></h3></div>	
									<?php  
									$allin = getTableFiltered("contract", "clientid", $_GET['id'],'department',$deparrr); 
										
									foreach($allin as $single){ 
									
									
									if($single['ast_sts']!=''){
								
									
										$modelid = getSingleValue("assets","modelid",$single['assetid']);
										$modelname = getSingleValue("models","name",$modelid);
										$sku = getSingleValue("assets","sku",$single['assetid']);
										$modelimage = getSingleValue("models","image",$modelid);
										$labeldata = getTableFiltered("assets", "id",$single['assetid']); 
										foreach($labeldata as $label){
								
										  $lableid = $label['statusid'];	
											$status = "<td><span class='badge' style='background-color:".getSingleValue("labels","color",$lableid)."'>".getSingleValue("labels","name",$lableid)."</span></td>";	
				
										} 
										?>
			<div class="col-md-6 itms22 hyh jklk" style="text-align: center;">
											<div class="itm_wrap" >
												<div class="itm_wrap2" >
													<div class="row">
												   <div class="col-md-3 col-xs-7">
												   <div class="img_wrap1 imgstyle">
												   
												   <?php if($modelimage ==""){
													   ?>
													   <span class="imgmain">
													   <img src="https://www.panasonic-electric-works.com/static/img/partners/no_image.png" alt="No Image">
													   </span>
													   <?php
													   }else{
													   ?>
													   <span class="imgmain">
													   <img src="uploads/<?php echo $modelimage; ?>" alt="No Image">
													   
														   <span class="tickstats ticketactive">
		   <?php 
		   $count=0;
		   foreach($openTicketsall as $tickete){
		   
		   
		   if($single['id']==$tickete['contractid']){
		   
		   $count++;
		   
		   }
		   
		   
		   }
		   if($count){
		   echo "<span class='count_values' title='Pending Tickets'>".$count."</span>";
		   
		   }
		   ?>
		   
		   </span>
		   <span class="tickstats ticketcount">
		   <?php 
		   $count=0;
		   foreach($closeTicketsall as $tickete){
		   
		   
		   if($single['id']==$tickete['contractid']){
		   
		   $count++;
		   
		   }
		   
		   
		   }
	   
		   if($count){
		   echo "<span class='count_values_close' title='Closed Tickets'>".$count."</span>";
		   }
		   ?>
		   
		   </span>	
	   
		   <div class="limt_assets feee jkii jjjjwer"><span class="page_limit" title="Contract Pages / Month">
							<?php 
						   $page_limit= $single['page_limit_per_month'];
							$accutll_limit  = $single['actual_pages_per_month'];
						   if($accutll_limit >= $page_limit){?>
						   
						   
						   <i class="fa fa-tachometer hd1" style="color:red;" aria-hidden="true"></i>
							<?php 
						   echo "<span class='cross_limit hd1'>". number_format($single['page_limit_per_month'])."</span>";
						   }else{?>
			   <i class="fa fa-tachometer hd1"  aria-hidden="true"></i>
			   <span class="hd1">
						   <?php $number1 = $single['page_limit_per_month'];
							$values1 = number_format($number1);
							echo $values1;}?>
							</span>
							
							<?php if($single['actual_pages_per_month']){ ?>
					  
						   <span  class="actual_pages actual_pages1 value123" title="Actaull Pages Per Month">
					   <?php $number = $single['actual_pages_per_month'];
		   $values = number_format($number);
		   echo $values;} ?></span></div>	
		   
		   
		   
												   
			   <div class="limt_assets limt_assets22 ">
			   <span class="page_limit">	
					   
					   
							<?php 
						   $page_limit= $single['page_limit_per_month'];
							$accutll_limit  = $single['actual_pages_per_month'];
						   if($accutll_limit >= $page_limit){?>
						   
							<?php 
						   echo "<span title='Contract Pages / Month --> Font color get red if actual page is bigger than contract page' class='cross_limit'>". number_format($single['page_limit_per_month'])."</span>";
						   }else{?>
		   <span class="value123" title="Contract Pages / Month --> Font color get red if actual page is bigger than contract page">
						   <?php $number1 = $single['page_limit_per_month'];
							$values1 = number_format($number1);
							echo $values1;}?>
							</span>
						   
		   </div>
		   
		   
		   
		   
		   
		   
		   
		   
												   
													   </span>
													   <?php
													   }
													   ?>
													   
		   
													   <span class="inser hidden-xs">
													   <?php
													   if($single['assetid'] == ''){
														   echo "<br><td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$single['assetid']."&coid=".$single['id']."\");return false'><span class='label pull_out pullou1' style='background-color:#ff0000;color:#000;border:1px solid #ff6600;color:#fff; cursor:pointer'>For Pullout</span></a></td>";	
													   }
	   
													   if($single['is_end']!= '1'){
													   echo "<span class='label labelee' style=' ".getSingleValue("assetcategories","color",$single['categoryid'])."'>".getSingleValue("assets","status",$single['assetid'])."</span>";
													   }else{
												   if($single['endasset']=="Replace"){
														   echo "<td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$single['assetid']."&coid=".$single['id']."\");return false'><span class='label pull_out pullou1' style='background-color:#ff0000;color:#fff;border:1px solid #ff0000; cursor:pointer'>For Pullout</span></a></td>";
													   }elseif($single['endasset']=="End"){
														   echo "<td><a onClick='showM(\"ajax.php?modal=pullout&cid=".$client['id']."&oaid=".$single['assetid']."&coid=".$single['id']."\");return false'><span class='label pull_out pullou1' style='background-color:#ff0000;color:#000;border:1px solid #ff6600;color:#fff; cursor:pointer'>For Pullout</span></a></td>";
													   }else{
														   echo "<td><span class='label pullouted' style='background-color:#fff;color:#000;border:1px solid;".getSingleValue("assetcategories","color",$single['categoryid'])."'>Pulled Out</span></td>";	
													   }
													   }
													   ?>
		   
													   </span>
													   
													   
		   
													   </div>
		   
		   
													   </div>
				   <div class="col-xs-5 hideondstp1">
								   
				   
				   </div>
													   
								   
												
											   <div class="col-md-9">
												   
											   <div class="tlft hidden-xs">
												   <div class="wrpnew">
		   
										   <p class="heading2 heading223"><?php echo $modelname."-" ?>
										   <span class="btnmb1 notewrap">
		   <span class="rrd123 rrdefv2">
			   <i title="you can change asset note form here" class="icn123 fa fa-pencil-square-o" id="<?php echo $single['id'];?>" aria-hidden="true" onclick="get(this.id)";></i>
			   </span>
		   <div class="notetext" id="ss<?php echo $single['id'];?>" style="display:none;">
		   <i class="close12345 fa fa-times" aria-hidden="true"></i>
		   
		   <h4>Update asset status with memo</h4>
		   <div class="popbox">
		   <form method='POST'>
		   
		   
								   <select class="form-control select2 select2-hidden-accessible" id="statusid" name="statusid" style="width: 100%;" tabindex="-1" aria-hidden="true">
								   <?php foreach ($labels as $label) { echo "<option value='".$label['id']."'"; if($asst_status_idw ==$label['id']) echo " selected"; echo ">".$label['name']."</option>"; } ?>
								   </select>
								   <input type='hidden' name='update_memo_status2'>
								   <input type='hidden' name='contractid' value='<?php echo $contract['id'];?>'>
								   <input type='hidden' name='routeid' value='<?php echo $client['id']; ?>'>
								   <input type="submit" class="submitbutton" value="Update">
								   </form>
		   
		   </div>
		   
		   <div class="popbox">
		   
		   <?php 
		   
		   $labeldata = getTableFiltered("assets", "id",$single['assetid']);
		   foreach($labeldata as $labeld){
		   
		   
		   
		   if($labeld['sku'] == $sku){
		   
					  $notes=$labeld['notes'];
		   
		   }
		   }
		   ?>
		   
		   <form method="POST">
		   <input type="hidden" name="updatenotes">
		   <input type="hidden" name="contractid" value="<?php echo $single['assetid']; ?>">
		   <input type="hidden" name="reffer" value="<?php echo $_GET['id'];?>">
		   <input type="hidden" name="sku" value="<?php echo $sku;?>">
		   <textarea class="summernote" name="notes" id="notes"><?php echo $notes ;?></textarea>
		   <input type="submit" class="submitbutton btn btn-success" value="Update">
		   </form>
		   
		   </div>
		   </div>
										   </span>
												   </p>
	   
												   <p class="heading2 caseseriall" title="Case Serial No#"style="cursor:pointer;" id="<?php echo $single['id']; ?>"><?php echo getSingleValue("assets","caseserial",$single['assetid']); ?>
												   
													   <div class="popupst2 updtcssrl <?php echo $single['id']; ?>" style="display:none;">
													   <form method="POST">
														   <input type="hidden" name="updateonlycasesrl">
														   <input type="hidden" name="assetid" value="<?php echo $single['assetid']; ?>">
														   <input type="hidden" name="reffer" value="<?php echo $_GET['id'];?>">
														   <input type="text" class="textbox" name="caseserial" value="<?php echo getSingleValue("assets","caseserial",$single['assetid']); ?>">
														   <input type="submit" class="submitbutton" value="Update">
														   <span class="rremv caseseriall" id="<?php echo $single['id']; ?>"><i class="fa fa-times" aria-hidden="true"></i></span>
			   
													   </form>
													   </div>	
													   
													   
											   </p>
											   <p class="botm_style srn1">
											   <?php 
											   
								   $serial_no = getSingleValue("assets","serial",$single['assetid']);
											   if($serial_no !=''){
											   ?>
											   
											   <p style="font-size: 23px;" title="Serial No."> / <?php echo $serial_no; ?> </p><?php } ?></p>	
												   
											   </div>
						   
		   
		   <?php $asstevalw=getTableFiltered("assets","id",$contract['assetid']);
		   
										   foreach($asstevalw as $asstew){
												  $asst_status_idw = $asstew['statusid'];}?>		
		   
									   <span class="memovalue">
									   
									   <div class=" valuewrap" id="memo<?php echo $single['id'] ;?>" style="display:none;">	
									   <span class="closepopup" ><i class="fa fa-times" aria-hidden="true" ></i></span>
		   
		   
								   <form method='POST'>
		   
		   
								   <select class="form-control select2 select2-hidden-accessible" id="statusid" name="statusid" style="width: 100%;" tabindex="-1" aria-hidden="true">
								   <?php foreach ($labels as $label) { echo "<option value='".$label['id']."'"; if($asst_status_idw ==$label['id']) echo " selected"; echo ">".$label['name']."</option>"; } ?>
								   </select>
								   <input type='hidden' name='update_memo_status2'>
								   <input type='hidden' name='contractid' value='<?php echo $contract['id'];?>'>
								   <input type='hidden' name='routeid' value='<?php echo $client['id']; ?>'>
								   <input type="submit" class="submitbutton" value="Update">
								   </form>
								   </div>
								   </span>		
												   <div class="wrp1234">
												   
												   
	   
										   <div class="asset_remaindays">
											   <!--label>Asset Remaining days : </label-->
											   <span class="span2 asste_css">
											   <?php 
											   $ss = getTableFiltered("assets", "sku",$sku);
	   
											   foreach($ss as $s){
											   if($s['sku']==$sku){
											   $day_date = $s['warranty_expiry'];
	   
											   $date2 = date('Y-m-d');
	   
											   $diff = abs(strtotime($date2) - strtotime($day_date));
	   
											   $years = floor($diff / (365*60*60*24));
											   $months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
											   $days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));
	   
											   $day="";
											   $x=strtotime($day_date) - strtotime($date2);
											   if($x<0)
											   {
											   $day="<span title='Asset warranty is expired' class='badge new_one' style='background-color:#ff0000'>X</span>";
											   }
											   else{
	   
											   $day=$months*30+$days;
											   }
											   if($day>0){
											   echo  	$day="<span class='badge' title='Asset Warranty Remaining Days' style='background-color:#ff0000; cursor: pointer;'>".$day."</span>";	  
	   
											   }else{
											   echo 	$day="<span title='Asset warranty is expired' class='badge ' style='background-color:#ccc'>X</span>";
	   
											   }   
											   // echo $day;
											   $strrr =$day;
											   }
	   
											   }
											   ?></span></div>	
		   
		   
									   
									   <span title='Asset SKU' class='sku_css '><?php 
									   echo $sku ?></span>
										   <?php 
		   
										   $labeldata = getTableFiltered("assets", "id",$single['assetid']);
										   foreach($labeldata as $labeld){
										   if($labeld['sku'] == $sku){
		   
										   $notes=$labeld['notes'];
		   
										   }
										   }
										   ?>
		   
		   
										   <div class="btnwrps" style="float: left;" >
										   <ul class="todo-list list-inline" id="<?php echo $single['assetid'];?>">
										   <?php 
		   
										   foreach($files as $file) { 
										   if($file['assetid']==$single['assetid']){
		   
										   ?>
										   <li id="">
										   <i class="fa fa-<?php echo fileIcon($file['file']); ?>"></i>
										   </li>
										   <li>
										   <a class='preview ' href="<?php echo "ajax.php?download=" . $file['id']; ?>" class='btn-right text-dark'><i class='fa fa-download'></i></a>
										   </li>
		   
		   
										   <?php }
										   }
										   ?>
										   </ul>	
										   </div>									
		   
												   </div>	
		   <div class="wrpnew">								
										   <span class="display_front" title="Contract Status">
										   <?php 	if($single['is_endservice']!= '1'){
		   
		   
										   $status=getSingleValue("assets","status",$single['assetid']);
										   
										   if($status=='In Service'){
										   $status= '<span class="active_css">Active</span>';
										   }else if($status=='For Pullout'){
										   $status= '<span class="pull_out">For Pullout</span>';
										   }else if($status=='On Hold'){
										   $status= '<span class="On_Hold">On Hold</span>';
		   
										   }else{
										   $status= '<span class="void">'.$status.'</span>';
		   
										   }
	   
		   
										   echo "<span class='label label_style' style='border:1px solid;color ".getSingleValue("assetcategories","color",$single['categoryid'])."'>".$status."</span></td>";	
		   
										   } ?>
		   
		   
											   </span>
										   
											   
											   
											   
											   
											   
				   <div class="remaindays">
		   
											   <span class="span2">
		   
		   
												   
													<?php 
										   $day_date = $single['contract_expiry'];
													
													$date2 = date('Y-m-d');
		   
												   $diff = abs(strtotime($date2) - strtotime($day_date));
		   
												   $years = floor($diff / (365*60*60*24));
												   $months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
												   $days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));
												   
												   $day="";
													$x=strtotime($day_date) - strtotime($date2);
													if($x<0)
													{
										   $day="<span class='badge hththtth' style='background-color:#ff0000'>X</span>";
													 }
													 else{
													 $day=$months*30+$days;
													 }
													echo "<td class='dgdg jjjjjj'><span title='Total Remaining Days Of Contract' class='fffff kkkkk'>".$day."</span></td>";
															   
												 // echo $day;
												   $strrr =$day;
													 ?>
		   
													</span>
												   </div>
												   <a style="cursor: pointer;" href="?route=contract/manage&id=<?php echo $single['id']; ?>&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&contractid=<?php echo $single['id']; ?>&section=contract" class="botm_style botm_styleppp"><span title="Contract No." class="contraddd"><?php echo $single['contractno']; ?></span></a>
		   <span title="Contract Type" class="back_up"><?php echo getSingleValue("contracttype","name",$single['contracttype']);?></span>
					   
		   <?php 
			$tech_mailid = $single['technician_mail_id'];
			
			 $tech_mobile = $single['technician_mobile_no'];
			 $technician_name = $single['technician_name'];
			 
					 $techi_name=getSingleValue("people","name",$technician_name);
			 
		   ?>
		   
		   <?php if(!empty($tech_mailid)){?>
		   <span class="technician_info" title="<?php echo $tech_mailid . $tech_mobile;?>">( <?php echo $techi_name;?> )</span><?php } ?>
		   
							   
				   
		   
		   
		   </div>
	   
		   <div class="wrpnew">
			   <?php
			   
			   $contractno = str_replace(' ', '', $single['contractno']);
			   echo '<a class="btn btn-danger" style="margin: 3px 0px 8px;" onClick="showM(\'ajax.php?modal=modelUsageEdit&amp;reroute=system/models&amp;id=' . $single['assetid'] . '&amp;department=' . urlencode($departmet['name']) . '&amp;contractno=' . $contractno . '\');return false;" class="btn btn-xs text-dark">Report Usage</a>&nbsp;&nbsp;';

			   	echo '<a class="btn btn-primary" style="margin: 3px 0px 8px;" onClick="showM(\'ajax.php?modal=modelUsageEditactualstatus&amp;reroute=system/models&amp;id=' . $single['assetid'] . '&amp;department=' . urlencode($departmet['name']) . '&amp;contractno=' . $contractno . '\');return false;" class="btn btn-xs text-dark">Site Report</a>';
	   
			   ?>
	   
		   </div>
	   
		                                        </div>

                                                <div style="float: left;width: 100%;display: inline-block;" class="hidden-lg">
													<p class="inser hidden-lg" style="float: left !important; margin: 0px 10px 4px; display: inline-block;">
														<?php
														if($single['is_end'] != '1') {
															echo "<span class='label labelee' style='" . getSingleValue("assetcategories", "color", $single['categoryid']) . "'>" . getSingleValue("assets", "status", $single['assetid']) . "</span>";
														} else {
															if($single['endasset'] == "Replace") {
																echo "<td><span class='label pull_out pullou1' style='background-color:#ff0000;color:#fff;border:1px solid #ff0000; cursor:pointer'>For Pullout</span></td>";
															} elseif($single['endasset'] == "End") {
																echo "<td><span class='label pull_out pullou1' style='background-color:#ff0000;color:#000;border:1px solid #ff6600;color:#fff; cursor:pointer'>For Pullout</span></td>";
															} else {
																echo "<td><span class='label pullouted' style='background-color:#fff;color:#000;border:1px solid;" . getSingleValue("assetcategories", "color", $single['categoryid']) . "'>Pulled Out</span></td>";	
															}
														}
														?>
													</p>
													<p class="display_front hidden-lg" title="Contract Status" style="display: inline-block;">
														<?php
														if($single['is_endservice'] != '1') {
															$status = getSingleValue("assets", "status", $single['assetid']);
															if($status == 'In Service') {
																$status = '<span class="active_css">Active</span>';
															} elseif($status == 'For Pullout') {
																$status = '<span class="pull_out">For Pullout</span>';
															} elseif($status == 'On Hold') {
																$status = '<span class="On_Hold">On Hold</span>';
															} else {
																$status = '<span class="void">' . $status . '</span>';
															}
															echo "<span class='label label_style' style='border:1px solid;color " . getSingleValue("assetcategories", "color", $single['categoryid']) . "'>" . $status . "</span></td>";	
														}
														?>
													</p>
													<div class="asset_remaindays hidden-lg">
														<span class="hidden-lg">
															<?php 
															$ss = getTableFiltered("assets", "sku", $sku);
															foreach($ss as $s) {
																if($s['sku'] == $sku) {
																	$day_date = $s['warranty_expiry'];
																	$date2 = date('Y-m-d');
																	$diff = abs(strtotime($date2) - strtotime($day_date));
																	$years = floor($diff / (365*60*60*24));
																	$months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
																	$days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24) / (60*60*24));
																	$day = "";
																	$x = strtotime($day_date) - strtotime($date2);
																	if($x < 0) {
																		$day = "<span title='Asset warranty is expired' class='badge new_one' style='background-color:#ff0000'>X</span>";
																	} else {
																		$day = $months * 30 + $days;
																	}
																	if($day > 0) {
																		echo  	$day = "<span class='badge' title='Asset Warranty Remaining Days' style='background-color:#ff0000; cursor: pointer;'>" . $day . "</span>";	  
																	} else {
																		echo 	$day = "<span title='Asset warranty is expired' class='badge' style='background-color:#ccc'>X</span>";
																	}   
																	$strrr = $day;
																}
															}
															?>
														</span>
													</div>	
													<span title='Asset SKU' class='sku_css hidden-lg' style="display: inline-block;">
														<?php echo $sku . ' Tag :' . $s['tag'];?>
													</span>
												</div>
		
												<div style="margin: 0px 16px;" class="hidden-lg">
													<p class="heading2 heading223 " style="display: inline;float: left;font-size: 21px;"><?php echo $modelname . "-" ?></p>
													<p class="botm_style srn1" style="display: inline; float: left;font-size: 21px;">
														<?php
													
														$serial_no = getSingleValue("assets", "serial", $single['assetid']);
														if ($serial_no != '') {
														?>
													
															<span title="Serial No."> / <?php echo $serial_no; ?> </span><?php } ?>
													</p>
												</div><br>
		
												<div class="wrpnew hidden-lg">
													<p class="botm_style botm_styleppp" style="font-size: 21px; margin: 0px 16px; color: #f60; cursor: pointer;"><span title="Contract No." class="contract_no_css contraddd" ><a style="cursor: pointer;" href="?route=contract/manage&id=<?php echo $single['id']; ?>&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&contractid=<?php echo $single['id']; ?>&section=contract" class="botm_style botm_styleppp"><span title="Contract No." class="contraddd"><?php echo $single['contractno']; ?></span></a></p>
		
													
		
													<?php 
											$tech_mailid = $single['technician_mail_id'];
											
											$tech_mobile = $single['technician_mobile_no'];
											$technician_name = $single['technician_name'];
											
													$techi_name=getSingleValue("people","name",$technician_name);
											
											?>
											<?php if(!empty($tech_mailid)){?>
											<span class="technician_info" title="<?php echo $tech_mailid . $tech_mobile;?>">( <?php echo $techi_name;?> )</span><?php } ?>
												</div>
		
												<div class="wrpnew hidden-lg">
													<?php
													
													$contractno = str_replace(' ', '', $single['contractno']);
													echo '<a class="btn btn-danger" style="margin: 6px 13px 8px;" onClick="showM(\'ajax.php?modal=modelUsageEdit&amp;reroute=system/models&amp;id=' . $single['assetid'] . '&amp;department=' . urlencode($departmet['name']) . '&amp;contractno=' . $contractno . '\');return false;" class="btn btn-xs text-dark">Report Usage</a>';

													echo '<a class="btn btn-primary" style="margin: 3px 0px 8px;" onClick="showM(\'ajax.php?modal=modelUsageEditactualstatus&amp;reroute=system/models&amp;id=' . $single['assetid'] . '&amp;department=' . urlencode($departmet['name']) . '&amp;contractno=' . $contractno . '\');return false;" class="btn btn-xs text-dark">Site Report</a>';
											
													?>
											
												</div>
		   
		   
									   <div class="tools1">
										   <div class="popstyle1 upcondep <?php echo $single['id']; ?>" style="display:none;">
												   <h3>Update Location from list</h3>
												   <form method="POST">
													   <input type="hidden" name="updateonlydepart">
													   <input type="hidden" name="contractid" value="<?php echo $single['id']; ?>">
													   <input type="hidden" name="reffer" value="<?php echo $_GET['id'];?>">
													   
													   <input type="hidden" class="textbox" name="conntde" value="<?php echo $depar; ?>">
		   
		   
													   <?php  
													 $depart = array_unique($contractsdepart_n);
													   
													   $dipartmetn= $single['department'];
													   ?>
													   
													   <select class="select123" name="conntde">
												   <?php
											 foreach($depart as $dipar){
		   
		   
							   $dipart= getSingleValue("department","name",$dipar);
								if($dipart !=""){ ?>
							   <option <?php echo ($dipar == $dipartmetn) ? 'selected' : '' ?> value="<?=$dipar; ?>"><?= $dipart; ?></option> <?php 
												} } ?>	  </select>
			   <input type="submit" class="submitbutton" value="Update">
		   <span style="" class="clode112 rremv updatedepart" id="<?php echo $single['id']; ?>"><i class="fa fa-times" aria-hidden="true"></i></span></form>
		   
		   
			   <!--form method="POST">
													   <input type="hidden" name="updateonlydepart">
													   <input type="hidden" name="contractid" value="<//?php echo $single['id']; ?>">
													   <input type="hidden" name="reffer" value="<//?php echo $_GET['id'];?>">
													   <input type="text" class="textbox" name="conntde" value="">
													   <input type="submit" class="submitbutton" value="Add">
													   <span style="display:none;" class="rremv updatedepart" id="</?php echo $single['id']; ?>"><i class="fa fa-times" aria-hidden="true"></i></span>
												   </form-->
												   </div>
		   <p class="btnmb1 refresh1"><img title="Change Asset Location ( Department )" class="rrdefv updatedepart" id="<?php echo $single['id']; ?>" width="18px" src="uploads/changing.png" alt="No Image"></p>
												   <a title="Create Ticket for this asset"class="btnmb1 sentto" href="#" onClick='showM("ajax.php?modal=ticketAdd&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&contractid=<?php echo $single['id'] ;?>&section=tab-department");return false' data-toggle="modal"><img class="rrdefv"width="20px" style="" src="uploads/add_ticket.png" alt="No Image"></a>	
		   
		   
		   <span class="btnmb1 limit">
		   <span title="Input estimate average usage 			
		   Monthy print out pages - esitmate only"class="limit_icn rrdefv2" onClick="limit(<?php echo $single['id'];?>);" id="<?php echo $single['id'];?>"><i class="fa fa-tachometer" aria-hidden="true"></i></span>	
		   <div  class="limit_wrap  limit_wrapp2" id="limit<?php echo $single['id'];?>">
		   <i class="off_limiwrwp fa fa-times" aria-hidden="true"></i>
		   
		   <div class="popbox limitbox">
		   
		   
		   <label class="title_css">Everage print out pages per month</label>
		   <form method='POST'>
		   <input class="input-style" 
		   name="actual_pages_per_month" type="text" 
		   value="<?php 
		   $number = $single['actual_pages_per_month'];
		   $values = number_format($number);
		   echo $values;
		   ?>">
								   <input type='hidden' name='update_limit_cycle'>
								   <input type='hidden' name='contractid' value='<?php echo $single['id'];?>'>
								   <input type='hidden' name='routeid' value='<?php echo $client['id']; ?>'>
								   <input type="submit" class="submitbutton" value="Update">
								   </form>
		   
		   </div>
		   
		   </div>
		   </span>	
			   <span title="Change Technician in charge of this Asset ( Printer )
		   " class="btnmb1 limitvv">
		   <span class="limit_icnf rrdefv2" onClick="technician(<?php echo $single['id'];?>);"><i class="fa fa-wrench" aria-hidden="true"></i></span>	
		   <div class="limit_wrapp  limit_wrapp2" id="te<?php echo $single['id'];?>">
		   <i class="off_limiwrwp fa fa-times" aria-hidden="true"></i>
		   
		   <div class="popbox limitbox">
		   
		   
		   <label class="title_css">Update Technician</label>
		   <form method='POST' id="f<?php echo $single['id'];?>">
		   <?php 
		   
			$technician_name = $single['technician_name'];
			 
		   $technician_data = getTable("people");
		   
		   ?>
		   <input type='hidden' name='update_technician_details'>
		   <select class="form-control select2 select2-hidden-accessible technician_value" onchange="techni(<?php echo $single['id'];?>,this.value)"id="technician_value" name="technician_value" style="width: 100%;" tabindex="-1" aria-hidden="true">
								   <option value=''>Select Technician</option>
								   <?php foreach ($technician_data as $technician) {
									
									if($technician['role'] == 'technician'){
								  
								   echo "<option value='".$technician['id']."'"; if($technician_name ==$technician['id']) echo " selected"; echo ">".$technician['name']."</option>";  } }
								   ?>
								   </select>
								   
								   <?php 
								   
								   $emailval=$technician['email'];
								   $mobile =$technician['mobile'];
		   
								   ?>
								   
			   <input type='hidden' name='tech_mobile_data' id='tech_mobile_data' value="<?php echo $mobile; ?>">
			   <input type='hidden' name='tech_mailid_data'  id='tech_mailid_data'value="<?php echo $emailval ;?>">
								   <input type='hidden' name='contractid'  value='<?php echo $single['id'];?>'>
								   <input type='hidden' name='routeid'  value='<?php echo $client['id']; ?>'>
								   <input type="submit" class="submitbutton" value="Update">
								   
								   </form>
		   
		   </div> </div></span> <span title="Qrcode " class="btnmb1 limitvv qr-modal-ticket"
		   data-contract-id="<?php echo $single['contractno']; ?>">
		   <span class="limit_icnf rrdefv2 " class="qr-modal-ticket"><i
				   class="fa fa-qrcode" aria-hidden="true"></i></span>
		   </span>	</div></div></div>
						   </div>
										</div>
											</div>
							<?php
							}						
						   }
							  ?>
							
								</div>	
			
							</div>	
								
							<!-- /.tab-pane -->
							
							<div class="tab-pane <?php if ($section == "invoice" || $_GET['tab'] == "invoice") echo 'active'; ?>" id="tab-invoice">
								<div class="row">
									
											<div class="col-md-2 col-xs-6" style="cursor: pointer;" id="viewAllInvoiceButtonsm">
											<span style="font-size: calc(46% + 12px);color: #238C00;">
												<span class="badge" style="background: #238C00;border-radius: 20%; font-size: 15px;padding: 6px 9px;">
													<?php echo countTableFiltered("invoice","clintid",$_GET['id']); ?>
												</span>
												<span style="color:#238C00">View All Invoice</span>
											</span>
										</div>
										<div class="col-md-2 col-xs-6" style="cursor: pointer;" id="unpaid_invoice">
											<span style="font-size: calc(46% + 12px);color: red;"><span class="badge badge-danger" style="background: red;border-radius: 20%; font-size: 15px;padding: 6px 9px;"><?php echo countwithcondition('invoice','balance','>','0','clintid','=',$_GET['id']); ?></span> Invoice to pay</span>
										</div>
										<div class="col-md-2 col-xs-6" style="cursor: pointer;" id="view_pending_tax_filesm">
											<span style="font-size: calc(46% + 9px);color: #3c8dbc;">
												<span class="badge badge-danger" style="background: #3c8dbc;border-radius: 20%; font-size: 15px;padding: 6px 9px;">
													<?php echo countwithconditiontextfile('invoice','clintid','=',$_GET['id']); ?></span> Tax File (2307) to Add</span>
										  
										</div>
										<!-- <div class="col-md-2 col-xs-6">
											 <span class="badge badge-danger"style="background: #000000;border-radius: 20%; font-size: 19px;padding: 4px 9px;">₱
                                    		</span>
											<span class="t-label" style="color: #646473; font-size: calc(40% + 13px); padding-left: 0px !important;">
												Balace to receive:
											</span>
											<span class="t-number autoNumeric animated-number" style="color: red;font-size: calc(40% + 13px);">
												<?php echo number_format(getTotalAmount('invoice','balance','clintid',$_GET['id']));?>
											</span>
										</div> -->

										<div class="col-md-2 col-xs-6" style="cursor: pointer;" id="view_follow_up">
	                                       <?php
	                                            $host = $_SERVER['HTTP_HOST'];
	                                            $host_upper = strtoupper($host);
	                                            $path = rtrim(dirname($_SERVER['PHP_SELF']), '/\\');
	                                            $baseurl = "http://" . $host . $path . "/";
	                                            $targetdir = $baseurl . DIRECTORY_SEPARATOR . "uploads" . DIRECTORY_SEPARATOR . "invoice" . DIRECTORY_SEPARATOR . 'To-follow-up.gif';
	                                        ?>
	                                        <span style="font-size: calc(46% + 16px);color: #3c8dbc;"><span
	                                                class="badge badge-danger"
	                                                style="background: #FF7F00;border-radius: 20%; font-size: 15px;padding: 6px 9px;">
	                                                <?php echo counttofollow('invoice','clintid','=',$_GET['id']); ?>
	                                            </span><img src="<?php echo $targetdir; ?>" alt="To Follow Up" style="width: 91px;height: auto;"></span>

	                                    </div>


										<div class="col-md-2 col-xs-6">
											<span class="t-label2" style="font-size: calc(40% + 13px);padding-left: 0px !important;">Total Paid:</span>
										<span class="t-number autoNumeric animated-number" style="font-size: calc(40% + 13px);"><?php echo number_format(getTotalAmount('invoice','paid','clintid',$_GET['id']));?></span>
									
									</div>
									
									<div class="col-md-2 col-xs-12">
										<?php
										 $m = $client['for_the_month'] == 0 ? '1' : $client['for_the_month'];
											echo "<a class='btn btn-success btn-sm' style='width:49%' target='_blank' href='?route=pdf/issue_invoice&clientid=".$client['id']."&month=".$m."'>Print Invoice</a>";
										?>	
											<a  style='width:49%' class="btn btn-success btn-sm" href="?route=clients/invoice&id=<?php echo $client['id']; ?>">Issue Invoice</a>
										</div>
								</div>
								
								<div class="clearfix"></div><br>
								<div class="table-responsive" id="invoiceTable">

									<div class="AllinvoiceTableContainer table-responsive">
										<table id="dataTablesFullDesc" class="table table-striped table-hover">
										<thead>
											<tr>
												<th class="text-center" style="text-wrap: nowrap;">Date</th>
												<th title="Invoice Reference No">Ref No</th>
												<th class="text-center" title="Actual Invoice Number">
													 INV
													 <i class="fa fa-info-circle" aria-hidden="true" style="margin-left: 5px;"></i>
												</th>
												<th class="text-center" title="Invoice Amount">AMT<i class="fa fa-info-circle" aria-hidden="true" style="margin-left: 5px;"></i></th>
												<th class="text-center">Invoice</th>
												<th class="text-center">Paid Amount</th>
												<th class="text-center">OR File</th>
												<th class="text-center" title="2307 Withholding Tax File">Tax</th>
												<th class="text-center" title="Invoice Remaining Balance">Bal</th>
												<th class="text-center">Ref No</th>
												<th class="text-center">Remarks</th>
												<th>Paid</th>
												<th>Clear</th>
												<th class="text-center">Action</th>
											</tr>
										</thead>
										<tbody>
											<?php foreach ($invoice as $invoice_item) { ?>
												<tr>
													<td style="text-wrap: nowrap;"><?php echo date('Y - m - d', strtotime($invoice_item['date'])); ?></td>
													<td style="padding: 0px 13px !important;"><?php echo $invoice_item['ref_no']; ?></td>
													<td class="text-left"><?php echo $invoice_item['invoiceno']; ?></td>
													<td class="text-right"><?php echo number_format($invoice_item['amount'], 0, '.', ','); ?></td>

													<td class="text-right">
														<?php
															$email_history = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "all");
															$countSentMail = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'all');
													
															if ($invoice_item['attachment'] != "" AND $invoice_item['cleared'] != 1) {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																			<span class='hoverfile'>";
																if (!empty($email_history)) {
																	foreach ($email_history as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																}
																echo "      </span>
																		</span>
																	</a>
																	&nbsp;";
															} else {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																				<span class='hoverfile'>";
																	if (!empty($email_history)) {
																		foreach ($email_history as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;";
																}
																
															}
													
															if ($invoice_item['cleared'] != 1) {
																echo "<a href='#' onclick=\"showM('ajax.php?modal=clientinvoiceTemplate&id=8&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
															}
													
															echo "&nbsp;&nbsp;<a href='javascript:void(0);' onClick=\"window.open('?route=invoiceTPdf&id={$client['id']}&invoice_id={$invoice_item['id']}', '_blank')\"><i class='fa fa-file-pdf-o'></i></a>&nbsp;&nbsp;";
													
															if ($invoice_item['attachment'] != "") {
																echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['attachment'] . "'><i class='fa fa-picture-o' aria-hidden='true'></i></i><span class='hovertextfile'>" . $invoice_item['attachment'] . "</span></a><br>";
															} else {
																echo "<br>";
															}
														?>
													</td>
													


													<td class="text-right">
														<?php 
														$email_history_paid = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "paid");
														$countSentMailpaidfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'paid');
														$paid_amount =  number_format($invoice_item['paid'], 0, '.', ',');
													
														if ($invoice_item['cleared'] != 1 && $invoice_item['paid_file'] != "") {
															echo "<a href=''>
																	<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																		<span class='hoverfile'>";
															if (!empty($email_history_paid)) {
																foreach ($email_history_paid as $record) {
																	echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																}
															}
															echo "</span>
																</span>
															</a>&nbsp;&nbsp;";
														}
													
														if ($invoice_item['paid_file'] != "") {
															if ($invoice_item['cleared'] != 1) {
																echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
															}
													
															echo "$paid_amount&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['paid_file'] . "'><i class='fa fa-picture-o' style='color: #F97C00;' aria-hidden='true'></i><span class='hovertextfile'>" . $invoice_item['paid_file'] . "</span></a>&nbsp;&nbsp;";
														} else {
															if ($invoice_item['cleared'] != 1) {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																			<span class='hoverfile'>";
																if (!empty($email_history_paid)) {
																	foreach ($email_history_paid as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																}
																echo "</span>
																	</span>
																</a>&nbsp;&nbsp;";
															}
													
															if ($invoice_item['cleared'] != 1) {
																echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
															}
													
															echo "$paid_amount";
														}
														?>
													</td>
													
													
													<td class="text-right">
														<?php
														$invo_or = "";
														$email_history_orfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "orfile");
														$countSentMailorfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'orfile');
													
														if ($invoice_item['cleared'] != 1) {
															if (!empty($email_history_orfile)) {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "
																			<span class='hoverfile'>";
																foreach ($email_history_orfile as $record) {
																	echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																}
																echo "</span>
																	</span>
																</a>&nbsp;";
															} else {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "</span>
																	</a>&nbsp;";
															}
														}
													
														if ($invoice_item['or_file'] != "") {
															if ($invoice_item['cleared'] != 1) {
																echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
															}
													
															echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['or_file'] . "'><i style='color: #238C00;' class='fa fa-picture-o'></i><span class='hovertextfile'>" . $invoice_item['or_file'] . "</span></a><br>";
														} else {
															if ($invoice_item['cleared'] != 1 && empty($email_history_orfile)) {
																echo "";
															}
													
															if ($invoice_item['cleared'] != 1) {
																echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
															}
													
															echo "<br>";
														}
														?>
													</td>
													
													
													<td class="text-right">
														<?php
														$email_history_taxfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "taxfile");
														$countSentMailTaxFile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'taxfile');
													
														if ($invoice_item['cleared'] != 1 && !empty($email_history_taxfile)) {
															echo "<a href=''>
																	<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailTaxFile . "
																		<span class='hoverfile'>";
															foreach ($email_history_taxfile as $record) {
																echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
															}
															echo "</span>
																</span>
															</a>&nbsp;&nbsp;";
														}
													
														if (!empty($invoice_item['tax_file_2307'])) {
															if ($invoice_item['cleared'] != 1) {
																echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
															}
													
															echo $invoice_item['tax_amount'] . "&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicetaxfile=" . $invoice_item['tax_file_2307'] . "'><i style='color: #7F00FF;' class='fa fa-picture-o'></i><span class='hovertextfile'>" . $invoice_item['tax_file_2307'] . "</span></a>&nbsp;&nbsp;";
														} else {
															if ($invoice_item['cleared'] != 1 && empty($email_history_taxfile)) {
																echo "";
															}
													
															if ($invoice_item['cleared'] != 1) {
																echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
															}
													
															echo $invoice_item['tax_amount'];
														}
														?>
													</td>
													
													

													<td class="text-right"><?php echo number_format($invoice_item['balance'], 0, '.', ','); ?></td>

									
													<td class="text-left">
														<?php
														if ($invoice_item['payment_ref_no']) {
															echo "<span>" . $invoice_item['payment_ref_no'] . "</span>&nbsp;/&nbsp;&nbsp;";
														}
														if ($invoice_item['payment_method']) {
															if(is_numeric($invoice_item['payment_method'])){
																$payment_method = get_payment_method_name($invoice_item['payment_method']);
																echo "<span style='color:red;'>" . $payment_method . "</span>&nbsp;/&nbsp;&nbsp;";
															}else{
																echo "<span style='color:red;'>" . $invoice_item['payment_method'] . "</span>&nbsp;/&nbsp;&nbsp;";
															}

														}
														if ($invoice_item['ornumber']) {
															echo "<span>" . $invoice_item['ornumber'] . "</span>&nbsp;&nbsp;";
														}
														?>
													</td>
													
									
													
													<td class="text-left"><?php echo $invoice_item['remark']; ?></td>

													<td>
															<?php if($invoice_item['balance'] > 0): ?>
															<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
															<?php else: ?>
															<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
															<?php endif; ?>
													</td>

													<td>
														<?php if($invoice_item['cleared'] == 1): ?>
																<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
															<?php else: ?>
																<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
															<?php endif; ?>
													</td>

									
													<td>
														<div>
															<a href="?route=clients/editinvoice&id=<?php echo $invoice_item['id']; ?>"><i class='fa fa-edit'></i></a>&nbsp;
															<a href='#' onClick='showM("ajax.php?modal=invoiceDelete&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $invoice_item['id']; ?>&section=invoice");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>&nbsp;
															
															
														</div>
													</td>
												</tr>
											<?php } ?>
										</tbody>
										</table>
									</div>

									<div class="unpaidTableContainer" style="display: none;">
										<table id="dataTablesFullDesc" class="table table-responsive table-striped table-hover">
											<thead>
												<tr>
													<th class="text-center">Date</th>
													<th>For</th>
													<th class="text-center">Invoice No.</th>
													<th class="text-center">INV Amt</th>
													<th class="text-center">Invoice</th>
													<th class="text-center">Paid Amount</th>
													<th class="text-center">OR File</th>
													<th class="text-center">Tax (2307) File</th>
													<th class="text-center">Balance</th>
													<th class="text-center">Ref No</th>
													<th class="text-center">Remarks</th>
													<th>Paid</th>
													<th>Clear</th>
													<th class="text-center">Action</th>
											</tr>
											</thead>
											<tbody>
												<?php foreach ($unpaidinvoice as $invoice_item) { ?>
													<tr>
														<td ><?php echo date('Y - m - d', strtotime($invoice_item['date'])); ?></td>
														<td style="padding: 0px 13px !important;"><?php echo $invoice_item['month']; ?></td>
														<td class="text-left"><?php echo $invoice_item['invoiceno']; ?></td>
	
														<td class="text-right"><?php echo number_format($invoice_item['amount'], 0, '.', ','); ?></td>
	
										
														<td class="text-right">
															<?php  
																$email_history = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "all");
																$countSentMail = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'all');
														
																if ($invoice_item['attachment'] != "" AND $invoice_item['cleared'] != 1) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																				<span class='hoverfile'>";
																	if (!empty($email_history)) {
																		foreach ($email_history as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "      </span>
																			</span>
																		</a>
																		&nbsp;";
																} else {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																					<span class='hoverfile'>";
																		if (!empty($email_history)) {
																			foreach ($email_history as $record) {
																				echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																			}
																		}
																		echo "</span>
																			</span>
																		</a>&nbsp;";
																	}
																	
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientinvoiceTemplate&id=8&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																}
														
																echo "&nbsp;&nbsp;<a href='javascript:void(0);' onClick=\"window.open('?route=invoiceTPdf&id={$client['id']}&invoice_id={$invoice_item['id']}', '_blank')\"><i class='fa fa-file-pdf-o'></i></a>&nbsp;&nbsp;";
														
																if ($invoice_item['attachment'] != "") {
																	echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['attachment'] . "'><i class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['attachment'] . "</span></a><br>";
																} else {
																	echo "<br>";
																}
															?>
														</td>
														
	
	
														<td class="text-right">
															<?php 
															$email_history_paid = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "paid");
															$countSentMailpaidfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'paid');
															$paid_amount =  number_format($invoice_item['paid'], 0, '.', ',');
														
															if ($invoice_item['cleared'] != 1 && $invoice_item['paid_file'] != "") {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																			<span class='hoverfile'>";
																if (!empty($email_history_paid)) {
																	foreach ($email_history_paid as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																}
																echo "</span>
																	</span>
																</a>&nbsp;&nbsp;";
															}
														
															if ($invoice_item['paid_file'] != "") {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "$paid_amount&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['paid_file'] . "'><i style='color: #F97C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['paid_file'] . "</span></a>&nbsp;&nbsp;";
															} else {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																				<span class='hoverfile'>";
																	if (!empty($email_history_paid)) {
																		foreach ($email_history_paid as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;&nbsp;";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "$paid_amount";
															}
															?>
														</td>
														
														
														<td class="text-right">
															<?php
															$invo_or = "";
															$email_history_orfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "orfile");
															$countSentMailorfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'orfile');
														
															if ($invoice_item['cleared'] != 1) {
																if (!empty($email_history_orfile)) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "
																				<span class='hoverfile'>";
																	foreach ($email_history_orfile as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;";
																} else {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "</span>
																		</a>&nbsp;";
																}
															}
														
															if ($invoice_item['or_file'] != "") {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['or_file'] . "'><i style='color: #238C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['or_file'] . "</span></a><br>";
															} else {
																if ($invoice_item['cleared'] != 1 && empty($email_history_orfile)) {
																	echo "";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																}
														
																echo "<br>";
															}
															?>
														</td>
														
														
														<td class="text-right">
															<?php
															$email_history_taxfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "taxfile");
															$countSentMailTaxFile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'taxfile');
														
															if ($invoice_item['cleared'] != 1 && !empty($email_history_taxfile)) {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailTaxFile . "
																			<span class='hoverfile'>";
																foreach ($email_history_taxfile as $record) {
																	echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																}
																echo "</span>
																	</span>
																</a>&nbsp;&nbsp;";
															}
														
															if (!empty($invoice_item['tax_file_2307'])) {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo $invoice_item['tax_amount'] . "&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicetaxfile=" . $invoice_item['tax_file_2307'] . "'><i style='color: #7F00FF;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['tax_file_2307'] . "</span></a>&nbsp;&nbsp;";
															} else {
																if ($invoice_item['cleared'] != 1 && empty($email_history_taxfile)) {
																	echo "<br>";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo $invoice_item['tax_amount'];
															}
															?>
														</td>
														
														
	
														<td class="text-right"><?php echo number_format($invoice_item['balance'], 0, '.', ','); ?></td>
	
										
														<td class="text-left">
															<?php
															if ($invoice_item['payment_ref_no']) {
																echo "<span>" . $invoice_item['payment_ref_no'] . "</span>&nbsp;/&nbsp;&nbsp;";
															}
															if ($invoice_item['payment_method']) {
																echo "<span style='color:red;'>" . $invoice_item['payment_method'] . "</span>&nbsp;/&nbsp;&nbsp;";
															}
															if ($invoice_item['ornumber']) {
																echo "<span>" . $invoice_item['ornumber'] . "</span>&nbsp;&nbsp;";
															}
															?>
														</td>
														
										
														
														<td class="text-left"><?php echo $invoice_item['remark']; ?></td>
	
														<td>
																<?php if($invoice_item['balance'] > 0): ?>
																<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																<?php else: ?>
																<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																<?php endif; ?>
														</td>
	
														<td>
															<?php if($invoice_item['cleared'] == 1): ?>
																	<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																<?php else: ?>
																	<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																<?php endif; ?>
														</td>
	
										
														<td>
															<div>
																<a href="?route=clients/editinvoice&id=<?php echo $invoice_item['id']; ?>"><i class='fa fa-edit'></i></a>&nbsp;
																<a href='#' onClick='showM("ajax.php?modal=invoiceDelete&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $invoice_item['id']; ?>&section=invoice");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>&nbsp;
																
																
															</div>
														</td>
													</tr>
													
												<?php } ?>
											</tbody>
										</table>
									</div>

									<div class="pendingTableContainer" style="display: none;">
										<table id="dataTablesFullDesc" class="table table-responsive table-striped table-hover">
											<thead>
											<tr>
												<th class="text-center">Date</th>
												<th>For</th>
												<th class="text-center">Invoice No.</th>
												<th class="text-center">INV Amt</th>
												<th class="text-center">Invoice</th>
												<th class="text-center">Paid Amount</th>
												<th class="text-center">OR File</th>
												<th class="text-center">Tax (2307) File</th>
												<th class="text-center">Balance</th>
												<th class="text-center">Ref No</th>
												<th class="text-center">Remarks</th>
												<th>Paid</th>
												<th>Clear</th>
												<th class="text-center">Action</th>
											</tr>
											</thead>
											<tbody>
												<?php foreach ($pendinginvoice as $invoice_item) { ?>
													<tr>
														<td ><?php echo date('Y - m - d', strtotime($invoice_item['date'])); ?></td>
														<td style="padding: 0px 13px !important;"><?php echo $invoice_item['month']; ?></td>
														<td class="text-left"><?php echo $invoice_item['invoiceno']; ?></td>
	
														<td class="text-right"><?php echo number_format($invoice_item['amount'], 0, '.', ','); ?></td>
	
										
														<td class="text-right">
															<?php  
																$email_history = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "all");
																$countSentMail = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'all');
														
																if ($invoice_item['attachment'] != "" AND $invoice_item['cleared'] != 1) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																				<span class='hoverfile'>";
																	if (!empty($email_history)) {
																		foreach ($email_history as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "      </span>
																			</span>
																		</a>
																		&nbsp;";
																} else {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																					<span class='hoverfile'>";
																		if (!empty($email_history)) {
																			foreach ($email_history as $record) {
																				echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																			}
																		}
																		echo "</span>
																			</span>
																		</a>&nbsp;";
																	}
																	
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientinvoiceTemplate&id=8&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																}
														
																echo "&nbsp;&nbsp;<a href='javascript:void(0);' onClick=\"window.open('?route=invoiceTPdf&id={$client['id']}&invoice_id={$invoice_item['id']}', '_blank')\"><i class='fa fa-file-pdf-o'></i></a>&nbsp;&nbsp;";
														
																if ($invoice_item['attachment'] != "") {
																	echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['attachment'] . "'><i class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['attachment'] . "</span></a><br>";
																} else {
																	echo "<br>";
																}
															?>
														</td>
														
	
	
														<td class="text-right">
															<?php 
															$email_history_paid = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "paid");
															$countSentMailpaidfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'paid');
															$paid_amount =  number_format($invoice_item['paid'], 0, '.', ',');
														
															if ($invoice_item['cleared'] != 1 && $invoice_item['paid_file'] != "") {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																			<span class='hoverfile'>";
																if (!empty($email_history_paid)) {
																	foreach ($email_history_paid as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																}
																echo "</span>
																	</span>
																</a>&nbsp;&nbsp;";
															}
														
															if ($invoice_item['paid_file'] != "") {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "$paid_amount&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['paid_file'] . "'><i style='color: #F97C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['paid_file'] . "</span></a>&nbsp;&nbsp;";
															} else {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																				<span class='hoverfile'>";
																	if (!empty($email_history_paid)) {
																		foreach ($email_history_paid as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;&nbsp;";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "$paid_amount";
															}
															?>
														</td>
														
														
														<td class="text-right">
															<?php
															$invo_or = "";
															$email_history_orfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "orfile");
															$countSentMailorfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'orfile');
														
															if ($invoice_item['cleared'] != 1) {
																if (!empty($email_history_orfile)) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "
																				<span class='hoverfile'>";
																	foreach ($email_history_orfile as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;";
																} else {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "</span>
																		</a>&nbsp;";
																}
															}
														
															if ($invoice_item['or_file'] != "") {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['or_file'] . "'><i style='color: #238C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['or_file'] . "</span></a><br>";
															} else {
																if ($invoice_item['cleared'] != 1 && empty($email_history_orfile)) {
																	echo "";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																}
														
																echo "<br>";
															}
															?>
														</td>
														
														
														<td class="text-right">
															<?php
															$email_history_taxfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "taxfile");
															$countSentMailTaxFile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'taxfile');
														
															if ($invoice_item['cleared'] != 1 && !empty($email_history_taxfile)) {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailTaxFile . "
																			<span class='hoverfile'>";
																foreach ($email_history_taxfile as $record) {
																	echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																}
																echo "</span>
																	</span>
																</a>&nbsp;&nbsp;";
															}
														
															if (!empty($invoice_item['tax_file_2307'])) {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo $invoice_item['tax_amount'] . "&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicetaxfile=" . $invoice_item['tax_file_2307'] . "'><i style='color: #7F00FF;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['tax_file_2307'] . "</span></a>&nbsp;&nbsp;";
															} else {
																if ($invoice_item['cleared'] != 1 && empty($email_history_taxfile)) {
																	echo "<br>";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo $invoice_item['tax_amount'];
															}
															?>
														</td>
														
														
	
														<td class="text-right"><?php echo number_format($invoice_item['balance'], 0, '.', ','); ?></td>
	
										
														<td class="text-left">
															<?php
															if ($invoice_item['payment_ref_no']) {
																echo "<span>" . $invoice_item['payment_ref_no'] . "</span>&nbsp;/&nbsp;&nbsp;";
															}
															if ($invoice_item['payment_method']) {
																echo "<span style='color:red;'>" . $invoice_item['payment_method'] . "</span>&nbsp;/&nbsp;&nbsp;";
															}
															if ($invoice_item['ornumber']) {
																echo "<span>" . $invoice_item['ornumber'] . "</span>&nbsp;&nbsp;";
															}
															?>
														</td>
														
										
														
														<td class="text-left"><?php echo $invoice_item['remark']; ?></td>
	
														<td>
																<?php if($invoice_item['balance'] > 0): ?>
																<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																<?php else: ?>
																<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																<?php endif; ?>
														</td>
	
														<td>
															<?php if($invoice_item['cleared'] == 1): ?>
																	<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																<?php else: ?>
																	<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																<?php endif; ?>
														</td>
	
										
														<td>
															<div>
																<a href="?route=clients/editinvoice&id=<?php echo $invoice_item['id']; ?>"><i class='fa fa-edit'></i></a>&nbsp;
																<a href='#' onClick='showM("ajax.php?modal=invoiceDelete&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $invoice_item['id']; ?>&section=invoice");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>&nbsp;
																
																
															</div>
														</td>
													</tr>
												<?php } ?>
											</tbody>
										</table>
									</div>

									<div class="tofollowTableContainer" style="display: none;">
										<table id="dataTablesFullDesc" class="table table-responsive table-striped table-hover">
											<thead>
											<tr>
												<th class="text-center">Date</th>
												<th>For</th>
												<th class="text-center">Invoice No.</th>
												<th class="text-center">INV Amt</th>
												<th class="text-center">Invoice</th>
												<th class="text-center">Paid Amount</th>
												<th class="text-center">OR File</th>
												<th class="text-center">Tax (2307) File</th>
												<th class="text-center">Balance</th>
												<th class="text-center">Ref No</th>
												<th class="text-center">Remarks</th>
												<th>Paid</th>
												<th>Clear</th>
												<th class="text-center">Action</th>
											</tr>
											</thead>
											<tbody>
												<?php foreach ($getToFollowRecords as $invoice_item) { ?>
													<tr>
														<td ><?php echo date('Y - m - d', strtotime($invoice_item['date'])); ?></td>
														<td style="padding: 0px 13px !important;"><?php echo $invoice_item['month']; ?></td>
														<td class="text-left"><?php echo $invoice_item['invoiceno']; ?></td>
	
														<td class="text-right"><?php echo number_format($invoice_item['amount'], 0, '.', ','); ?></td>
	
										
														<td class="text-right">
															<?php  
																$email_history = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "all");
																$countSentMail = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'all');
														
																if ($invoice_item['attachment'] != "" AND $invoice_item['cleared'] != 1) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																				<span class='hoverfile'>";
																	if (!empty($email_history)) {
																		foreach ($email_history as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "      </span>
																			</span>
																		</a>
																		&nbsp;";
																} else {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																					<span class='hoverfile'>";
																		if (!empty($email_history)) {
																			foreach ($email_history as $record) {
																				echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																			}
																		}
																		echo "</span>
																			</span>
																		</a>&nbsp;";
																	}
																	
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientinvoiceTemplate&id=8&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																}
														
																echo "&nbsp;&nbsp;<a href='javascript:void(0);' onClick=\"window.open('?route=invoiceTPdf&id={$client['id']}&invoice_id={$invoice_item['id']}', '_blank')\"><i class='fa fa-file-pdf-o'></i></a>&nbsp;&nbsp;";
														
																if ($invoice_item['attachment'] != "") {
																	echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['attachment'] . "'><i class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['attachment'] . "</span></a><br>";
																} else {
																	echo "<br>";
																}
															?>
														</td>
														
	
	
														<td class="text-right">
															<?php 
															$email_history_paid = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "paid");
															$countSentMailpaidfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'paid');
															$paid_amount =  number_format($invoice_item['paid'], 0, '.', ',');
														
															if ($invoice_item['cleared'] != 1 && $invoice_item['paid_file'] != "") {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																			<span class='hoverfile'>";
																if (!empty($email_history_paid)) {
																	foreach ($email_history_paid as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																}
																echo "</span>
																	</span>
																</a>&nbsp;&nbsp;";
															}
														
															if ($invoice_item['paid_file'] != "") {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "$paid_amount&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['paid_file'] . "'><i style='color: #F97C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['paid_file'] . "</span></a>&nbsp;&nbsp;";
															} else {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																				<span class='hoverfile'>";
																	if (!empty($email_history_paid)) {
																		foreach ($email_history_paid as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;&nbsp;";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "$paid_amount";
															}
															?>
														</td>
														
														
														<td class="text-right">
															<?php
															$invo_or = "";
															$email_history_orfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "orfile");
															$countSentMailorfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'orfile');
														
															if ($invoice_item['cleared'] != 1) {
																if (!empty($email_history_orfile)) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "
																				<span class='hoverfile'>";
																	foreach ($email_history_orfile as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;";
																} else {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "</span>
																		</a>&nbsp;";
																}
															}
														
															if ($invoice_item['or_file'] != "") {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['or_file'] . "'><i style='color: #238C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['or_file'] . "</span></a><br>";
															} else {
																if ($invoice_item['cleared'] != 1 && empty($email_history_orfile)) {
																	echo "";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																}
														
																echo "<br>";
															}
															?>
														</td>
														
														
														<td class="text-right">
															<?php
															$email_history_taxfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "taxfile");
															$countSentMailTaxFile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'taxfile');
														
															if ($invoice_item['cleared'] != 1 && !empty($email_history_taxfile)) {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailTaxFile . "
																			<span class='hoverfile'>";
																foreach ($email_history_taxfile as $record) {
																	echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																}
																echo "</span>
																	</span>
																</a>&nbsp;&nbsp;";
															}
														
															if (!empty($invoice_item['tax_file_2307'])) {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo $invoice_item['tax_amount'] . "&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicetaxfile=" . $invoice_item['tax_file_2307'] . "'><i style='color: #7F00FF;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['tax_file_2307'] . "</span></a>&nbsp;&nbsp;";
															} else {
																if ($invoice_item['cleared'] != 1 && empty($email_history_taxfile)) {
																	echo "<br>";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo $invoice_item['tax_amount'];
															}
															?>
														</td>
														
														
	
														<td class="text-right"><?php echo number_format($invoice_item['balance'], 0, '.', ','); ?></td>
	
										
														<td class="text-left">
															<?php
															if ($invoice_item['payment_ref_no']) {
																echo "<span>" . $invoice_item['payment_ref_no'] . "</span>&nbsp;/&nbsp;&nbsp;";
															}
															if ($invoice_item['payment_method']) {
																echo "<span style='color:red;'>" . $invoice_item['payment_method'] . "</span>&nbsp;/&nbsp;&nbsp;";
															}
															if ($invoice_item['ornumber']) {
																echo "<span>" . $invoice_item['ornumber'] . "</span>&nbsp;&nbsp;";
															}
															?>
														</td>
														
										
														
														<td class="text-left"><?php echo $invoice_item['remark']; ?></td>
	
														<td>
																<?php if($invoice_item['balance'] > 0): ?>
																<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																<?php else: ?>
																<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																<?php endif; ?>
														</td>
	
														<td>
															<?php if($invoice_item['cleared'] == 1): ?>
																	<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																<?php else: ?>
																	<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																<?php endif; ?>
														</td>
										
														<td>
															<div>
																<a href="?route=clients/editinvoice&id=<?php echo $invoice_item['id']; ?>"><i class='fa fa-edit'></i></a>&nbsp;
																<a href='#' onClick='showM("ajax.php?modal=invoiceDelete&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $invoice_item['id']; ?>&section=invoice");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>&nbsp;
															</div>
														</td>
													</tr>
												<?php } ?>
											</tbody>
										</table>
									</div>

								</div>
							</div>
							<!-- /.tab-pane -->
							<!--/.tab-adepartment-->
							<div class ="tab-pane <?php if($section=="emailnew") echo 'active';?>" id = 'tab-email' style="">
							
							<table id="dataTablesFull4" class="table table-striped table-hover">
										<thead>
											<tr>
												<th><input type='checkbox' name='selectall' id='sall' value='selall'></th>
												<th>Name</th>
												
												<th>Email</th>
												
											</tr>
										</thead>
										<tbody>
											<?php
											//echo "<pre>";
											//print_r($users);
											foreach ($users as $user) {
											echo "<tr>";
											echo "<td><input type='checkbox' name='uid' id='uid' value='".$user['email']."'></td>";
											echo "<td>".$user['name']."</td>";
											
											echo "<td>".$user['email']."</td>";
										   
											echo "</tr>";
											}
											?>
										</tbody>
									</table>
									<form name="" method="post" enctype="multipart/form-data">
									<div class="form-group">
										<label for="subject">Subject *</label>
										<input type="text" class="form-control" id="subject" name="subject" value="<?php echo $template['subject']; ?>" required>
									</div>
									 <div class="form-group">
										<label for="message" class="control-label">Message</label>
										<textarea class="form-control summernote2" id="message" name="message"><?php echo $template['message']; ?></textarea>
									</div>
									 <div class="form-group">
										<label for="message" class="control-label">Attachment</label>
										<input type="file" name="attachfile">
									</div>
									<input type="hidden" name="send_email_new_rprt" value ="send_email_new_rprt">
									<input type="hidden" name="u_email" id="u_email" value ="">
									<input type="hidden" name="route" id="route" value ="clients/manage">
									<input type="hidden" name="routeid" id="routeid" value ="<?php echo $_GET['id'];?>">
									<input type="hidden" name="section" id="section" value ="emailnew">
									<input type="submit" name="submit" value="Send">
									</form>
							</div>

							<div class="tab-pane <?php if($section=="usagereport") echo 'active';?>" id="tab-usagereport" style="">
								<div class="table-responsive">
								<table class="table table-bordered text-center">
									<thead>
										<tr>
											<th>Date</th>
											<th>Contract Information</th>
											<th>Department</th>
											<th>Unit</th>
											<th>Model</th>
											<th>A3 Color</th>
											<th>A3 Black</th>
											<th>A4 Color</th>
											<th>A4 Black</th>
											<th>File</th>
											<th>Remark</th>
											<th>Action</th>

										</tr>
									</thead>
									<tbody>
										<?php
										$usage_reports = getTableFiltered("usage_report", "clientid", $client['id'], "", "", "*", "id", "DESC");

										$host = $_SERVER['HTTP_HOST'];
										$host_upper = strtoupper($host);
										$path = rtrim(dirname($_SERVER['PHP_SELF']), '/\\');
										$baseurl = "http://" . $host . $path . "/";
										$targetdir = $baseurl . DIRECTORY_SEPARATOR . 'uploads' . DIRECTORY_SEPARATOR . "usage_report" . DIRECTORY_SEPARATOR;
									
										$departments = [];
										$serials = [];
									
										foreach ($usage_reports as $usage_report) {
											$departments[$usage_report['department']][] = $usage_report;
											$serials[$usage_report['serial']][] = $usage_report;
										}
									
										if (!empty($usage_reports)) {
											foreach ($departments as $department => $department_reports) {
												echo '<tr><th style="color: white;text-align: left;" class="col-lg-4 col-md-4 col-sm-4 half-color" colspan="12">' . strtoupper($department) . '</th></tr>';
									
												foreach ($serials as $serial => $serial_reports) {
													if (isset($serial_reports[0]) && $serial_reports[0]['department'] === $department) {
														echo '<tr><th style="color: #FF0000;text-align: left;" class="col-lg-4 col-md-4" colspan="12">' . $serial . '</th></tr>';
									
														// Loop through reports of the current department and serial
														foreach ($serial_reports as $usage_report) {
															$imagePath = $targetdir . $usage_report['image'];
									
															echo '<tr>';
															echo '<td>' . date('Y-m-d', strtotime($usage_report['date'])) . '</td>';
															echo '<td>' . $usage_report['serial'] . '</td>';
															echo '<td>' . $usage_report['department'] . '</td>';
									
															$modelname = getSingleValue("models", "name", $usage_report['asset_id']);
															$modelimage = getSingleValue("models", "image", $usage_report['asset_id']);
									
															echo '<td>';
									
															if (!empty($modelimage)) {
																// If $modelimage is not empty, display the image with specified height and width
																echo '<img style="height: 30px;" src="uploads/' . $modelimage . '" alt="Model Image">';
															}
									
															echo '</td>';
									
															echo '<td>' . $usage_report['modal_name'] . '</td>';
															echo '<td class="text-right">' . $usage_report['A3clr'] . '</td>';
															echo '<td class="text-right">' . $usage_report['A3blk'] . '</td>';
															echo '<td class="text-right">' . $usage_report['A4clr'] . '</td>';
															echo '<td class="text-right">' . $usage_report['A4blk'] . '</td>';

															if ($usage_report['image'] != "") {
																$usage_image = "<a class='onhoverfile' target='_blank' href='" . $imagePath . "'><i class='fa fa-file'></i><span class='hovertextfile'>" . $usage_report['image'] . "</span></a><br>";
															}
															
															echo "<td style='text-align: center;'>" . $usage_image . "</td>";

															echo "<td>" .$usage_report['remark'] . "</td>";
															
															if ($usage_report['usage_confimed'] == 1) {
																echo "<td ><button class='btn btn-primary'>Confirmed</button>&nbsp;&nbsp;<a title='".htmlspecialchars($client['client_memo'], ENT_QUOTES, 'UTF-8')."' href='#' onClick='showM(\"ajax.php?modal=EditUsagereport&reroute=clients&id=".$usage_report['id']."\"); return false;' class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
																	<a href='#' onClick='showM(\"ajax.php?modal=DeleteUsagereport&reroute=clients&id=".$usage_report['id']."&routeid=".$usage_report['clientid']."\"); return false;' class='btn-right text-red'><i class='fa fa-trash-o'></i></a></td>";
															} elseif($usage_report['usage_confimed'] == 0) {
															echo "<td><a title='".htmlspecialchars($client['client_memo'], ENT_QUOTES, 'UTF-8')."' href='#' onClick='showM(\"ajax.php?modal=EditUsagereport&reroute=clients&id=".$usage_report['id']."\"); return false;' class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
																<a href='#' onClick='showM(\"ajax.php?modal=DeleteUsagereport&reroute=clients&id=".$usage_report['id']."&routeid=".$usage_report['clientid']."\"); return false;' class='btn-right text-red'><i class='fa fa-trash-o'></i></a></td>";
															}
															
															echo '</tr>';
														}
													}
												}
											}
										}
										?>
									</tbody>
									
								</table>
							</div>
							</div>

							<div class="tab-pane <?php if($section=="actuallstatus") echo 'active';?>" id="tab-actuallstatus" style="">
								<div class="table-responsive">
								<table class="table table-bordered text-center">
									<thead>
										<tr>
											<th>Date</th>
											<th>Contract Information</th>
											<th>Department</th>
											<th>Unit</th>
											<th>Model</th>
											<th>Reported by</th>
											<th>File</th>
											<th>Remark</th>
											<th>Action</th>

										</tr>
									</thead>
									<tbody>
										<?php
										$actual_report = getTableFiltered("actual_report", "clientid", $client['id'], "", "", "*", "id", "DESC");
										//echo '<pre>';
										//print_r($actual_report);
										//die;

										$host = $_SERVER['HTTP_HOST'];
										$host_upper = strtoupper($host);
										$path = rtrim(dirname($_SERVER['PHP_SELF']), '/\\');
										$baseurl = "http://" . $host . $path . "/";
										$targetdir = $baseurl . DIRECTORY_SEPARATOR . 'uploads' . DIRECTORY_SEPARATOR . "actual_report" . DIRECTORY_SEPARATOR;
									
										$departments = [];
										$serials = [];
									
										foreach ($actual_report as $actual_report) {
											$departments[$actual_report['department']][] = $actual_report;
											$serials[$actual_report['serial']][] = $actual_report;
										}
									
										if (!empty($actual_report)) {
											foreach ($departments as $department => $department_reports) {
												echo '<tr><th style="color: white;text-align: left;" class="col-lg-4 col-md-4 col-sm-4 half-color" colspan="12">' . strtoupper($department) . '</th></tr>';

												foreach ($serials as $serial => $serial_reports) {
													if (isset($serial_reports[0]) && $serial_reports[0]['department'] === $department) {
														echo '<tr><th style="color: #FF0000;text-align: left;" class="col-lg-4 col-md-4" colspan="12">' . $serial . '</th></tr>';
									
														// Loop through reports of the current department and serial
														foreach ($serial_reports as $actual_report) {
															$imagePath = $targetdir . $actual_report['image'];
									
															echo '<tr>';
															echo '<td>' . date('Y-m-d', strtotime($actual_report['date'])) . '</td>';
															echo '<td>' . $actual_report['serial'] . '</td>';
															echo '<td>' . $actual_report['department'] . '</td>';
									
															$modelname = getSingleValue("models", "name", $actual_report['asset_id']);
															$modelimage = getSingleValue("models", "image", $actual_report['asset_id']);
										
															echo '<td>';
										
																if (!empty($modelimage)) {
																	// If $modelimage is not empty, display the image with specified height and width
																	echo '<img style="height: 30px;" src="uploads/' . $modelimage . '" alt="Model Image">';
																}
										
																echo '</td>';

															echo '<td>' . $actual_report['modal_name'] . '</td>';

															echo '<td>' . $actual_report['reported_by'] . '</td>';

															echo '<td>';
																if (!empty($actual_report['image'])) {
																	$large_image_url = 'uploads/actual_status/' . $actual_report['image'];
																	echo '<a href="#" onclick="openModal(\'' . $large_image_url . '\')">';
																	echo '<img style="height: 50px; cursor: pointer;" src="' . $large_image_url . '" alt="Click to enlarge">';
																	echo '</a>';
																}
															echo '</td>';

															echo "<td>" .$actual_report['remark'] . "</td>";
															
															if ($actual_report['actual_confimed'] == 1) {
																echo "<td ><button class='btn btn-primary'>Confirmed</button>&nbsp;&nbsp;<a title='".htmlspecialchars($client['client_memo'], ENT_QUOTES, 'UTF-8')."' href='#' onClick='showM(\"ajax.php?modal=EditmodelUsageEditactualstatus&reroute=clients&id=".$actual_report['id']."\"); return false;' class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
																	<a href='#' onClick='showM(\"ajax.php?modal=Deleteactuallstatus&reroute=clients&id=".$actual_report['id']."&routeid=".$actual_report['clientid']."\"); return false;' class='btn-right text-red'><i class='fa fa-trash-o'></i></a></td>";
															} elseif($actual_report['actual_confimed'] == 0) {
															echo "<td><a title='".htmlspecialchars($client['client_memo'], ENT_QUOTES, 'UTF-8')."' href='#' onClick='showM(\"ajax.php?modal=EditmodelUsageEditactualstatus&reroute=clients&id=".$actual_report['id']."\"); return false;' class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
																<a href='#' onClick='showM(\"ajax.php?modal=Deleteactuallstatus&reroute=clients&id=".$actual_report['id']."&routeid=".$actual_report['clientid']."\"); return false;' class='btn-right text-red'><i class='fa fa-trash-o'></i></a></td>";
															}
															
															echo '</tr>';
														}
													}
												}
											}
										}
										?>
									</tbody>
									
								</table>
							</div>
							</div>
							
							<div class ="tab-pane <?php if($section=="reportnew") echo 'active';?>" id = 'tab-report' style="">
							<form role="form" method="get" action="" target="_blank">
									<div class="form-group">
											<label for="startDate">Start Date</label>
											<div class="input-group">
												<input type="text" class="form-control datepicker-input " id="startDatee" name="startDate" required> <span class="input-group-addon"><i class="fa fa-calendar"></i></span> </div>
										</div>
										<div class="form-group">
											<label for="endDate">End Date</label>
											<div class="input-group">
												<input type="text" class="form-control datepicker-input" id="endDatee" name="endDate" required> <span class="input-group-addon"><i class="fa fa-calendar"></i></span> </div>
										</div>
										 <input type="hidden" name="report" value="timesheetSummary">
										<input type="hidden" name="forticket" value="ticket">
										<input type="hidden" name="clientid" value="<?php echo $client['id'];?>">
										<input type="hidden" name="route" value="reports/view">
									 <div class="box-footer">
				<button type="submit" class="btn btn-primary">Generate</button>
			</div>
									</form>
							
							</div>
						 <div class="tab-pane <?php if ($section =="adepartment") echo 'active'; ?>" id="tab-adepartment">
						  <?php 
						  echo "<span><div class=''>
							   <button class='btn btn-primary add_button '><a href='#' 
	onClick='showM(\"ajax.php?modal=departmentadd&section=adepartment&reroute=clients/manage&routeid=".$client['id']."\");return false'
	class='btn-right text-dark'><i class='fa fa-plus'></i>&nbsp; New Department</a></button></div></span>"; ?>
	
								 <div class="table-responsive">
								 
								
								 
									<table id="dataTablesFull4" class="table table-striped table-hover">
										<thead>
											<tr>
												<th>ID</th>
												<th>Department Name</th>
												<th>Person In charge </th>
												<th class="th_average">Average Printing</th>
												<th>Department Memo</th>
												<th class="text-right"></th>
											</tr>
										</thead>
										<tbody>
											<?php
											foreach ($department_a as $user) {
										echo "<tr>";
											echo "<td>".$user['id']."</td>";
											echo "<td>".$user['name']."</td>";
											echo "<td>".$user['person_In_charge']."</td>";
										   echo "<td class='avrege_print'>". $user['average_printing']."</td>";
										   echo "<td>". $user['department_memo']."</td>";
											echo "<td>
											<div class='pull-right'>
											<a href='#' 
	onClick='showM(\"ajax.php?modal=departmentedit&section=adepartment&reroute=clients/manage&routeid=".$client['id']."&id=".$user['id']."\");return false'
	class='btn-right text-dark'><i class='fa fa-edit'></i></a>&nbsp;
	  <a href='#' onClick='showM(\"ajax.php?modal=departmentdelete&section=adepartment&reroute=clients/manage&routeid=".$client['id']."&id=".$user['id']."\");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>
											</div>
											</td>";
											echo "</tr>";
											}
											?>
										</tbody>
									</table>
								</div>
							</div>
							
							<!--/.tab-adepartment-->
							
							 

							<div class="tab-pane <?php if ($section =="invoice1") echo 'active'; ?>" id="tab-invoice1">
								<!-- invoice 1 main row -->
								<div class="row">
									<!-- first row  -->
									 <!-- <div class="col-sm-12"> -->
										<!-- <div class="row">

											<div class="col-sm-2" id="viewAllInvoiceButtonsm_1">
												<span class="badge" style="background: #238C00;border-radius: 20%; font-size: 15px;padding: 6px 9px;">
													<?php echo countTableFiltered("invoice","clintid",$_GET['id']); ?>
												</span>
												<span style="color:#238C00; cursor: pointer;"> View All Invoice</span>
											</div>

											<div class="col-sm-2" id="unpaid_invoice_1">
												<span style="font-size: calc(46% + 12px);color: red; cursor: pointer;">
													<span class="badge badge-danger" style="background: red;border-radius: 20%; font-size: 15px;padding: 6px 9px;">
														<?php echo countwithcondition('invoice','balance','>','0','clintid','=',$_GET['id']); ?>
													</span>
													 Invoice to pay
												</span>
											</div>

											<div class="col-sm-2" id="view_pending_tax_filesm_1">
												<span style="font-size: calc(46% + 9px);color: #3c8dbc; cursor: pointer;">
													<span class="badge badge-danger" style="background: #3c8dbc;border-radius: 20%; font-size: 15px;padding: 6px 9px;">
														<?php echo countwithconditiontextfile('invoice','clintid','=',$_GET['id']); ?>
													</span>
													 Tax File (2307) to Add
												</span>
											</div>

											<div class="col-sm-2">
												<span class="badge badge-danger"style="background: #000000;border-radius: 20%; font-size: 19px;padding: 4px 9px;">₱ 
												</span>
												<span class="t-label" style="color: #646473; font-size: calc(40% + 13px); padding-left: 0px !important;">Balace to receive:</span>
												<span class="t-number autoNumeric animated-number" style="color: red;font-size: calc(40% + 13px);"><?php echo number_format(getTotalAmount('invoice','balance','clintid',$_GET['id']));?></span>
											</div>

											<div class="col-sm-2" id="view_follow_up_1">
												<?php
												$host = $_SERVER['HTTP_HOST'];
												$host_upper = strtoupper($host);
												$path = rtrim(dirname($_SERVER['PHP_SELF']), '/\\');
												$baseurl = "http://" . $host . $path . "/";
												$targetdir = $baseurl . DIRECTORY_SEPARATOR . "uploads" . DIRECTORY_SEPARATOR . "invoice" . DIRECTORY_SEPARATOR . 'To-follow-up.gif';
												?>
												<span style="font-size: calc(46% + 16px);color: #3c8dbc; cursor: pointer;">
													<span
													class="badge badge-danger"
													style="background: #FF7F00;border-radius: 20%; font-size: 15px;padding: 6px 9px;">
													<?php echo counttofollow('invoice','clintid','=',$_GET['id']); ?>
													</span>
													<img src="<?php echo $targetdir; ?>" alt="To Follow Up" style="width: 91px;height: auto;">
												</span>
											</div>

											<div class="col-sm-2">
												<span class="t-label2" style="font-size: calc(40% + 13px);padding-left: 0px !important;">
													Total Paid:
												</span>
												<span class="t-number autoNumeric animated-number" style="font-size: calc(40% + 13px);">
													<?php echo number_format(getTotalAmount('invoice','paid','clintid',$_GET['id']));?>
												</span><br>
												<button class="btn btn-danger btn-sm" style="margin-bottom: 5px; width: 100%;" id="process_payment_btn" data-clientid="<?php echo $client['id']; ?>">Receive Payment</button>
													<?php
													$m = $client['for_the_month'] == 0 ? '1' : $client['for_the_month'];
														echo "<a class='btn btn-success btn-sm' style='width:49%' target='_blank' href='?route=pdf/issue_invoice&clientid=".$client['id']."&month=".$m."'>Print Invoice</a>";
													?>	
												<a  style='width:49%' class="btn btn-success btn-sm" href="?route=clients/invoice&id=<?php echo $client['id']; ?>">Issue Invoice</a>
											</div>

										</div> -->
									 <!-- </div> -->
									 <!-- first row  -->
									  <!-- second row with table -->
									  <!-- <div class="clearfix"></div><br> -->
									 <div class="col-sm-12 table-responsive">

										<div class="AllinvoiceTableContainer_1 table-responsive">
											<table id="dataTablesFullDesc" class="table table-striped table-hover">
											<thead>
												<tr>
													<th class="text-center" style="text-wrap: nowrap;">Date</th>
													<th class="text-center" title="Applied Month">M</th>
													<th class="text-center" title="Checked Mark means Duplicated Invoice">D</th>
													<th title="Invoice Reference No">Ref No</th>
													<th class="text-center" title="Actual Invoice Number">
														 INV
														 <i class="fa fa-info-circle" aria-hidden="true" style="margin-left: 5px;"></i>
													</th>
													<th class="text-center" title="Invoice Amount">AMT<i class="fa fa-info-circle" aria-hidden="true" style="margin-left: 5px;"></i></th>
													<th class="text-center">Invoice</th>
													<th class="text-center">Paid Amount</th>
													<th class="text-center">OR File</th>
													<th class="text-center" title="2307 Withholding Tax File">Tax</th>
													<th class="text-center" title="Invoice Remaining Balance">Bal</th>
													<th class="text-center">Ref No</th>
													<th class="text-center">Remarks</th>
													<th>Paid</th>
													<th>Clear</th>
													<th class="text-center">Action</th>
												</tr>
											</thead>
											<tbody>
												<?php foreach ($invoice as $invoice_item) { 
													$is_duplicate = check_dup_invoice($invoice , $invoice_item['ref_no'] , $invoice_item['clintid'] , $invoice_item['month'] , $invoice_item['id'] , $invoice_item['date']);
													if($is_duplicate){
															$dup_html = "<span style='background-color: red; display: flex;width: 16px;height: 16px;'>
																<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='white' class='bi bi-check' viewBox='0 0 16 16'>
																	<path d='M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z'/>
																  </svg>
															</span>";
													}else{
															$dup_html = "<span style='background-color: lightgray; display: flex;width: 16px; height: 16px;'>&nbsp;</span>";
													}
													?>
													<tr>
														<td style="text-wrap: nowrap;"><?php echo date('Y - m - d', strtotime($invoice_item['date'])); ?></td>
															<?php 
															$month_name = "";
															if($invoice_item['month']==1) {
																$month_name = "Jan";
															} elseif($invoice_item['month']==2) {
																$month_name = "Feb";
															} elseif($invoice_item['month']==3) {
																$month_name = "Mar";
															}  elseif($invoice_item['month']==4) {
																$month_name = "Apr";
															}  elseif($invoice_item['month']==5) {
																$month_name = "May";
															}  elseif($invoice_item['month']==6) {
																$month_name = "Jun";
															} elseif($invoice_item['month']==7) {
																$month_name = "Jul";
															} elseif($invoice_item['month']==8) {
																$month_name = "Aug";
															} elseif($invoice_item['month']==9) {
																$month_name = "Sep";
															} elseif($invoice_item['month']==10) {
																$month_name = "Oct";
															} elseif($invoice_item['month']==11) {
																$month_name = "Nov";
															} elseif($invoice_item['month']==12) {
																$month_name = "Dec";
															} 
														?>
		
														<td class="text-center"><?php echo $month_name; ?></td>
														<td class="text-center"><?php echo $dup_html; ?></td>
														<td style="padding: 0px 13px !important;"><?php echo $invoice_item['ref_no']; ?></td>
														<td class="text-left"><?php echo $invoice_item['invoiceno']; ?></td>
														<td class="text-right"><?php echo number_format($invoice_item['amount'], 0, '.', ','); ?></td>
	
														<td class="text-right">
															<?php
																$email_history = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "all");
																$countSentMail = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'all');
														
																if ($invoice_item['attachment'] != "" AND $invoice_item['cleared'] != 1) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																				<span class='hoverfile'>";
																	if (!empty($email_history)) {
																		foreach ($email_history as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "      </span>
																			</span>
																		</a>
																		&nbsp;";
																} else {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																					<span class='hoverfile'>";
																		if (!empty($email_history)) {
																			foreach ($email_history as $record) {
																				echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																			}
																		}
																		echo "</span>
																			</span>
																		</a>&nbsp;";
																	}
																	
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientinvoiceTemplate&id=8&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																}
														
																echo "&nbsp;&nbsp;<a href='javascript:void(0);' onClick=\"window.open('?route=invoiceTPdf&id={$client['id']}&invoice_id={$invoice_item['id']}', '_blank')\"><i class='fa fa-file-pdf-o'></i></a>&nbsp;&nbsp;";
														
																if ($invoice_item['attachment'] != "") {
																	echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['attachment'] . "'><i class='fa fa-picture-o' aria-hidden='true'></i></i><span class='hovertextfile'>" . $invoice_item['attachment'] . "</span></a><br>";
																} else {
																	echo "<br>";
																}
															?>
														</td>
														
	
	
														<td class="text-right">
															<?php 
															$email_history_paid = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "paid");
															$countSentMailpaidfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'paid');
															$paid_amount =  number_format($invoice_item['paid'], 0, '.', ',');
														
															if ($invoice_item['cleared'] != 1 && $invoice_item['paid_file'] != "") {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																			<span class='hoverfile'>";
																if (!empty($email_history_paid)) {
																	foreach ($email_history_paid as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																}
																echo "</span>
																	</span>
																</a>&nbsp;&nbsp;";
															}
														
															if ($invoice_item['paid_file'] != "") {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "$paid_amount&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['paid_file'] . "'><i class='fa fa-picture-o' style='color: #F97C00;' aria-hidden='true'></i><span class='hovertextfile'>" . $invoice_item['paid_file'] . "</span></a>&nbsp;&nbsp;";
															} else {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																				<span class='hoverfile'>";
																	if (!empty($email_history_paid)) {
																		foreach ($email_history_paid as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;&nbsp;";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "$paid_amount";
															}
															?>
														</td>
														
														
														<td class="text-right">
															<?php
															$invo_or = "";
															$email_history_orfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "orfile");
															$countSentMailorfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'orfile');
														
															if ($invoice_item['cleared'] != 1) {
																if (!empty($email_history_orfile)) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "
																				<span class='hoverfile'>";
																	foreach ($email_history_orfile as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;";
																} else {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "</span>
																		</a>&nbsp;";
																}
															}
														
															if ($invoice_item['or_file'] != "") {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['or_file'] . "'><i style='color: #238C00;' class='fa fa-picture-o'></i><span class='hovertextfile'>" . $invoice_item['or_file'] . "</span></a><br>";
															} else {
																if ($invoice_item['cleared'] != 1 && empty($email_history_orfile)) {
																	echo "";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																}
														
																echo "<br>";
															}
															?>
														</td>
														
														
														<td class="text-right">
															<?php
															$email_history_taxfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "taxfile");
															$countSentMailTaxFile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'taxfile');
														
															if ($invoice_item['cleared'] != 1 && !empty($email_history_taxfile)) {
																echo "<a href=''>
																		<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailTaxFile . "
																			<span class='hoverfile'>";
																foreach ($email_history_taxfile as $record) {
																	echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																}
																echo "</span>
																	</span>
																</a>&nbsp;&nbsp;";
															}
														
															if (!empty($invoice_item['tax_file_2307'])) {
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo $invoice_item['tax_amount'] . "&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicetaxfile=" . $invoice_item['tax_file_2307'] . "'><i style='color: #7F00FF;' class='fa fa-picture-o'></i><span class='hovertextfile'>" . $invoice_item['tax_file_2307'] . "</span></a>&nbsp;&nbsp;";
															} else {
																if ($invoice_item['cleared'] != 1 && empty($email_history_taxfile)) {
																	echo "";
																}
														
																if ($invoice_item['cleared'] != 1) {
																	echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																}
														
																echo $invoice_item['tax_amount'];
															}
															?>
														</td>
														
														
	
														<td class="text-right"><?php echo number_format($invoice_item['balance'], 0, '.', ','); ?></td>
	
										
														<td class="text-left">
															<?php
															if ($invoice_item['payment_ref_no']) {
																echo "<span id='payment_ref_no_td' style='color: blue;' data-invoice_id='".  $invoice_item['id']."' >" . $invoice_item['payment_ref_no'] . "</span>&nbsp;/&nbsp;&nbsp;";
															}
															if ($invoice_item['payment_method']) {
																if(is_numeric($invoice_item['payment_method'])){
																	$payment_method = get_payment_method_name($invoice_item['payment_method']);
																	echo "<span style='color:red;'>" . $payment_method . "</span>&nbsp;/&nbsp;&nbsp;";
																}else{
																	echo "<span style='color:red;'>" . $invoice_item['payment_method'] . "</span>&nbsp;/&nbsp;&nbsp;";
																}
	
															}
															if ($invoice_item['ornumber']) {
																echo "<span>" . $invoice_item['ornumber'] . "</span>&nbsp;&nbsp;";
															}
															?>
														</td>
														
										
														
														<td class="text-left"><?php echo $invoice_item['remark']; ?></td>
	
														<td>
																<?php if($invoice_item['balance'] > 0): ?>
																<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																<?php else: ?>
																<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																<?php endif; ?>
														</td>
	
														<td>
															<?php if($invoice_item['cleared'] == 1): ?>
																	<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																<?php else: ?>
																	<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																<?php endif; ?>
														</td>
	
										
														<td>
															<div>
																<a href="?route=clients/editinvoice&id=<?php echo $invoice_item['id']; ?>"><i class='fa fa-edit'></i></a>&nbsp;
																<a href='#' onClick='showM("ajax.php?modal=invoiceDelete&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $invoice_item['id']; ?>&section=invoice");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>&nbsp;
																
																
															</div>
														</td>
													</tr>
												<?php } ?>
											</tbody>
											</table>
										</div>
	
										<div class="unpaidTableContainer_1" style="display: none;">
											<table id="dataTablesFullDesc" class="table table-responsive table-striped table-hover">
												<thead>
													<tr>
														<th class="text-center">Date</th>
														<th>For</th>
														<th class="text-center">Invoice No.</th>
														<th class="text-center">INV Amt</th>
														<th class="text-center">Invoice</th>
														<th class="text-center">Paid Amount</th>
														<th class="text-center">OR File</th>
														<th class="text-center">Tax (2307) File</th>
														<th class="text-center">Balance</th>
														<th class="text-center">Ref No</th>
														<th class="text-center">Remarks</th>
														<th>Paid</th>
														<th>Clear</th>
														<th class="text-center">Action</th>
												</tr>
												</thead>
												<tbody>
													<?php foreach ($unpaidinvoice as $invoice_item) { ?>
														<tr>
															<td ><?php echo date('Y - m - d', strtotime($invoice_item['date'])); ?></td>
															<td style="padding: 0px 13px !important;"><?php echo $invoice_item['month']; ?></td>
															<td class="text-left"><?php echo $invoice_item['invoiceno']; ?></td>
		
															<td class="text-right"><?php echo number_format($invoice_item['amount'], 0, '.', ','); ?></td>
		
											
															<td class="text-right">
																<?php  
																	$email_history = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "all");
																	$countSentMail = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'all');
															
																	if ($invoice_item['attachment'] != "" AND $invoice_item['cleared'] != 1) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																					<span class='hoverfile'>";
																		if (!empty($email_history)) {
																			foreach ($email_history as $record) {
																				echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																			}
																		}
																		echo "      </span>
																				</span>
																			</a>
																			&nbsp;";
																	} else {
																		if ($invoice_item['cleared'] != 1) {
																			echo "<a href=''>
																					<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																						<span class='hoverfile'>";
																			if (!empty($email_history)) {
																				foreach ($email_history as $record) {
																					echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																				}
																			}
																			echo "</span>
																				</span>
																			</a>&nbsp;";
																		}
																		
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clientinvoiceTemplate&id=8&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																	}
															
																	echo "&nbsp;&nbsp;<a href='javascript:void(0);' onClick=\"window.open('?route=invoiceTPdf&id={$client['id']}&invoice_id={$invoice_item['id']}', '_blank')\"><i class='fa fa-file-pdf-o'></i></a>&nbsp;&nbsp;";
															
																	if ($invoice_item['attachment'] != "") {
																		echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['attachment'] . "'><i class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['attachment'] . "</span></a><br>";
																	} else {
																		echo "<br>";
																	}
																?>
															</td>
															
		
		
															<td class="text-right">
																<?php 
																$email_history_paid = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "paid");
																$countSentMailpaidfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'paid');
																$paid_amount =  number_format($invoice_item['paid'], 0, '.', ',');
															
																if ($invoice_item['cleared'] != 1 && $invoice_item['paid_file'] != "") {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																				<span class='hoverfile'>";
																	if (!empty($email_history_paid)) {
																		foreach ($email_history_paid as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;&nbsp;";
																}
															
																if ($invoice_item['paid_file'] != "") {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo "$paid_amount&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['paid_file'] . "'><i style='color: #F97C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['paid_file'] . "</span></a>&nbsp;&nbsp;";
																} else {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																					<span class='hoverfile'>";
																		if (!empty($email_history_paid)) {
																			foreach ($email_history_paid as $record) {
																				echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																			}
																		}
																		echo "</span>
																			</span>
																		</a>&nbsp;&nbsp;";
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo "$paid_amount";
																}
																?>
															</td>
															
															
															<td class="text-right">
																<?php
																$invo_or = "";
																$email_history_orfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "orfile");
																$countSentMailorfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'orfile');
															
																if ($invoice_item['cleared'] != 1) {
																	if (!empty($email_history_orfile)) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "
																					<span class='hoverfile'>";
																		foreach ($email_history_orfile as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																		echo "</span>
																			</span>
																		</a>&nbsp;";
																	} else {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "</span>
																			</a>&nbsp;";
																	}
																}
															
																if ($invoice_item['or_file'] != "") {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['or_file'] . "'><i style='color: #238C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['or_file'] . "</span></a><br>";
																} else {
																	if ($invoice_item['cleared'] != 1 && empty($email_history_orfile)) {
																		echo "";
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																	}
															
																	echo "<br>";
																}
																?>
															</td>
															
															
															<td class="text-right">
																<?php
																$email_history_taxfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "taxfile");
																$countSentMailTaxFile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'taxfile');
															
																if ($invoice_item['cleared'] != 1 && !empty($email_history_taxfile)) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailTaxFile . "
																				<span class='hoverfile'>";
																	foreach ($email_history_taxfile as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;&nbsp;";
																}
															
																if (!empty($invoice_item['tax_file_2307'])) {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo $invoice_item['tax_amount'] . "&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicetaxfile=" . $invoice_item['tax_file_2307'] . "'><i style='color: #7F00FF;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['tax_file_2307'] . "</span></a>&nbsp;&nbsp;";
																} else {
																	if ($invoice_item['cleared'] != 1 && empty($email_history_taxfile)) {
																		echo "<br>";
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo $invoice_item['tax_amount'];
																}
																?>
															</td>
															
															
		
															<td class="text-right"><?php echo number_format($invoice_item['balance'], 0, '.', ','); ?></td>
		
											
															<td class="text-left">
																<?php
																if ($invoice_item['payment_ref_no']) {
																	echo "<span>" . $invoice_item['payment_ref_no'] . "</span>&nbsp;/&nbsp;&nbsp;";
																}
																if ($invoice_item['payment_method']) {
																	echo "<span style='color:red;'>" . $invoice_item['payment_method'] . "</span>&nbsp;/&nbsp;&nbsp;";
																}
																if ($invoice_item['ornumber']) {
																	echo "<span>" . $invoice_item['ornumber'] . "</span>&nbsp;&nbsp;";
																}
																?>
															</td>
															
											
															
															<td class="text-left"><?php echo $invoice_item['remark']; ?></td>
		
															<td>
																	<?php if($invoice_item['balance'] > 0): ?>
																	<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																	<?php else: ?>
																	<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																	<?php endif; ?>
															</td>
		
															<td>
																<?php if($invoice_item['cleared'] == 1): ?>
																		<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																	<?php else: ?>
																		<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																	<?php endif; ?>
															</td>
		
											
															<td>
																<div>
																	<a href="?route=clients/editinvoice&id=<?php echo $invoice_item['id']; ?>"><i class='fa fa-edit'></i></a>&nbsp;
																	<a href='#' onClick='showM("ajax.php?modal=invoiceDelete&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $invoice_item['id']; ?>&section=invoice");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>&nbsp;
																	
																	
																</div>
															</td>
														</tr>
														
													<?php } ?>
												</tbody>
											</table>
										</div>
	
										<div class="pendingTableContainer_1" style="display: none;">
											<table id="dataTablesFullDesc" class="table table-responsive table-striped table-hover">
												<thead>
												<tr>
													<th class="text-center">Date</th>
													<th>For</th>
													<th class="text-center">Invoice No.</th>
													<th class="text-center">INV Amt</th>
													<th class="text-center">Invoice</th>
													<th class="text-center">Paid Amount</th>
													<th class="text-center">OR File</th>
													<th class="text-center">Tax (2307) File</th>
													<th class="text-center">Balance</th>
													<th class="text-center">Ref No</th>
													<th class="text-center">Remarks</th>
													<th>Paid</th>
													<th>Clear</th>
													<th class="text-center">Action</th>
												</tr>
												</thead>
												<tbody>
													<?php foreach ($pendinginvoice as $invoice_item) { ?>
														<tr>
															<td ><?php echo date('Y - m - d', strtotime($invoice_item['date'])); ?></td>
															<td style="padding: 0px 13px !important;"><?php echo $invoice_item['month']; ?></td>
															<td class="text-left"><?php echo $invoice_item['invoiceno']; ?></td>
		
															<td class="text-right"><?php echo number_format($invoice_item['amount'], 0, '.', ','); ?></td>
		
											
															<td class="text-right">
																<?php  
																	$email_history = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "all");
																	$countSentMail = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'all');
															
																	if ($invoice_item['attachment'] != "" AND $invoice_item['cleared'] != 1) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																					<span class='hoverfile'>";
																		if (!empty($email_history)) {
																			foreach ($email_history as $record) {
																				echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																			}
																		}
																		echo "      </span>
																				</span>
																			</a>
																			&nbsp;";
																	} else {
																		if ($invoice_item['cleared'] != 1) {
																			echo "<a href=''>
																					<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																						<span class='hoverfile'>";
																			if (!empty($email_history)) {
																				foreach ($email_history as $record) {
																					echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																				}
																			}
																			echo "</span>
																				</span>
																			</a>&nbsp;";
																		}
																		
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clientinvoiceTemplate&id=8&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																	}
															
																	echo "&nbsp;&nbsp;<a href='javascript:void(0);' onClick=\"window.open('?route=invoiceTPdf&id={$client['id']}&invoice_id={$invoice_item['id']}', '_blank')\"><i class='fa fa-file-pdf-o'></i></a>&nbsp;&nbsp;";
															
																	if ($invoice_item['attachment'] != "") {
																		echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['attachment'] . "'><i class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['attachment'] . "</span></a><br>";
																	} else {
																		echo "<br>";
																	}
																?>
															</td>
															
		
		
															<td class="text-right">
																<?php 
																$email_history_paid = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "paid");
																$countSentMailpaidfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'paid');
																$paid_amount =  number_format($invoice_item['paid'], 0, '.', ',');
															
																if ($invoice_item['cleared'] != 1 && $invoice_item['paid_file'] != "") {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																				<span class='hoverfile'>";
																	if (!empty($email_history_paid)) {
																		foreach ($email_history_paid as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;&nbsp;";
																}
															
																if ($invoice_item['paid_file'] != "") {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo "$paid_amount&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['paid_file'] . "'><i style='color: #F97C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['paid_file'] . "</span></a>&nbsp;&nbsp;";
																} else {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																					<span class='hoverfile'>";
																		if (!empty($email_history_paid)) {
																			foreach ($email_history_paid as $record) {
																				echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																			}
																		}
																		echo "</span>
																			</span>
																		</a>&nbsp;&nbsp;";
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo "$paid_amount";
																}
																?>
															</td>
															
															
															<td class="text-right">
																<?php
																$invo_or = "";
																$email_history_orfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "orfile");
																$countSentMailorfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'orfile');
															
																if ($invoice_item['cleared'] != 1) {
																	if (!empty($email_history_orfile)) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "
																					<span class='hoverfile'>";
																		foreach ($email_history_orfile as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																		echo "</span>
																			</span>
																		</a>&nbsp;";
																	} else {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "</span>
																			</a>&nbsp;";
																	}
																}
															
																if ($invoice_item['or_file'] != "") {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['or_file'] . "'><i style='color: #238C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['or_file'] . "</span></a><br>";
																} else {
																	if ($invoice_item['cleared'] != 1 && empty($email_history_orfile)) {
																		echo "";
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																	}
															
																	echo "<br>";
																}
																?>
															</td>
															
															
															<td class="text-right">
																<?php
																$email_history_taxfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "taxfile");
																$countSentMailTaxFile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'taxfile');
															
																if ($invoice_item['cleared'] != 1 && !empty($email_history_taxfile)) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailTaxFile . "
																				<span class='hoverfile'>";
																	foreach ($email_history_taxfile as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;&nbsp;";
																}
															
																if (!empty($invoice_item['tax_file_2307'])) {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo $invoice_item['tax_amount'] . "&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicetaxfile=" . $invoice_item['tax_file_2307'] . "'><i style='color: #7F00FF;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['tax_file_2307'] . "</span></a>&nbsp;&nbsp;";
																} else {
																	if ($invoice_item['cleared'] != 1 && empty($email_history_taxfile)) {
																		echo "<br>";
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo $invoice_item['tax_amount'];
																}
																?>
															</td>
															
															
		
															<td class="text-right"><?php echo number_format($invoice_item['balance'], 0, '.', ','); ?></td>
		
											
															<td class="text-left">
																<?php
																if ($invoice_item['payment_ref_no']) {
																	echo "<span>" . $invoice_item['payment_ref_no'] . "</span>&nbsp;/&nbsp;&nbsp;";
																}
																if ($invoice_item['payment_method']) {
																	echo "<span style='color:red;'>" . $invoice_item['payment_method'] . "</span>&nbsp;/&nbsp;&nbsp;";
																}
																if ($invoice_item['ornumber']) {
																	echo "<span>" . $invoice_item['ornumber'] . "</span>&nbsp;&nbsp;";
																}
																?>
															</td>
															
											
															
															<td class="text-left"><?php echo $invoice_item['remark']; ?></td>
		
															<td>
																	<?php if($invoice_item['balance'] > 0): ?>
																	<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																	<?php else: ?>
																	<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																	<?php endif; ?>
															</td>
		
															<td>
																<?php if($invoice_item['cleared'] == 1): ?>
																		<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																	<?php else: ?>
																		<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																	<?php endif; ?>
															</td>
		
											
															<td>
																<div>
																	<a href="?route=clients/editinvoice&id=<?php echo $invoice_item['id']; ?>"><i class='fa fa-edit'></i></a>&nbsp;
																	<a href='#' onClick='showM("ajax.php?modal=invoiceDelete&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $invoice_item['id']; ?>&section=invoice");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>&nbsp;
																	
																	
																</div>
															</td>
														</tr>
													<?php } ?>
												</tbody>
											</table>
										</div>
	
										<div class="tofollowTableContainer_1" style="display: none;">
											<table id="dataTablesFullDesc" class="table table-responsive table-striped table-hover">
												<thead>
												<tr>
													<th class="text-center">Date</th>
													<th>For</th>
													<th class="text-center">Invoice No.</th>
													<th class="text-center">INV Amt</th>
													<th class="text-center">Invoice</th>
													<th class="text-center">Paid Amount</th>
													<th class="text-center">OR File</th>
													<th class="text-center">Tax (2307) File</th>
													<th class="text-center">Balance</th>
													<th class="text-center">Ref No</th>
													<th class="text-center">Remarks</th>
													<th>Paid</th>
													<th>Clear</th>
													<th class="text-center">Action</th>
												</tr>
												</thead>
												<tbody>
													<?php foreach ($getToFollowRecords as $invoice_item) { ?>
														<tr>
															<td ><?php echo date('Y - m - d', strtotime($invoice_item['date'])); ?></td>
															<td style="padding: 0px 13px !important;"><?php echo $invoice_item['month']; ?></td>
															<td class="text-left"><?php echo $invoice_item['invoiceno']; ?></td>
		
															<td class="text-right"><?php echo number_format($invoice_item['amount'], 0, '.', ','); ?></td>
		
											
															<td class="text-right">
																<?php  
																	$email_history = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "all");
																	$countSentMail = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'all');
															
																	if ($invoice_item['attachment'] != "" AND $invoice_item['cleared'] != 1) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																					<span class='hoverfile'>";
																		if (!empty($email_history)) {
																			foreach ($email_history as $record) {
																				echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																			}
																		}
																		echo "      </span>
																				</span>
																			</a>
																			&nbsp;";
																	} else {
																		if ($invoice_item['cleared'] != 1) {
																			echo "<a href=''>
																					<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMail . "
																						<span class='hoverfile'>";
																			if (!empty($email_history)) {
																				foreach ($email_history as $record) {
																					echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																				}
																			}
																			echo "</span>
																				</span>
																			</a>&nbsp;";
																		}
																		
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clientinvoiceTemplate&id=8&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																	}
															
																	echo "&nbsp;&nbsp;<a href='javascript:void(0);' onClick=\"window.open('?route=invoiceTPdf&id={$client['id']}&invoice_id={$invoice_item['id']}', '_blank')\"><i class='fa fa-file-pdf-o'></i></a>&nbsp;&nbsp;";
															
																	if ($invoice_item['attachment'] != "") {
																		echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['attachment'] . "'><i class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['attachment'] . "</span></a><br>";
																	} else {
																		echo "<br>";
																	}
																?>
															</td>
															
		
		
															<td class="text-right">
																<?php 
																$email_history_paid = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "paid");
																$countSentMailpaidfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'paid');
																$paid_amount =  number_format($invoice_item['paid'], 0, '.', ',');
															
																if ($invoice_item['cleared'] != 1 && $invoice_item['paid_file'] != "") {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																				<span class='hoverfile'>";
																	if (!empty($email_history_paid)) {
																		foreach ($email_history_paid as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;&nbsp;";
																}
															
																if ($invoice_item['paid_file'] != "") {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo "$paid_amount&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['paid_file'] . "'><i style='color: #F97C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['paid_file'] . "</span></a>&nbsp;&nbsp;";
																} else {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailpaidfile . "
																					<span class='hoverfile'>";
																		if (!empty($email_history_paid)) {
																			foreach ($email_history_paid as $record) {
																				echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																			}
																		}
																		echo "</span>
																			</span>
																		</a>&nbsp;&nbsp;";
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxpaidFileTemplate&id=7&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo "$paid_amount";
																}
																?>
															</td>
															
															
															<td class="text-right">
																<?php
																$invo_or = "";
																$email_history_orfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "orfile");
																$countSentMailorfile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'orfile');
															
																if ($invoice_item['cleared'] != 1) {
																	if (!empty($email_history_orfile)) {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "
																					<span class='hoverfile'>";
																		foreach ($email_history_orfile as $record) {
																			echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																		}
																		echo "</span>
																			</span>
																		</a>&nbsp;";
																	} else {
																		echo "<a href=''>
																				<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailorfile . "</span>
																			</a>&nbsp;";
																	}
																}
															
																if ($invoice_item['or_file'] != "") {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo "<a class='onhoverfile' href='ajax.php?invoicefile=" . $invoice_item['or_file'] . "'><i style='color: #238C00;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['or_file'] . "</span></a><br>";
																} else {
																	if ($invoice_item['cleared'] != 1 && empty($email_history_orfile)) {
																		echo "";
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clientOrFileTemplate&id=16&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>";
																	}
															
																	echo "<br>";
																}
																?>
															</td>
															
															
															<td class="text-right">
																<?php
																$email_history_taxfile = getTableFiltered("invoicesentmailhistory", "invoiceid", $invoice_item['id'], "type", "taxfile");
																$countSentMailTaxFile = countTableFiltered('invoicesentmailhistory', 'invoiceid', $invoice_item['id'], 'type', 'taxfile');
															
																if ($invoice_item['cleared'] != 1 && !empty($email_history_taxfile)) {
																	echo "<a href=''>
																			<span class='onhoverfile' style='color: #FF0000;'>" . $countSentMailTaxFile . "
																				<span class='hoverfile'>";
																	foreach ($email_history_taxfile as $record) {
																		echo date('Y-m-d H:i:s', strtotime($record['date'])) . "<br>";
																	}
																	echo "</span>
																		</span>
																	</a>&nbsp;&nbsp;";
																}
															
																if (!empty($invoice_item['tax_file_2307'])) {
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo $invoice_item['tax_amount'] . "&nbsp;&nbsp;<a class='onhoverfile' href='ajax.php?invoicetaxfile=" . $invoice_item['tax_file_2307'] . "'><i style='color: #7F00FF;' class='fa fa-file'></i><span class='hovertextfile'>" . $invoice_item['tax_file_2307'] . "</span></a>&nbsp;&nbsp;";
																} else {
																	if ($invoice_item['cleared'] != 1 && empty($email_history_taxfile)) {
																		echo "<br>";
																	}
															
																	if ($invoice_item['cleared'] != 1) {
																		echo "<a href='#' onclick=\"showM('ajax.php?modal=clienttaxFileTemplate&id=9&client_id={$client['id']}&invoice_id={$invoice_item['id']}&reroute=system/settings&section=templates'); return false;\"><i style='color: #FF0000;' class='fa fa-envelope-o'></i></a>&nbsp;&nbsp;";
																	}
															
																	echo $invoice_item['tax_amount'];
																}
																?>
															</td>
															
															
		
															<td class="text-right"><?php echo number_format($invoice_item['balance'], 0, '.', ','); ?></td>
		
											
															<td class="text-left">
																<?php
																if ($invoice_item['payment_ref_no']) {
																	echo "<span>" . $invoice_item['payment_ref_no'] . "</span>&nbsp;/&nbsp;&nbsp;";
																}
																if ($invoice_item['payment_method']) {
																	echo "<span style='color:red;'>" . $invoice_item['payment_method'] . "</span>&nbsp;/&nbsp;&nbsp;";
																}
																if ($invoice_item['ornumber']) {
																	echo "<span>" . $invoice_item['ornumber'] . "</span>&nbsp;&nbsp;";
																}
																?>
															</td>
															
											
															
															<td class="text-left"><?php echo $invoice_item['remark']; ?></td>
		
															<td>
																	<?php if($invoice_item['balance'] > 0): ?>
																	<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																	<?php else: ?>
																	<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																	<?php endif; ?>
															</td>
		
															<td>
																<?php if($invoice_item['cleared'] == 1): ?>
																		<a style="color:#ffffff;background-color:#CCCCCC;padding: 3px;border-radius: 5px;">Yes</a>
																	<?php else: ?>
																		<a style="background-color:red;color: white;padding: 3px;border-radius: 5px;">No</a>
																	<?php endif; ?>
															</td>
											
															<td>
																<div>
																	<a href="?route=clients/editinvoice&id=<?php echo $invoice_item['id']; ?>"><i class='fa fa-edit'></i></a>&nbsp;
																	<a href='#' onClick='showM("ajax.php?modal=invoiceDelete&reroute=clients/manage&routeid=<?php echo $client['id']; ?>&id=<?php echo $invoice_item['id']; ?>&section=invoice");return false' class='btn-right text-red'><i class='fa fa-trash-o'></i></a>&nbsp;
																</div>
															</td>
														</tr>
													<?php } ?>
												</tbody>
											</table>
										</div>

									 </div>
									 <!-- second row with table -->
								</div>
								<!-- invoice 1 main row -->
							</div>


						</div>
					</div>
				</div>
			</div>

			
			<div class="modal fade" id="imageModal" tabindex="-1" role="dialog" aria-labelledby="imageModalLabel" aria-hidden="true">
				<div class="modal-dialog modal-lg" role="document">
				  <div class="modal-content">
					<div class="modal-body" style="text-align: center;">
					  <img id="modalImage" src="" class="img-fluid" style="max-width: 100%; max-height: 100%;" alt="Big Image">
					</div>
				  </div>
				</div>
			  </div>
	
			<div class="modal" tabindex="-1" id="myModalqr" role="dialog">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-body">
							<div style="text-align: center;" id="qrcode"></div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
							<a class="qr-download btn btn-primary" type="button"  download="myimage">Download</a>
						</div>
					</div>
				</div>
			</div>
	
			<div class="modal" tabindex="-1" id="myModalqrticket" role="dialog">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-body">
							<div class="row">
								<div class="col-md-6" style="text-align: center;">
									<div id="qrcode-ticket"></div>
								</div>
								<div class="col-md-6" style="text-align: center;">
									<div id="ticket-qrcode-ticket"
									data-img-id="uploads/<?php echo $modelimage; ?>"></div>
								<div id="ticket-product" data-pro-id="<?php echo $modelname . " -" ?>">
								</div>
								</div>
							</div>
							
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
							<a class="qr-download-ticket btn btn-primary" type="button" download="myimage">Download</a>
						</div>
					</div>
				</div>
			</div>
			<div class="modal fade" id="bulk_invoice_payment_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    		aria-hidden="true">
				<div class="modal-dialog modal-lg" role="document">
					<div class="modal-content">
						<form action="" method="post" role="form" id="bulk_invoice_payment" onsubmit="return false;">
							<input type="hidden" name="bulk_invoice_payment">
							<div class="modal-header">
								<h4 style="display: inline;">Invoice Payment</h4>
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
							</div>
							<div class="modal-body">
								<div class="paid_msg" style="text-align: center; font-size: 18px;">
									All Invoice are Paid
								</div>
								<div class="row invoice_modal_body">
									<div class="col-sm-8">
										<div style="display: flex; justify-content: space-evenly; align-items: center;">
											<p style="font-size: 16px;">Total Balance : <span id="total_bal_modal" style="color: red;"></span></p>
										</div>
										<table class="table table-striped table-hover">
											<thead>
												<tr>
													<th><input type="checkbox" id="checkall_inv" style="zoom: 0 !important;"></th>
													<th>Date</th>
													<th>D</th>
													<th>M</th>
													<th>INV Ref No</th>
													<th>Client</th>
													<th>INV</th>
													<th>AMT</th>
													<th>INV File</th>
												</tr>
											</thead>
											<tbody class="bulk_invoice_payment_tbody"></tbody>
										</table>
									</div>
									<div class="col-sm-4">
										<!-- form element -->
										<div class="form-group" style="margin-bottom: 0px;">
											<label for="payment_method" class="control-label">Payment Method</label>
											<select id="payment_method" name="payment_method" class="form-control" style="width:100%;display:inline;">
												<?php 
												$payment_method_data = get_payment_method_data();
												if(!empty($payment_method_data)){
													foreach($payment_method_data as $payment_method){
														if($payment_method['id'] == $invoice['payment_method']){ ?>
															<option value="<?php echo $payment_method['id']; ?>" selected>
																<?php echo $payment_method['name']; ?>
															</option>
														<?php }else{ ?>
															<option value="<?php echo $payment_method['id']; ?>">
																<?php echo $payment_method['name']; ?>
															</option>
														<?php }
													}
												}
												?>
											</select>
										</div>

										<div class="form-group" style="margin-bottom: 0px;">
											<label for="payment_ref_no" class="control-label">Payment Ref No / Check No <span style="color: red;">*</span> </label>
											<div>
												<input type="text" class="form-control" id="payment_ref_no" name="payment_ref_no">
											</div>
											<span class="payment_ref_no_error"></span>
										</div>
										
										<div class="form-group" style="margin-bottom: 0px;">
											<label for="ornumber" class="control-label">O.R Number <span style="color: red;">*</span> </label>
											<div>
												<input type="text" class="form-control" id="ornumber" name="ornumber">
												<span class="ornumber_error"></span>
											</div>
										</div>

										<div class="form-group" style="margin-bottom: 0px;">
											<label for="paid" class="control-label">
												<span style="font-size: 16px;">Invoice Amount : <span style="color: red;" id="invoice_amt_modal"></span> </span><br>
												Received Amount 
											</label>
											<div>
												<input type="text" class="form-control" id="paid" name="paid">
												<input type="hidden" id="total_amount_to_pay" name="total_amount_to_pay">
												<span id="paid_amount_error"></span>
												<span class="paid_error"></span>
											</div>
										</div>
										<div>
											<input type="hidden" id="tax" name="tax">
											<span style="font-size: 17px;"> 2037 Balance or Discount : <span id="total_tax" style="color: red;"></span> </span>
										</div>
										<div id="invoice_check_error"></div>

										<!-- <div class="form-group" style="margin-bottom: 0px;">
											<label for="paidfile" class="control-label">Paid File</label>
											<div>
												<div class="input-group">
													<input type="file" id="paidfile" name='paid_file' class="filestyle"
														data-iconName="glyphicon glyphicon-inbox">
												</div>
											</div>
										</div> -->
										<!-- form element -->
									</div>
								</div>


								<div class="payment_detail row" style="text-align: center;">
									<div class="col-sm-8">
										<table class="table table-striped table-hover">
											<thead>
												<tr>
													<th><input type="checkbox" style="zoom: 0 !important;" disabled></th>
													<th>Date</th>
													<th>D</th>
													<th>M</th>
													<th>INV Ref No</th>
													<th>Client</th>
													<th>INV</th>
													<th>AMT</th>
													<th>INV File</th>
												</tr>
											</thead>
											<tbody class="bulk_invoice_payment_info_tbody"></tbody>
										</table>
									</div>
									<div class="col-sm-4">
										<!-- form element -->
										<div class="form-group" style="margin-bottom: 0px;">
											<label for="payment_method" style="text-align: left; width: 100%;" class="control-label">Payment Method</label>
											<input type="text" id="payment_method_info" class="form-control" style="width:100%;display:inline;" readonly>
										</div>
										
										<div class="form-group" style="margin-bottom: 0px;">
											<label for="payment_ref_no" style="text-align: left; width: 100%;" class="control-label">Payment Ref No</label>
											<div>
												<input type="text" class="form-control" id="payment_ref_no_info" readonly>
											</div>
										</div>
										
										<div class="form-group" style="margin-bottom: 0px;">
											<label class="control-label" style="text-align: left; width: 100%;">O.R Number</label>
											<div>
												<input type="text" class="form-control" id="ornumber_info" readonly>
											</div>
										</div>

										<div class="form-group" style="margin-bottom: 0px;">
											<label for="paid" class="control-label" style="width: 100%; text-align: left;">
												<span style="font-size: 16px; ">Invoice Amount : <span style="color: red;" id="invoice_amt_modal_info"></span> </span><br>
												Received Amount 
											</label>
											<div>
												<input type="text" class="form-control" id="paid_info" readonly>
											</div>
										</div>

										<div style="width: 100%; text-align: left;">
											<input type="hidden" id="tax" name="tax">
											<span style="font-size: 17px;"> 2037 Balance or Discount : <span id="total_tax_info" style="color: red;"></span> </span>
										</div>
										<div id="invoice_check_error"></div>

									</div>
								</div>
							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
								<button type="submit" class="btn btn-primary" id="save_bulk_btn">Save changes</button>
							</div>
						</form>
					</div>
				</div>
			</div>
			<div id="previewImg" style="display: none;">
			</div>
	<?php
	$baseUrl = ($_SERVER['HTTP_HOST'] == 'localhost') ? 'http://localhost/egatesupport/' : 'https://egatesupport.com/';
	?>
			<script type="text/javascript">
				$(document).ready(function () {

					// bulk invoice js
					$("#process_payment_btn").on('click' , function(){
						var client_id = $(this).data('clientid');
						$.ajax({
							url: "ajax.php?get_invoice_by_clientid=''",
							data : {
								'client_id' : client_id
							},
							type : "POST",
							success: function(res){
							var data = JSON.parse(res);
								console.log('data:', data);
								if (data.res ?.status == 1) {
									var invoices = data.res ?.tbody;
									$(".bulk_invoice_payment_tbody").html(invoices);
									$(".invoice_modal_body").show();
									$(".paid_msg").hide();
									$(".payment_detail").hide();
									$("#save_bulk_btn").show();
									$("#bulk_invoice_payment_modal .modal-dialog").css('width' , 'max-content');
									$("#bulk_invoice_payment_modal").modal('show');
									var totle_balance = data.res ?.totle_balance;
									$("#total_bal_modal").html(totle_balance.toLocaleString("en-US"));
									var totle_amount = data.res ?.totle_amount;
									$("#invoice_amt_modal").html(totle_amount.toLocaleString("en-US"));
								}else{
									$(".invoice_modal_body").hide();
									$(".paid_msg").show();
									$(".payment_detail").hide();
									$("#save_bulk_btn").hide();
									$("#bulk_invoice_payment_modal").modal('show');
								}
							}
						})
					})

					$(".payment_ref_no_error").hide();
					$(".ornumber_error").hide();
					$(".paid_error").hide();
					$(".paid_amount_error").hide();
					$("#invoice_check_error").hide();
					
					$("#checkall_inv").on('click' , function(){
						let totalAmt = 0;
						if ($(this).prop('checked')) {
							$(".inv_check").prop('checked', true);
							$(".inv_check").each(function () {
								let amtValue = parseFloat($(this).closest('tr').find('.amt').text()) || 0;
								totalAmt += amtValue; 
							});
						}else{
							$(".inv_check").prop('checked', false);
							totalAmt = 0;
						}
						$("#total_amount_to_pay").val(totalAmt);
						var formated_paid = totalAmt.toLocaleString("en-US"); 
						$("#paid").val(formated_paid).trigger("change");;
					})
					
					
					$(document).on('change', '.inv_check', function() {
						let totalCheckboxes = $('.inv_check').length;
						let checkedCheckboxes = $('.inv_check:checked').length;
						if (totalCheckboxes === checkedCheckboxes) {
							totalAmt = 0;
							$("#checkall_inv").prop('checked', true);
							$(".inv_check").each(function () {
								let amtValue = parseFloat($(this).closest('tr').find('.amt').text()) || 0;
								totalAmt += amtValue;
							});
						}else{
							$("#checkall_inv").prop('checked', false);
						}

						let amtValue = $(this).closest('tr').find('.amt').text();
						amtValue = parseFloat(amtValue);
						var paid = $("#total_amount_to_pay").val();
						if ($(this).is(':checked')) {
							if (paid != '') {
								paid = parseFloat(paid);
							}else{
								paid = 0;
							}
							paid += amtValue;
							$("#total_amount_to_pay").val(paid);
							var formated_paid = paid.toLocaleString("en-US"); 
							$("#paid").val(formated_paid).trigger("change");;
						}else{
							var paid_formattedValue = $("#paid").val();
							var paid_input_val = parseInt(paid_formattedValue.replace(/,/g, ""), 10);
							paid = 0;
							if (paid_input_val != '') {
								if (paid_input_val > amtValue) {
									paid = paid_input_val - amtValue;
								}
							}
							$("#total_amount_to_pay").val(paid);
							var formated_paid = paid.toLocaleString("en-US"); 
							$("#paid").val(formated_paid).trigger("change");;
						}
					});
					
					
					$(document).on('keyup change' , '#paid' , function(){
						var paid_val = $(this).val();
						paid_val_formeted = parseInt(paid_val.replace(/,/g, ""), 10);
						var total_amount_to_pay = $("#total_amount_to_pay").val();

						if (parseFloat(total_amount_to_pay) < parseFloat(paid_val_formeted)) {
							$("#paid_amount_error").html("<span style='color: red;'> Paid Amount is now more then "+ total_amount_to_pay +" </span>");
						}else{
							var discount = parseFloat(total_amount_to_pay) - parseFloat(paid_val_formeted);
							$("#total_tax").html(discount);
							$("#tax").val(discount);
							
						}
					})
					
					$("#bulk_invoice_payment_modal").on("hidden.bs.modal" , function(){
						$("#bulk_invoice_payment #paid").val('');
						$(".payment_ref_no_error").hide();
						$(".ornumber_error").hide();
						$(".paid_error").hide();
						$(".paid_amount_error").hide();
						$("#checkall_inv").prop('checked', false);
					})
					
					
					
					$("#bulk_invoice_payment").submit(function () {
						var checkedInvoices = $('.inv_check:checked').map(function() {
							return $(this).data('invoice_id');
						}).get();
						
						var checkedInvoices_length = checkedInvoices.length;
						var payment_ref_no = $("#payment_ref_no").val();
						var paid = $("#paid").val();
						var ornumber = $("#ornumber").val();
						if (payment_ref_no != '' && paid != '' && ornumber != '') {
							$.ajax({
								url: "ajax.php?bulk_invoice_payment=''",
								type: "POST",
								data: {
									'invoice_ids': checkedInvoices,
									'payment_method' : $("#payment_method").val(),
									'payment_ref_no' : $("#payment_ref_no").val(),
									'ornumber' : $("#ornumber").val(),
									'paid' : $("#paid").val(),
									'tax' : $("#tax").val(),
									'total_amount_to_pay' : $("#total_amount_to_pay").val()
								},
								success: function (res) {
									var data = JSON.parse(res);
									if (data.res ?.status == 2) {
										$("#invoice_check_error").html("<span style='color: red; font-size: 17px;'> "+ data.res ?.msg +" </span>");
										$("#invoice_check_error").show();
									}else{
										$("#bulk_invoice_payment_modal").modal("hide");
										window.location.reload();
									}
								}
							})
						}else{
							if (payment_ref_no == "") {
								$(".payment_ref_no_error").html("<span style='color: red;'> Payment Refrence No is Required </span>");
								$(".payment_ref_no_error").show();                
							}

							if (paid == "") {
								$(".paid_error").html("<span style='color: red;'> Paid Amount is Required </span>");
								$(".paid_error").show();                
							}

							if (ornumber == "") {
								$(".ornumber_error").html("<span style='color: red;'> OR Number is Required </span>");
								$(".ornumber_error").show();                
							}
						}
						})

					$(document).on("click", "#payment_ref_no_td", function () {
						let payment_ref_no_td = $(this).text().trim(); // Get the text inside the td
						alert(payment_ref_no_td);
						if (payment_ref_no_td !== '') {
							var invoice_id = $(this).data('invoice_id');
							$.ajax({
							url: "ajax.php?get_invoice_by_invoice_id=''",
							data : {
								'invoice_id' : invoice_id
							},
							type : "POST",
							success: function(res){
							var data = JSON.parse(res);
								console.log('data:', data)
								if (data.res ?.status == 1) {
									var invoice = data.res ?.data;
									$(".payment_detail #paid_info").val(invoice.paid);
									$(".payment_detail #payment_ref_no_info").val(invoice.payment_ref_no);
									$(".payment_detail #ornumber_info").val(invoice.ornumber);
									$(".payment_detail #payment_method_info").val(invoice.payment_method_info);
									$(".invoice_modal_body").hide();
									$(".paid_msg").hide();
									$(".payment_detail").show();
									$("#save_bulk_btn").hide();
									$(".bulk_invoice_payment_info_tbody").html(data.res ?.tbody);
									var totle_amount = data.res ?.totle_amount;
									$("#invoice_amt_modal_info").html(totle_amount.toLocaleString("en-US"));
									var discount = totle_amount - invoice.paid;
									$("#total_tax_info").html(discount);
									$("#bulk_invoice_payment_modal").modal('show');
								}
							}
						})
						}
					});
					// bulk invoices js



					function getUrlParameter(name) {
						const urlParams = new URLSearchParams(window.location.search);
						return urlParams.get(name);
					}

					const qr = getUrlParameter('qr');
					const assetid = getUrlParameter('qr_assetid');
					const department_name = getUrlParameter('qr_department_name');
					const id = getUrlParameter('qr_id');					
					const tab = getUrlParameter('tab');

					if (qr && tab === 'department' && assetid != '' && department_name != '' && id != '') {
						// $('#myModalqrticket').modal('show');
						var url = "ajax.php?modal=modelUsageEditactualstatus&reroute=system/models&id="+assetid+"&department="+department_name+"&contractno="+id;				
						showM(url);
					}


					$('#view-options').change(function() {
						var v = $(this).val();
						var url = window.location.href;
						url = url.replace(/&tab=department/g, '');
						url = url.replace(/&status=[0-3]/g, '');

						switch(v) {
							case 'all':
								var href = url + "&status=3";
								window.location.href = href;
								break;
								
							case 'active':
								var href = url + "&status=0";
								window.location.href = href;
								break;
								
							case 'inactive':
								var href = url + "&status=1";
								window.location.href = href;
								break;

							case 'status_expiered':
								var href = url + "&status_expiered=1";
								window.location.href = href;
								break;

						}
					});



					$('.qr-modal').click(function () {
						$("#qrcode").html("");
						var id = $(this).data('contract-id');
						var qrcode = new QRCode(document.getElementById("qrcode"), {
							text: id,
							width: 250,
							height: 250
						});
						var canvas = document.getElementById("qrcode").getElementsByTagName("canvas")[0];
						var base64 = canvas.toDataURL("image/png");
			
						var image = '<img src="' + base64 + '" alt="qr"><p style="font-size: 28px;font-weight: 700;color: #00008075;">' + id + '</p>';
						$("#qrcode").html(image);
						$('#myModalqr').modal('show');
					});
	
					$('.qr-modal-ticket').click(function () {
						$("#qrcode-ticket").html("");
						var id = $(this).data('contract-id');
						var ticketimgid = $("#ticket-qrcode-ticket").data('img-id');
						var productname = $("#ticket-product").data('pro-id');
	
						var qrcode = new QRCode(document.getElementById("qrcode-ticket"), {
							text: id,
							width: 250,
							height: 250
						});
						
						var canvas = document.getElementById("qrcode-ticket").getElementsByTagName("canvas")[0];
						var base64 = canvas.toDataURL("image/png");
	
						var image = '<img src="' + base64 + '" alt="qr">';
	
						var productimage = '<p style="font-size: 28px;font-weight: 700;color: red;">' + id + '</p><img style="height:175px;width:163px;" src="' + ticketimgid + '" alt="qr">';
	
						var proname = '<p style="font-size: 28px;font-weight: 700;color: red;">' + productname + '</p>'
	
						$("#qrcode-ticket").html(image);
						$("#ticket-qrcode-ticket").html(productimage);
						$("#ticket-product").html(proname);
	
						$('#myModalqrticket').modal('show');
					});


					// $('.qr-modal-ticket_second').click(function () {
					// 	$("#qrcode-ticket").html("");
					// 	var id = $(this).data('contract-id');
					// 	var client_id = $(this).data('client-id');
					// 	var ticketimgid = $("#ticket-qrcode-ticket").data('img-id');
					// 	var productname = $("#ticket-product").data('pro-id');
					// 	var qrcode = new QRCode(document.getElementById("qrcode-ticket"), {
					// 		text: id,
					// 		width: 250,
					// 		height: 250
					// 	});
						
					// 	var canvas = document.getElementById("qrcode-ticket").getElementsByTagName("canvas")[0];
					// 	var base64 = canvas.toDataURL("image/png");
	
					// 	var image = '<img src="' + base64 + '" alt="qr">';
	
					// 	var productimage = '<p style="font-size: 28px;font-weight: 700;color: red;">' + id + '</p><img style="height:175px;width:163px;" src="' + ticketimgid + '" alt="qr">';
	
					// 	var proname = '<p style="font-size: 28px;font-weight: 700;color: red;">' + productname + '</p>'
	
					// 	$("#qrcode-ticket").html(image);
					// 	$("#ticket-qrcode-ticket").html(productimage);
					// 	$("#ticket-product").html(proname);
	
					// 	$('#myModalqrticket').modal('show');
					// });
					// Assuming client_id is a global variable, e.g., `var client_id = 42;`
				var baseUrl = "<?php echo $baseUrl; ?>";
				$('.qr-modal-ticket_second').click(function () {
					$("#qrcode-ticket").html(""); // Clear any previous QR code
					var id = $(this).data('contract-id'); // Get the contract ID from button data attribute
					var ticketimgid = $("#ticket-qrcode-ticket").data('img-id'); // Image ID for the ticket image
					var productname = $("#ticket-product").data('pro-id'); // Product name for the QR modal
					var client_id = $(this).data('client-id');
					var assetid = $(this).data('assetid');

					var department_name = $(this).data('department_name');

					// Construct the URL with the dynamic client_id
					// https://egatesupport.com/
					var targetUrl = baseUrl+ "?route=clients/manage&id=" + client_id + "&tab=department&qr=1&qr_assetid="+assetid+"&qr_department_name="+department_name+"&qr_id="+id;


					// Generate the QR code with the constructed URL
					var qrcode = new QRCode(document.getElementById("qrcode-ticket"), {
						text: targetUrl,  // Use the target URL as the QR code content
						width: 250,
						height: 250
					});

					// Convert QR code to image format
					var canvas = document.getElementById("qrcode-ticket").getElementsByTagName("canvas")[0];
					var base64 = canvas.toDataURL("image/png");

					// Construct the HTML elements for display
					var image = '<img src="' + base64 + '" alt="qr">';
					var productimage = '<p style="font-size: 28px;font-weight: 700;color: red;">' + id + '</p><img style="height:175px;width:163px;" src="' + ticketimgid + '" alt="qr">';
					var proname = '<p style="font-size: 28px;font-weight: 700;color: red;">' + productname + '</p>';

					// Inject the generated elements into the modal
					$("#qrcode-ticket").html(image);
					$("#ticket-qrcode-ticket").html(productimage);
					$("#ticket-product").html(proname);

					// Show the modal with the generated QR code and details
					$('#myModalqrticket').modal('show');
				});

					
	
				$('.qr-download').click(function () {
							var id = $("#qrcode p").text();
							var qrimg = $("#qrcode img").attr("src");
							var imageName = id + '.png';
							downloadImage(qrimg, imageName);
						});
				});
	
				$('.qr-download-ticket').click(function () {
					$("#previewImg").html("");
					$(this).attr('disabled', 'disabled')
						var id = $("#ticket-qrcode-ticket p").text();
						// var qrimg = $("#qrcode-ticket img").attr("src");
						var imageName = id + '.png';
						html2canvas(document.querySelector('#myModalqrticket .modal-body')).then(function (canvas) {                   
					   var anchorTag = document.createElement("a");
						document.body.appendChild(anchorTag);
						document.getElementById("previewImg").appendChild(canvas);
						anchorTag.download = imageName;
						anchorTag.href = canvas.toDataURL();
						anchorTag.target = '_blank';
						anchorTag.click();
					});
					$(this).attr('disabled', false)
						// downloadAsImage(imageName);
					});
	
				function downloadImage(data, filename) {
						var a = document.createElement('a');
						a.href = data;
						a.download = filename;
						document.body.appendChild(a);
						a.click();
						document.body.removeChild(a);
					}
	
					
	
	
	
			</script>
			
	
		</section><!-- /.content -->
	</aside><!-- /.right-side -->
	
	<!-- ChartJS 1.0.1 -->
	<script src="template/assets/plugins/chartjs/Chart.min.js"></script>
	<script src="template/assets/plugins/qr/qrcode.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
	
	
	<?php
	$first  = strtotime('first day next month');
	$last6F = array();
	for ($i = 6; $i >= 1; $i--) { array_push($last6F, date('F', strtotime("-$i month", $first))); }
	
	$last6YM = array();
	for ($i = 6; $i >= 1; $i--) { array_push($last6YM, date('Y-m', strtotime("-$i month", $first))); }
	?>
	
	
	
	
	
	
	<script type="text/javascript">
	
	$(document).ready(function() {
	
	$("#dataTablefulldes1").dataTable();
	$('#document_type').change( function(e) { 
			var letter = $(this).val();
			if (letter === '0') {
				$ ('tr').show ();
			}else{
				$("#dataTablefulldes1 tr td:nth-child(3)").each(
				function(){
					if($(this).text() != letter){
						$(this).parent().hide();
					}
					else{
						$(this).parent().show();
					}
				});
			   }         
		});
	});
	$(document).ready(function() {
		

		
		$(".create_tic").addClass("active");
		$(".contract_no_css").click(function(){
		$("#tab-adepartment").removeClass("active");
	
		$( "#dataTablesFullDesc6_filter input" ).addClass( "popopo" );
		
		  var text = $(this).text();
			 var newss   = $.trim(text);
			var input = $('.popopo');
				input.val(newss);
				$('.popopo').keyup();
		  $("#tab-contract").addClass("active");
		  $(".contratc_active").addClass("active");
		  $(".create_tic").removeClass("active");
	
	});
		
		
		
		$('#chkall').change(function() {
			var checkboxes = $(this).closest('table').find(':checkbox');
			if ($(this).is(':checked')) {
			
				checkboxes.prop('checked', true);
			} else {
				checkboxes.prop('checked', false);
			}
		});
	
		$('table').on('change', ':checkbox:not(#chkall)', function() {
			var checkboxes = $(this).closest('table').find(':checkbox:not(#chkall)'),
			
			allchecked = (checkboxes.length === checkboxes.filter(':checked').length);
			$('#chkall').prop('checked', allchecked);
		});
		
		//-------------
		//- PIE CHART -
		//-------------
		// Get context with jQuery - using jQuery's .get() method.
		var pieChartCanvas = $("#pieChart").get(0).getContext("2d");
		var pieChart = new Chart(pieChartCanvas);
		var PieData = [
	
				<?php foreach($categories as $category) { ?>
		{
		value: <?php echo countAssetsByCategory($category['id'], $client['id']); ?> ,
				color: "<?php echo $category['color']; ?>",
				label: "<?php echo $category['name']; ?>"
		},
				<?php } ?>
		];
		var pieOptions = {
		//Boolean - Whether we should show a stroke on each segment
		segmentShowStroke: true,
				//String - The colour of each segment stroke
				segmentStrokeColor: "#fff",
				//Number - The width of each segment stroke
				segmentStrokeWidth: 2,
				//Number - The percentage of the chart that we cut out of the middle
				percentageInnerCutout: 50, // This is 0 for Pie charts
				//Number - Amount of animation steps
				animationSteps: 100,
				//String - Animation easing effect
				animationEasing: "easeOutBounce",
				//Boolean - Whether we animate the rotation of the Doughnut
				animateRotate: true,
				//Boolean - Whether we animate scaling the Doughnut from the centre
				animateScale: false,
				//Boolean - whether to make the chart responsive to window resizing
				responsive: true,
				// Boolean - whether to maintain the starting aspect ratio or not when responsive, if set to false, will take up entire container
				maintainAspectRatio: true,
				//String - A legend template
				legendTemplate: "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>"
		};
		//Create pie or douhnut chart
		// You can switch between pie and douhnut using the method below.
		pieChart.Doughnut(PieData, pieOptions);
		
		
	</script>
	
	
	
	
	
	<script>
	$(document).ready(function(){

		
	
	//$('#startDate').datepicker({ dateFormat: 'YY-mm-dd' });
	
	
	$('#endDatee').datepicker({ format: 'yyyy-mm-dd' });
	$('#endDatee').datepicker('setDate', new Date());
	var d = new Date();
			   var currMonth = d.getMonth() - 1;
			   var currYear = d.getFullYear();
			   var startDate = new Date(currYear, currMonth);
	var makeDate = new Date(d.setMonth(d.getMonth() - 1));
			   $("#startDatee").datepicker({format: 'yyyy-mm-dd' });
			   $("#startDatee").datepicker("setDate", makeDate);
	
	  $(".asetnote").click(function(){
		$(".asetnotewrap").show();
	  });
	
	  $(".close12345").click(function(){
		$(".notetext").hide();
		 return false;
	  }); 
	  $(".closepopup").click(function(){
		$(".listmemoo").hide();
		 return false;
	  });
	  $(".closepopup").click(function(){
		$(".valuewrap").hide();
		 return false;
	  });
	   $(".close_popup").click(function(){
		$(".memo1").hide();
		 return false;
	  });
		$(".close_popup").click(function(){
		$(".memo1").hide();
		 return false;
	  });   
	  $(".closediper").click(function(){
		$(".dipar").hide();
		 return false;
	  });
	 $(".off_limiwrwp").click(function(){
		$(".limit_wrap").hide();
		 return false;
	  }); 
	  $(".off_limiwrwp").click(function(){
		$(".limit_wrapp").hide();
		 return false;
	  });
	  $("#sall").click(function(){
	   var chkbox=[];
	   if ($(this).val() == 'selall') {
		  $('input:checkbox').prop('checked', true);
		  $(this).val('Uncheck All');
		} else {
		  $('input:checkbox').prop('checked', false);
		  $(this).val('selall');
		  $("#u_email").val('');
		}
		//$('input:checkbox').not(this).prop('checked', this.checked);
		$("input:checkbox[name=uid]:checked").each(function(){
		<!-- alert("hiii"); -->
		<!-- alert($(this).val()); -->
		chkbox.push($(this).val());
		$("#u_email").val(chkbox);
	});
	})
	
	$('input:checkbox[name=uid]').click(function(){
	//alert("hii");
	var chkbox=[];
	if($(this).prop("checked") == true)
	{
	 //chkbox.push($(this).val());
	$("input:checkbox[name=uid]:checked").each(function(){
		<!-- alert("hiii"); -->
		<!-- alert($(this).val()); -->
		chkbox.push($(this).val());
		$("#u_email").val(chkbox);
	});
	}
	else
	{
	//alert("test");
	var remove_Item= $(this).val();
	var eml =$("#u_email").val();
	var res = eml.replace(remove_Item, "");
	$("#u_email").val(res);
	
	
	}
	
	})
	
	 // });
	 
	});
	</script>
	<script>
	
	function get(id)
	{
		
	  document.getElementById("ss"+id).style.display="block";
	
	}
	
	function assts_memo1(id)
	{
	
	 document.getElementById("memo1"+id).style.display="block";
	
	}
	function assts_memo(id)
	{
	
	document.getElementById("memo"+id).style.display="block";
	
	}
	
	
	function limit(id)
	{ 
	 $(".limit_wrapp2").hide();
	 
	  document.getElementById("limit"+id).style.display="block";
	
	}
	
	function techni(id,ids){
	
	 $.ajax({
					url: "index.php?route=contract/get_technician&id=" +ids ,
					dataType: "json",
					success: function (responde) {
					var mobile = responde.mobile;
					var email = responde.email;
					 document.getElementById("f"+id).tech_mobile_data.value=mobile;
				  document.getElementById("f"+id).tech_mailid_data.value=email;
					
					}
				});
	
	
	}
	
	function technician(id)
	{ 
	$(".limit_wrapp2").hide();
	
	 document.getElementById("te"+id).style.display="block";
	
	}

	</script>
	

     <script>
    $(document).ready(function() {
        $("#viewAllInvoiceButton").click(function() {
            $(".AllinvoiceTableContainer").show();
            $(".pendingTableContainer").hide();
            $(".unpaidTableContainer").hide();
            $(".tofollowTableContainer").hide();
        });

        $("#unpaid_invoice").click(function() {
            $(".AllinvoiceTableContainer").hide();
            $(".pendingTableContainer").hide();
            $(".unpaidTableContainer").show();
            $(".tofollowTableContainer").hide();
        });

		$("#unpaid_invoice_1").click(function() {
            $(".AllinvoiceTableContainer_1").hide();
            $(".pendingTableContainer_1").hide();
            $(".unpaidTableContainer_1").show();
            $(".tofollowTableContainer_1").hide();
        });

        $("#view_pending_tax_file").click(function() {
            $(".AllinvoiceTableContainer").hide();
            $(".unpaidTableContainer").hide();
            $(".pendingTableContainer").show();
            $(".tofollowTableContainer").hide();
        });

        $("#view_follow_up").click(function() {
            $(".AllinvoiceTableContainer").hide();
            $(".unpaidTableContainer").hide();
            $(".pendingTableContainer").hide();
            $(".tofollowTableContainer").show();
        });

        $(".viewAllInvoiceButtonsm").click(function() {
            $(".AllinvoiceTableContainer").show();
            $(".pendingTableContainer").hide();
            $(".unpaidTableContainer").hide();
            $(".tofollowTableContainer").hide();
        });

		$("#viewAllInvoiceButtonsm").click(function() {
            $(".AllinvoiceTableContainer").show();
            $(".pendingTableContainer").hide();
            $(".unpaidTableContainer").hide();
            $(".tofollowTableContainer").hide();
        });

		$("#viewAllInvoiceButtonsm_1").click(function() {
            $(".AllinvoiceTableContainer_1").show();
            $(".pendingTableContainer_1").hide();
            $(".unpaidTableContainer_1").hide();
            $(".tofollowTableContainer_1").hide();
        });

        $("#unpaid_invoicesm").click(function() {
            $("#tofollowTableContainer").show();
            $(".AllinvoiceTableContainer").hide();
            $(".pendingTableContainer").hide();
            $(".unpaidTableContainer").hide();
            $(".tofollowTableContainer").hide();
        });

        $("#view_pending_tax_filesm").click(function() {
            $(".AllinvoiceTableContainer").hide();
            $(".unpaidTableContainer").hide();
            $(".pendingTableContainer").show();
            $(".tofollowTableContainer").hide();
        });

		$("#view_pending_tax_filesm_1").click(function() {
            $(".AllinvoiceTableContainer_1").hide();
            $(".unpaidTableContainer_1").hide();
            $(".pendingTableContainer_1").show();
            $(".tofollowTableContainer_1").hide();
        });

        $("#view_follow_upm").click(function() {
            $(".tofollowTableContainer").show();
            $(".AllinvoiceTableContainer").hide();
            $(".pendingTableContainer").hide();
            $(".unpaidTableContainer").hide();
        });

        $('#imageModal').on('show.bs.modal', function (e) {
			var imageUrl = $(e.relatedTarget).attr('data-image-url');
			$('#modalImage').attr('src', imageUrl);
			
			// Adjust image dimensions based on modal size
			var modalBody = $(this).find('.modal-body');
			var maxWidth = modalBody.width() * 0.5; // Adjust the multiplier as needed
			var maxHeight = modalBody.height() * 0.5; // Adjust the multiplier as needed
			
			$('#modalImage').css('max-width', maxWidth);
			$('#modalImage').css('max-height', maxHeight);
		});
        
    });

    function openModal(imageUrl) {
		// Set the modal image src to the larger image URL
		$('#modalImage').attr('src', imageUrl);
		// Open the Bootstrap modal
		$('#imageModal').modal('show');
	}
	$('.updatedepart').click(function() {
            var id = $(this).attr('id');
			alert=""
			$(".upcondep").not(".upcondep."+id).hide();
			$(".upcondep."+id).toggle();
        });

</script>